<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://2006wzt.github.io</id>
    <title>My Brain</title>
    <updated>2022-08-02T10:53:39.952Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://2006wzt.github.io"/>
    <link rel="self" href="https://2006wzt.github.io/atom.xml"/>
    <subtitle>There is no end to learning. </subtitle>
    <logo>https://2006wzt.github.io/images/avatar.png</logo>
    <icon>https://2006wzt.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, My Brain</rights>
    <entry>
        <title type="html"><![CDATA[机器学习实战（五）：概率估计]]></title>
        <id>https://2006wzt.github.io/post/机器学习实战（五）：概率估计/</id>
        <link href="https://2006wzt.github.io/post/机器学习实战（五）：概率估计/">
        </link>
        <updated>2022-08-01T12:20:44.000Z</updated>
        <content type="html"><![CDATA[<h1 id="概率估计">概率估计</h1>
<h2 id="一-分布预测分类">一、分布预测分类</h2>
<p>我们在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mi>N</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">KNN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>算法中已经学习过了贝叶斯最优分类器：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">如</mi><mi mathvariant="normal">果</mi><mi mathvariant="normal">我</mi><mi mathvariant="normal">们</mi><mi mathvariant="normal">已</mi><mi mathvariant="normal">知</mi><mi mathvariant="normal">分</mi><mi mathvariant="normal">布</mi><mi>P</mi><mo>(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>)</mo><mo separator="true">,</mo><mi mathvariant="normal">我</mi><mi mathvariant="normal">们</mi><mi mathvariant="normal">可</mi><mi mathvariant="normal">以</mi><mi mathvariant="normal">预</mi><mi mathvariant="normal">测</mi><mi>x</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">签</mi><mi mathvariant="normal">为</mi><mi mathvariant="normal">概</mi><mi mathvariant="normal">率</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">高</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">那</mi><mi mathvariant="normal">个</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">签</mi><mtext> </mtext><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>x</mi></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mi>max</mi><mo>⁡</mo><mi>y</mi></munder><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;如果我们已知分布P(X,Y),我们可以预测x的标签为概率最高的那个标签~label_x=\arg\max_{y}P(y|x)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9761080000000002em;vertical-align:-0.7380540000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.238054em;"><span style="top:-3.238054em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7380540000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.238054em;"><span style="top:-3.398054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">如</span><span class="mord cjk_fallback">果</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">已</span><span class="mord cjk_fallback">知</span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">布</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">预</span><span class="mord cjk_fallback">测</span><span class="mord mathdefault">x</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">签</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">概</span><span class="mord cjk_fallback">率</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">高</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">那</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">签</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4305599999999999em;"><span style="top:-2.1em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8361080000000001em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7380540000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>如果我们可以根据训练集得到一个大致的分布P(X,Y)，则可以利用贝叶斯最优分类器进行分类，对分布进行预测的学习分为两类：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">①</mi><mi mathvariant="normal">生</mi><mi mathvariant="normal">成</mi><mi mathvariant="normal">学</mi><mi mathvariant="normal">习</mi><mi mathvariant="normal">：</mi><mi mathvariant="normal">预</mi><mi mathvariant="normal">测</mi><mi>P</mi><mo>(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><mi>Y</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>Y</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">②</mi><mi mathvariant="normal">判</mi><mi mathvariant="normal">别</mi><mi mathvariant="normal">学</mi><mi mathvariant="normal">习</mi><mi mathvariant="normal">：</mi><mi mathvariant="normal">直</mi><mi mathvariant="normal">接</mi><mi mathvariant="normal">预</mi><mi mathvariant="normal">测</mi><mi>P</mi><mo>(</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;①生成学习：预测P(X,Y)=P(X|Y)P(Y)\\
&amp;②判别学习：直接预测P(Y|X)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">①</span><span class="mord cjk_fallback">生</span><span class="mord cjk_fallback">成</span><span class="mord cjk_fallback">学</span><span class="mord cjk_fallback">习</span><span class="mord cjk_fallback">：</span><span class="mord cjk_fallback">预</span><span class="mord cjk_fallback">测</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">②</span><span class="mord cjk_fallback">判</span><span class="mord cjk_fallback">别</span><span class="mord cjk_fallback">学</span><span class="mord cjk_fallback">习</span><span class="mord cjk_fallback">：</span><span class="mord cjk_fallback">直</span><span class="mord cjk_fallback">接</span><span class="mord cjk_fallback">预</span><span class="mord cjk_fallback">测</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="二-极大似然估计">二、极大似然估计</h2>
<p>Maximum Likelihood Estimation (MLE)</p>
<h3 id="21-简单场景掷硬币">2.1 简单场景：掷硬币</h3>
<p>我们投十次硬币，假设投掷结果为：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>=</mo><mo>{</mo><mi>H</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">D=\{H, T, T, H, H, H, T, T, T, T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">}</span></span></span></span>，则我们一般会进行以下预测：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>=</mo><mn>4</mn><mo separator="true">,</mo><msub><mi>n</mi><mi>T</mi></msub><mo>=</mo><mn>6</mn><mo separator="true">,</mo><mi>P</mi><mo>(</mo><mi>H</mi><mo>)</mo><mo>=</mo><mi>θ</mi><mo>≈</mo><mfrac><msub><mi>n</mi><mi>H</mi></msub><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub></mrow></mfrac><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">n_H=4,n_T=6,P(H)=\theta\approx\frac{n_H}{n_H+n_T}=0.4
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span></span></span></span></span></p>
<h3 id="22-形式化定义">2.2 形式化定义</h3>
<p>上述掷硬币的例子就是极大似然估计的过程，对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MLE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>，一般分为两步：<br>
①<font color=PURPLE><strong>对分布类型进行明确的建模假设</strong></font><br>
②<font color=PURPLE><strong>设置分布中所涉及的参数</strong></font></p>
<p>对于掷硬币问题的分布，我们易知这是一个经典的二项分布，他有两个参数：抛硬币次数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>，某个事件（例如：硬币正面朝上）发生的概率<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>，我们不妨假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> </mtext><mi>P</mi><mo>(</mo><mi>H</mi><mo>)</mo><mo>=</mo><mi>θ</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">~P(H)=\theta~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace nobreak"> </span></span></span></span>，则有：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mo>=</mo><msubsup><mi>C</mi><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub></mrow><msub><mi>n</mi><mi>H</mi></msub></msubsup><mo>⋅</mo><msup><mi>θ</mi><msub><mi>n</mi><mi>H</mi></msub></msup><mo>⋅</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><msub><mi>n</mi><mi>T</mi></msub></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;P(D|\theta)=C^{n_H}_{n_H+n_T}\cdot \theta^{n_H}\cdot(1-\theta)^{n_T}\\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5000000000000002em;vertical-align:-0.5000000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5000000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7464970000000001em;"><span style="top:-2.4764690000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1451050000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.323836em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5000000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mtext> </mtext></mrow><annotation encoding="application/x-tex">P(D|\theta)~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace nobreak"> </span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>为某个值时，抛硬币结果为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>的概率，比如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>=</mo><mo>{</mo><mi>H</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>H</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">D=\{H, T, T, H, H, H, T, T, T, T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">}</span></span></span></span></p>
<p><font color=PURPLE><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MLE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>的规则：对于固定的事件<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>，找到一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(D|\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>最大：</strong></font></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><msubsup><mi>C</mi><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub></mrow><msub><mi>n</mi><mi>H</mi></msub></msubsup><mo>⋅</mo><msup><mi>θ</mi><msub><mi>n</mi><mi>H</mi></msub></msup><mo>⋅</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><msub><mi>n</mi><mi>T</mi></msub></msup><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mo>(</mo><msub><mi>n</mi><mi>H</mi></msub><mi>ln</mi><mo>⁡</mo><mi>θ</mi><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub><mi>ln</mi><mo>⁡</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo>)</mo><mo>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\hat{\theta}_{MLE}=\underset{\theta}{argmax}~P(D|\theta)=\underset{\theta}{argmax}~C^{n_H}_{n_H+n_T}\cdot \theta^{n_H}\cdot(1-\theta)^{n_T}=\underset{\theta}{argmax}~(n_H\ln\theta+n_T\ln(1-\theta))
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.204428em;vertical-align:-0.8522139999999998em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3522140000000002em;"><span style="top:-3.352214em;"><span class="pstrut" style="height:2.95788em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8522139999999998em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3522140000000002em;"><span style="top:-3.3943339999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7464970000000001em;"><span style="top:-2.4764690000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.1451050000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.323836em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8522139999999998em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>我们对函数进行求导即可得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的极大似然估计值：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">令</mi><mi>f</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mo>=</mo><msub><mi>n</mi><mi>H</mi></msub><mi>ln</mi><mo>⁡</mo><mi>θ</mi><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub><mi>ln</mi><mo>⁡</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mrow><mi>d</mi><mi>f</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mrow><mi>d</mi><mi>θ</mi></mrow></mfrac><mo>=</mo><mfrac><msub><mi>n</mi><mi>H</mi></msub><mi>θ</mi></mfrac><mo>−</mo><mfrac><msub><mi>n</mi><mi>T</mi></msub><mrow><mn>1</mn><mo>−</mo><mi>θ</mi></mrow></mfrac><mo>=</mo><mn>0</mn><mo>→</mo><mi>θ</mi><mo>=</mo><mfrac><msub><mi>n</mi><mi>H</mi></msub><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub></mrow></mfrac><mo separator="true">,</mo><mi mathvariant="normal">即</mi><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>n</mi><mi>H</mi></msub><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;令f(\theta)=n_H\ln\theta+n_T\ln(1-\theta)\\
&amp;\frac{df(\theta)}{d\theta}=\frac{n_H}{\theta}-\frac{n_T}{1-\theta}=0\rightarrow \theta=\frac{n_H}{n_H+n_T},即\hat{\theta}_{MLE}=\frac{n_H}{n_H+n_T}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.063000000000001em;vertical-align:-1.7815000000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.2815000000000003em;"><span style="top:-4.8685em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:-2.7815em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7815000000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.2815000000000003em;"><span style="top:-4.8685em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">令</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-2.7815em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">即</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7815000000000003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>可以发现极大似然估计的预测结果与我们的直观预测相同，这就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MLE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span></p>
<h2 id="三-先验估计">三、先验估计</h2>
<h3 id="31-简单场景掷硬币">3.1 简单场景：掷硬币</h3>
<p>我们仍可以用掷硬币的场景去理解先验估计：假设我们预感<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>接近<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0.5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span>。但我们的样本量很小，所以我们对此估计并不确信，可以作如下处理：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><mi>m</mi></mrow><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub><mo>+</mo><mn>2</mn><mi>m</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{\theta}=\frac{n_H+m}{n_H+n_T+2m}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9578799999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.09633em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603300000000002em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><font color=PURPLE><strong>当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>很大时，该处理对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的影响微不足道；但是当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>较小时，该处理可以使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>更接近我们的猜测。</strong></font></p>
<h3 id="32-形式化定义">3.2 形式化定义</h3>
<p>假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>是根据分布<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(θ)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>得到的一个随机值，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>为一个事件，则有如下贝叶斯公式：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mo>)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mo separator="true">,</mo><mi>θ</mi><mo>)</mo></mrow><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(\theta|D)=\frac{P(D|\theta)P(\theta)}{P(D)}=\frac{P(D,\theta)}{P(D)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>①<font color=PURPLE><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(θ)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>是我们在看到数据之前<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的<strong>先验分布</strong></font><br>
②<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(D|\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>是对于给定的参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>，事件<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>发生的可能性<br>
③<font color=PURPLE><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(\theta|D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span>是我们观察数据后得到的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的<strong>后验分布</strong></font></p>
<p>我们常常利用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span></span></span></span>分布得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的先验分布：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mo>=</mo><mfrac><mrow><msup><mi>θ</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><mrow><mi>B</mi><mo>(</mo><mi>α</mi><mo separator="true">,</mo><mi>β</mi><mo>)</mo></mrow></mfrac><mspace linebreak="newline"></mspace><mo>(</mo><mi mathvariant="normal">其</mi><mi mathvariant="normal">中</mi><mi>B</mi><mo>(</mo><mi>α</mi><mo separator="true">,</mo><mi>β</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>α</mi><mo>)</mo><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>β</mi><mo>)</mo></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo>)</mo></mrow></mfrac><mo separator="true">,</mo><mi mathvariant="normal">其</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">对</mi><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mi mathvariant="normal">进</mi><mi mathvariant="normal">行</mi><mi mathvariant="normal">归</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">化</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(\theta)=\frac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha,\beta)}\\
(其中B(\alpha,\beta)=\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)},其目的是对P(\theta)进行归一化)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4621079999999997em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261079999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">α</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">中</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">对</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">归</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">化</span><span class="mclose">)</span></span></span></span></span></p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220517100702748.png" style="zoom:67%;" />
$$
P(\theta|D)\propto P(D|\theta)P(\theta)\propto\theta^{n_H+\alpha-1}(1-\theta)^{n_T+\beta-1}
$$
<h2 id="四-极大后验估计">四、极大后验估计</h2>
<p>在我们知道关于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的分布，可以利用极大后验估计得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>的估计值</p>
<p><font color=PURPLE><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MAP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span>规则：对于一个固定的事件<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>，找到一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>，使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(\theta|D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span>最大：</strong></font></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mi>P</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>)</mo><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mfrac><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow><mrow><mi>P</mi><mo>(</mo><mi>D</mi><mo>)</mo></mrow></mfrac><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>           </mtext><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mo>(</mo><msup><mi>θ</mi><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><msup><mo>)</mo><mrow><msub><mi>n</mi><mi>T</mi></msub><mo>+</mo><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>)</mo><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>θ</mi></munder><mtext> </mtext><mo>(</mo><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><mi>α</mi><mo>−</mo><mn>1</mn><mo>)</mo><mi>ln</mi><mo>⁡</mo><mi>θ</mi><mo>+</mo><mo>(</mo><msub><mi>n</mi><mi>T</mi></msub><mo>+</mo><mi>β</mi><mo>−</mo><mn>1</mn><mo>)</mo><mi>ln</mi><mo>⁡</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>            </mtext><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><mi>α</mi><mo>−</mo><mn>1</mn></mrow><mrow><msub><mi>n</mi><mi>H</mi></msub><mo>+</mo><msub><mi>n</mi><mi>T</mi></msub><mo>+</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo>−</mo><mn>2</mn></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\hat\theta_{MAP}=\underset{\theta}{argmax}~P(\theta|D)=\underset{\theta}{argmax}~\frac{P(D|\theta)P(\theta)}{P(D)}=\underset{\theta}{argmax}~P(D|\theta)P(\theta)\\
&amp;~~~~~~~~~~~=\underset{\theta}{argmax}~(\theta^{n_H+\alpha-1}(1-\theta)^{n_T+\beta-1})=\underset{\theta}{argmax}~(n_H+\alpha-1)\ln\theta+(n_T+\beta-1)\ln(1-\theta)\\
&amp;~~~~~~~~~~~~=\frac{n_H+\alpha-1}{n_H+n_T+\alpha+\beta-2}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.321084000000001em;vertical-align:-3.4105420000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.9105420000000004em;"><span style="top:-5.9105419999999995em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:-3.7648859999999997em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span><span style="top:-1.1968979999999998em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.4105420000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.9105420000000004em;"><span style="top:-5.9105419999999995em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-3.7648859999999997em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.0037em;">α</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-1.1968979999999998em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.4105420000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">n\rightarrow\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\beta-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">n_H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">n_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>相比可以忽略，即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mo>→</mo><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat\theta_{MAP}\rightarrow\hat\theta_{MLE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1078799999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1078799999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<h2 id="五-总结">五、总结</h2>
<p>在监督学习中有一个数据集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>，我们运用它来训练模型，它有一个参数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">θ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>，利用这个模型我们希望对测试点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>进行预测，则有如下方法：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>M</mi><mi>L</mi><mi>E</mi><mo>:</mo><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">;</mo><mi>θ</mi><mo>)</mo><mtext> </mtext><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>:</mo><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>L</mi><mi>E</mi></mrow></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mi>max</mi><mo>⁡</mo><mi>θ</mi></munder><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mo separator="true">,</mo><mi mathvariant="normal">此</mi><mi mathvariant="normal">处</mi><mi mathvariant="normal">的</mi><mi>θ</mi><mi mathvariant="normal">为</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">个</mi><mi mathvariant="normal">模</mi><mi mathvariant="normal">型</mi><mi mathvariant="normal">参</mi><mi mathvariant="normal">数</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>M</mi><mi>A</mi><mi>P</mi><mo>:</mo><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>θ</mi><mo>)</mo><mtext> </mtext><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>:</mo><msub><mover accent="true"><mi>θ</mi><mo>^</mo></mover><mrow><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mi>max</mi><mo>⁡</mo><mi>θ</mi></munder><mi>P</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>)</mo><mo>∝</mo><mi>P</mi><mo>(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mi mathvariant="normal">，</mi><mi mathvariant="normal">此</mi><mi mathvariant="normal">处</mi><mi mathvariant="normal">的</mi><mi>θ</mi><mi mathvariant="normal">为</mi><mi mathvariant="normal">随</mi><mi mathvariant="normal">机</mi><mi mathvariant="normal">变</mi><mi mathvariant="normal">量</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi><mtext> </mtext><mi>B</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>a</mi><mi>n</mi><mo>:</mo><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>θ</mi><mo>)</mo><mo>=</mo><msub><mo>∫</mo><mi>θ</mi></msub><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>θ</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>)</mo><mi>d</mi><mi>θ</mi><mo separator="true">,</mo><mi mathvariant="normal">此</mi><mi mathvariant="normal">处</mi><mi mathvariant="normal">的</mi><mi>θ</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">考</mi><mi mathvariant="normal">虑</mi><mi mathvariant="normal">所</mi><mi mathvariant="normal">有</mi><mi mathvariant="normal">可</mi><mi mathvariant="normal">能</mi><mi mathvariant="normal">模</mi><mi mathvariant="normal">型</mi><mi mathvariant="normal">积</mi><mi mathvariant="normal">分</mi><mi mathvariant="normal">出</mi><mi mathvariant="normal">来</mi><mi mathvariant="normal">的</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;MLE:P(y|x_t;\theta)~learning:\hat\theta_{MLE}=\arg\max_\theta P(D|\theta),此处的\theta为一个模型参数\\
&amp;MAP:P(y|x_t,\theta)~learning:\hat\theta_{MAP}=\arg\max_\theta P(\theta|D)\propto P(D|\theta)P(\theta)，此处的\theta为随机变量\\
&amp;True~Bayesian:P(y|x_t,\theta)=\int_\theta P(y|\theta)P(\theta|D)d\theta,此处的\theta是考虑所有可能模型积分出来的
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.591926em;vertical-align:-3.045963em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.545963em;"><span style="top:-5.9480830000000005em;"><span class="pstrut" style="height:3.3600000000000003em;"></span><span class="mord"></span></span><span style="top:-3.9380950000000006em;"><span class="pstrut" style="height:3.3600000000000003em;"></span><span class="mord"></span></span><span style="top:-1.5259870000000002em;"><span class="pstrut" style="height:3.3600000000000003em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.045963em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.545963em;"><span style="top:-5.9480830000000005em;"><span class="pstrut" style="height:3.3600000000000003em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.047892em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.752108em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">处</span><span class="mord cjk_fallback">的</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">型</span><span class="mord cjk_fallback">参</span><span class="mord cjk_fallback">数</span></span></span><span style="top:-3.9380950000000006em;"><span class="pstrut" style="height:3.3600000000000003em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.047892em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.752108em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">处</span><span class="mord cjk_fallback">的</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">随</span><span class="mord cjk_fallback">机</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span></span></span><span style="top:-1.5259870000000002em;"><span class="pstrut" style="height:3.3600000000000003em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.425842em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">处</span><span class="mord cjk_fallback">的</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">考</span><span class="mord cjk_fallback">虑</span><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">能</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">型</span><span class="mord cjk_fallback">积</span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">出</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">的</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.045963em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[机器学习实战（四）：感知机算法]]></title>
        <id>https://2006wzt.github.io/post/机器学习实战（四）：感知机算法/</id>
        <link href="https://2006wzt.github.io/post/机器学习实战（四）：感知机算法/">
        </link>
        <updated>2022-07-30T09:12:02.000Z</updated>
        <content type="html"><![CDATA[<h1 id="感知机算法">感知机算法</h1>
<h2 id="一-形式化定义">一、形式化定义</h2>
<p>在机器学习中，感知机是一种用于处理监督学习的二分类问题的分类器，它是一种线性分类器，即一种基于线性预测函数（将一组权重与特征向量相结合）进行预测的分类算法，该模型有着如下的假设：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">①</mi><mi mathvariant="normal">处</mi><mi mathvariant="normal">理</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">问</mi><mi mathvariant="normal">题</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">二</mi><mi mathvariant="normal">分</mi><mi mathvariant="normal">类</mi><mi mathvariant="normal">问</mi><mi mathvariant="normal">题</mi><mi mathvariant="normal">：</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>g</mi><mi mathvariant="normal">.</mi><mtext>  </mtext><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mo>{</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo>}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">②</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">线</mi><mi mathvariant="normal">性</mi><mi mathvariant="normal">可</mi><mi mathvariant="normal">分</mi><mi mathvariant="normal">的</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;①处理的问题是二分类问题：e.g.~~y_i\in\{-1,+1\}\\
&amp;②数据是线性可分的
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">①</span><span class="mord cjk_fallback">处</span><span class="mord cjk_fallback">理</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">题</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">二</span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">类</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">题</span><span class="mord cjk_fallback">：</span><span class="mord mathdefault">e</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord">.</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">②</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">线</span><span class="mord cjk_fallback">性</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">的</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220511215251923.png" style="zoom: 67%;" />
<p>感知机模型最终所要求解的是权重向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>，其形式化定义如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">权</mi><mi mathvariant="normal">重</mi><mi mathvariant="normal">向</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">：</mi><mi>w</mi><mo>=</mo><mo>[</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>w</mi><mi>d</mi></msub><msup><mo>]</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">特</mi><mi mathvariant="normal">征</mi><mi mathvariant="normal">向</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">：</mi><mi>x</mi><mo>=</mo><mo>[</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>d</mi></msub><msup><mo>]</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">解</mi><mi mathvariant="normal">空</mi><mi mathvariant="normal">间</mi><mi mathvariant="normal">：</mi><mi mathvariant="script">H</mi><mo>=</mo><mo>{</mo><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>0</mn><mo>}</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;权重向量：w=[w_1,w_2,...,w_d]^T\\
&amp;特征向量：x=[x_1,x_2,...,x_d]^T\\
&amp;解空间：\mathcal{H}=\{h(x)=w^Tx+b=0\}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.653993em;vertical-align:-2.0769965em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5769965em;"><span style="top:-4.5769965em;"><span class="pstrut" style="height:2.891331em;"></span><span class="mord"></span></span><span style="top:-3.0256655em;"><span class="pstrut" style="height:2.891331em;"></span><span class="mord"></span></span><span style="top:-1.4743345000000003em;"><span class="pstrut" style="height:2.891331em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0769965em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5769965em;"><span style="top:-4.6856655em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">重</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">：</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-3.1343345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">特</span><span class="mord cjk_fallback">征</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">：</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-1.5830035000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">解</span><span class="mord cjk_fallback">空</span><span class="mord cjk_fallback">间</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0769965em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="二-感知机实现">二、感知机实现</h2>
<h3 id="21-权重向量">2.1 权重向量</h3>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220511215919122.png" style="zoom:45%;" />
<p>根据形式化定义，我们知道我们的求解目标是一个权重向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>，最终得到模型函数：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h(x)=w^Tx+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.924661em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span><br>
即我们求解得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>对应的是多维空间中的一个超平面<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w^Tx+b=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.924661em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，该平面在多维空间中将数据点分为两部分<br>
而我们最后的分类只需要根据<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>的正负判断数据点在哪一侧即可。</p>
<p><font color=PURPLE><strong>权重向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>即为所要求解的超平面的法向量</strong></font></p>
<h3 id="22-偏差项">2.2 偏差项</h3>
<p>我们注意到模型函数中还有一项常数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>，我们称之为偏差项，如果没有偏差项，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>所定义的超平面一定经过原点。<br>
为了便于后续处理，我们通过升维操作将偏差项<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>吸收到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>中去：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">目</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">超</mi><mi mathvariant="normal">平</mi><mi mathvariant="normal">面</mi><mi mathvariant="normal">：</mi><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">令</mi><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>w</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><mi>b</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi mathvariant="normal">，</mi><mi mathvariant="normal">则</mi><mi mathvariant="normal">有</mi><msup><mi>w</mi><mrow><mo mathvariant="normal">′</mo><mi>T</mi></mrow></msup><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">由</mi><mi mathvariant="normal">此</mi><mi mathvariant="normal">解</mi><mi mathvariant="normal">空</mi><mi mathvariant="normal">间</mi><mi mathvariant="normal">变</mi><mi mathvariant="normal">为</mi><mi mathvariant="normal">：</mi><mi mathvariant="script">H</mi><mo>=</mo><mo>{</mo><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>=</mo><mn>0</mn><mo>}</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;目标超平面：w^Tx+b=0\\
&amp;令x&#x27;=\left[
\begin{aligned}
&amp;x\\
&amp;~1
\end{aligned}
\right],w=\left[
\begin{aligned}
&amp;w&#x27;\\
&amp;~b
\end{aligned}
\right]，则有w&#x27;^Tx&#x27;=w^Tx+b=0\\
&amp;由此解空间变为：\mathcal{H}=\{h(x)=w^Tx=0\}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.402692000000001em;vertical-align:-2.951346em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.451346000000001em;"><span style="top:-6.310015000000001em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:-3.9000150000000002em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:-1.4586540000000001em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.951346em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.451346000000001em;"><span style="top:-6.310015000000001em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">平</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-3.9000150000000002em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">令</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">x</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace nobreak"> </span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace nobreak"> </span><span class="mord mathdefault">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">则</span><span class="mord cjk_fallback">有</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-1.4586540000000001em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">解</span><span class="mord cjk_fallback">空</span><span class="mord cjk_fallback">间</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.951346em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220511221207524.png" style="zoom:55%;" />
<p>通过升维后超平面一定是经过原点的，则有：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">设</mi><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mo>{</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo>}</mo><mo separator="true">,</mo><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>&gt;</mo><mn>0</mn><mo>↔</mo><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>&lt;</mo><mn>0</mn><mo>↔</mo><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">可</mi><mi mathvariant="normal">得</mi><mi mathvariant="normal">：</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>&gt;</mo><mn>0</mn><mo>↔</mo><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">分</mi><mi mathvariant="normal">类</mi><mi mathvariant="normal">正</mi><mi mathvariant="normal">确</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;设y_i\in\{-1,+1\},h(x_i)&gt;0\leftrightarrow~y_i=+1,h(x_i)&lt;0\leftrightarrow~y_i=-1\\
&amp;可得：y_i\cdot h(x_i)=y_i\cdot(w^Tx_i)&gt;0\leftrightarrow x_i分类正确
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0513310000000002em;vertical-align:-1.2756655000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7756655000000001em;"><span style="top:-3.8269965em;"><span class="pstrut" style="height:2.891331em;"></span><span class="mord"></span></span><span style="top:-2.2756655em;"><span class="pstrut" style="height:2.891331em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2756655000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7756655000000001em;"><span style="top:-3.9356655em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">设</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↔</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↔</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-2.3843345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↔</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">类</span><span class="mord cjk_fallback">正</span><span class="mord cjk_fallback">确</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2756655000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>注意我们尽量将二分类问题的标签设置为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\{-1,+1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span></span></span></span>，如果设置为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><mn>0</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">\{0,+1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span></span></span></span>则没有上述结论。</p>
<h3 id="23-算法实现">2.3 算法实现</h3>
<p>首先我们先看感知机算法的伪码：</p>
<img src="https://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220511224124720.png" style="zoom:67%;" />
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>用于记录在训练集上分类错误的次数，如果出错则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>=</mo><mi>m</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m=m+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，同时对权重向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>进行调整，调整方式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>=</mo><mi>w</mi><mo>+</mo><mi>y</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">w=w+yx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">x</span></span></span></span>，该调整方式的几何解释如下图所示：</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220511224251428.png" style="zoom:50%;" />
<p>如上图所示，图一为初始的权重向量以及其所对应的超平面，我们以一个标签为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span>的数据点为例，该超平面错误得将该数据点分到了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">+</span><span class="mord">1</span></span></span></span>的一侧（即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_i\cdot(w^Tx_i)\le0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63889em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>），则要进行调整：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>=</mo><mi>w</mi><mo>+</mo><mi>y</mi><mi>x</mi><mo>=</mo><mi>w</mi><mo>−</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">w=w+yx=w-x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>，则得到了如图三所示的调整后的超平面。</p>
<p>数学解释如下，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mi mathvariant="normal">和</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">w和b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord cjk_fallback">和</span><span class="mord mathdefault">b</span></span></span></span>的更新是一个梯度下降的过程，而我们用到的损失函数为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>D</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(w,b)=-\sum_{x_i\in D}y_i(w^Tx_i+b)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4444410000000003em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p>
<p>当分类错误时会有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>)</mo><mo>≤</mo><mn>0</mn><mtext> </mtext></mrow><annotation encoding="application/x-tex">~y_i\cdot(w^Tx_i+b)\le0~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63889em;vertical-align:-0.19444em;"></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace nobreak"> </span></span></span></span>，自然就会使得该损失函数变大，该函数对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>求偏导得：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>D</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>D</mi></mrow></munder><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial L(w,b)}{\partial w}=-\sum_{x_i\in D}y_ix_i\\
\frac{\partial L(w,b)}{\partial b}=-\sum_{x_i\in D}y_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4444410000000003em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">b</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4444410000000003em;vertical-align:-1.394436em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.394436em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>由此我们得到更新过程：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>→</mo><mi>w</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace><mi>b</mi><mo>→</mo><mi>b</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w\rightarrow w+y_ix_i\\
b\rightarrow b+y_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="三-感知机的收敛">三、感知机的收敛</h2>
<p>感知机可以说是第一个具有强大形式保证的算法。如果有数据集合是线性可分的，感知机将在有限更新次数中找到一个可以分离两类数据点的超平面，如果数据不是线性可分的，它将永远循环。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">假</mi><mi mathvariant="normal">设</mi><mi mathvariant="normal">∃</mi><msup><mi>w</mi><mi mathvariant="normal">∗</mi></msup><mi mathvariant="normal">有</mi><mo>:</mo><mi mathvariant="normal">对</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">∀</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>∈</mo><mi>D</mi><mi mathvariant="normal">，</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>x</mi><mi>T</mi></msup><msup><mi>w</mi><mi mathvariant="normal">∗</mi></msup><mo>)</mo><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">对</mi><mi mathvariant="normal">每</mi><mi mathvariant="normal">个</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">进</mi><mi mathvariant="normal">行</mi><mi mathvariant="normal">等</mi><mi mathvariant="normal">比</mi><mi mathvariant="normal">例</mi><mi mathvariant="normal">收</mi><mi mathvariant="normal">敛</mi><mi mathvariant="normal">使</mi><mi mathvariant="normal">得</mi><mi mathvariant="normal">：</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">∀</mi><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mi>D</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msup><mi>w</mi><mo>∗</mo></msup><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><msubsup><mi>w</mi><mi>i</mi><mo>∗</mo></msubsup><msup><mo>)</mo><mn>2</mn></msup></mrow></msqrt><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">对</mi><mi mathvariant="normal">于</mi><msup><mi>w</mi><mo>∗</mo></msup><mi mathvariant="normal">对</mi><mi mathvariant="normal">应</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">超</mi><mi mathvariant="normal">平</mi><mi mathvariant="normal">面</mi><mi mathvariant="normal">，</mi><mi mathvariant="normal">令</mi><mi>γ</mi><mo>=</mo><munder><mi>min</mi><mo>⁡</mo><mrow><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>∈</mo><mi>D</mi></mrow></munder><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>w</mi><mo>∗</mo></msup><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">，</mi><mi mathvariant="normal">即</mi><mi mathvariant="normal">离</mi><mi mathvariant="normal">超</mi><mi mathvariant="normal">平</mi><mi mathvariant="normal">面</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">近</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">点</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">应</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">距</mi><mi mathvariant="normal">离</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;假设∃w^∗有:对于∀(x_i, y_i) ∈ D，y_i\cdot(x^Tw^∗) &gt; 0\\
&amp;对每个数据进行等比例收敛使得：对于\forall x_i\in D,||w^*||=\sqrt{\sum_{i=1}^n(w^*_i)^2}=1,||x_i||\le1\\
&amp;对于w^*对应的超平面，令\gamma=\min_{(x_i,y_i)\in D}||x_i^Tw^*||，即离超平面最近的点对应的距离
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.165478000000001em;vertical-align:-3.332739em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.832739000000001em;"><span style="top:-6.8205550000000015em;"><span class="pstrut" style="height:3.8791470000000006em;"></span><span class="mord"></span></span><span style="top:-4.281408000000001em;"><span class="pstrut" style="height:3.8791470000000006em;"></span><span class="mord"></span></span><span style="top:-1.8124080000000005em;"><span class="pstrut" style="height:3.8791470000000006em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.332739em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.832739000000001em;"><span style="top:-6.8205550000000015em;"><span class="pstrut" style="height:3.8791470000000006em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">假</span><span class="mord cjk_fallback">设</span><span class="mord">∃</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">有</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">于</span><span class="mord">∀</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-4.281408000000001em;"><span class="pstrut" style="height:3.8791470000000006em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">每</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">等</span><span class="mord cjk_fallback">比</span><span class="mord cjk_fallback">例</span><span class="mord cjk_fallback">收</span><span class="mord cjk_fallback">敛</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">：</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">于</span><span class="mord">∀</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791470000000006em;"><span class="svg-align" style="top:-5.116816em;"><span class="pstrut" style="height:5.116816em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.670496em;"><span style="top:-2.4231360000000004em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.8391470000000005em;"><span class="pstrut" style="height:5.116816em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.196816em;"><svg width='400em' height='3.196816em' viewBox='0 0 400000 3196' preserveAspectRatio='xMinYMin slice'><path d='M702 80H400000v40H742v3062l-4 4-4 4c-.667.7
-2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667
-294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155
 77-156c66 199.333 139 419.667 219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-1.8124080000000005em;"><span class="pstrut" style="height:3.8791470000000006em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">于</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">应</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">平</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">令</span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.009em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">即</span><span class="mord cjk_fallback">离</span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">平</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">近</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">点</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">应</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">距</span><span class="mord cjk_fallback">离</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.332739em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<img src="https://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220511230922523.png" alt="image-20220511230922523" style="zoom:50%;"/>
<p>由此，我们得到一个关于更新次数和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span>之间关系的定理：</p>
<h3 id="定理-3-1">定理 3-1</h3>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">感</mi><mi mathvariant="normal">知</mi><mi mathvariant="normal">机</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">法</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">多</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">超</mi><mi mathvariant="normal">平</mi><mi mathvariant="normal">面</mi><mi mathvariant="normal">进</mi><mi mathvariant="normal">行</mi><mfrac><mn>1</mn><msup><mi>γ</mi><mn>2</mn></msup></mfrac><mi mathvariant="normal">次</mi><mi mathvariant="normal">调</mi><mi mathvariant="normal">整</mi></mrow><annotation encoding="application/x-tex">感知机算法最多对超平面进行\frac1{\gamma^2}次调整
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord cjk_fallback">感</span><span class="mord cjk_fallback">知</span><span class="mord cjk_fallback">机</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">法</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">多</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">平</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">调</span><span class="mord cjk_fallback">整</span></span></span></span></span></p>
<p>此处的调整次数（更新次数）即为上述伪码中for循环中执行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> </mtext><mi>w</mi><mo>=</mo><mi>w</mi><mo>+</mo><mi>y</mi><mi>x</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">~w=w+yx~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">x</span><span class="mspace nobreak"> </span></span></span></span>的次数，对上述定理的证明如下：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span>是基于上述<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">w^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>所对应的超平面得来的，证明过程主要讨论<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">w^Tw^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi></mrow><annotation encoding="application/x-tex">w^Tw</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>的大小关系：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mn>1</mn><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">如</mi><mi mathvariant="normal">果</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>≤</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">根</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">法</mi><mi mathvariant="normal">：</mi><mi>w</mi><mo>=</mo><mi>w</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">则</mi><mtext> </mtext><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><mo>(</mo><mi>w</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><msup><mo>)</mo><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><mo>+</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msubsup><mi>y</mi><mi>i</mi><mi>T</mi></msubsup><mo>)</mo><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>w</mi><mo>∗</mo></msup><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∵</mo><mi>γ</mi><mo>=</mo><munder><mi>min</mi><mo>⁡</mo><mrow><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>∈</mo><mi>D</mi></mrow></munder><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>w</mi><mo>∗</mo></msup><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext> </mtext><mi mathvariant="normal">且</mi><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>w</mi><mo>∗</mo></msup><mo>)</mo><mo>&gt;</mo><mn>0</mn><mtext> </mtext><mo>∴</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>w</mi><mo>∗</mo></msup><mo>)</mo><mo>≥</mo><mi>γ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∴</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>w</mi><mo>∗</mo></msup><mo>)</mo><mo>≥</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>+</mo><mi>γ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mn>2</mn><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">如</mi><mi mathvariant="normal">果</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>≤</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">根</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">法</mi><mi mathvariant="normal">：</mi><mi>w</mi><mo>=</mo><mi>w</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">则</mi><mtext> </mtext><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>=</mo><mo>(</mo><mi>w</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><msup><mo>)</mo><mi>T</mi></msup><mo>(</mo><mi>w</mi><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>+</mo><mn>2</mn><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>+</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∵</mo><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mo>{</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo>}</mo><mtext> </mtext><mi mathvariant="normal">且</mi><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>≤</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">收</mi><mi mathvariant="normal">敛</mi><mi mathvariant="normal">后</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">∣</mi><mn>2</mn></msub><mo>≤</mo><mn>1</mn><mtext> </mtext><mo>∴</mo><mtext> </mtext><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mn>1</mn><mo separator="true">,</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∴</mo><mtext> </mtext><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>+</mo><mn>2</mn><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mo>(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>+</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
1)&amp;如果y_i\cdot(w^Tx_i)\le0,根据算法：w=w+y_ix_i\\
&amp;则~w^Tw^*=(w+y_ix_i)^Tw^*=(w^T+x_i^Ty_i^T)w^*=w^Tw^*+y_i\cdot(x_i^Tw^*)\\
&amp;\because \gamma=\min_{(x_i,y_i)\in D}||x_i^Tw^*||~且~ y_i\cdot(x_i^Tw^*)&gt;0~\therefore y_i\cdot(x_i^Tw^*)\ge \gamma\\
&amp;\therefore w^Tw^*=w^Tw^*+y_i\cdot(x_i^Tw^*)\ge w^Tw^*+\gamma\\
2)&amp;如果y_i\cdot(w^Tx_i)\le0,根据算法：w=w+y_ix_i\\
&amp;则~w^Tw=(w+y_ix_i)^T(w+y_ix_i)=w^Tw+2y_i\cdot(w^Tx_i)+y_i^2x_i^Tx_i\\
&amp;\because y_i\in\{-1,+1\}~且~y_i\cdot(w^Tx_i)\le0,数据收敛后||x_i||_2\le1~\therefore~y_i^2=1,x_i^Tx_i\le 1\\
&amp;\therefore~w^Tw=w^Tw+2y_i\cdot(w^Tx_i)+y_i^2x_i^Tx_i\le w^Tw+1
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:13.016648em;vertical-align:-6.258324em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.758323999999999em;"><span style="top:-8.866992999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-7.315662em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-5.764330999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.6069999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.055668999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top:-0.5043379999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:1.0469930000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:2.598324em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.258324em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.758323999999999em;"><span style="top:-8.866992999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">如</span><span class="mord cjk_fallback">果</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">根</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">法</span><span class="mord cjk_fallback">：</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-7.315662em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">则</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-5.764330999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∵</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.009em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">且</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span><span style="top:-3.6069999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span><span style="top:-2.055668999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">如</span><span class="mord cjk_fallback">果</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">根</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">法</span><span class="mord cjk_fallback">：</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.5043379999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">则</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:1.0469930000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∵</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">且</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">收</span><span class="mord cjk_fallback">敛</span><span class="mord cjk_fallback">后</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:2.598324em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.258324em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>调整的过程就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>向<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">w^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>趋近的过程，在算法的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">for</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>循环中，如果进行了调整，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">w^Tw^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>至少增加了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi></mrow><annotation encoding="application/x-tex">w^Tw</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>至多增加了1</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">设</mi><mi mathvariant="normal">总</mi><mi mathvariant="normal">共</mi><mi mathvariant="normal">调</mi><mi mathvariant="normal">整</mi><mi mathvariant="normal">了</mi><mi>M</mi><mi mathvariant="normal">次</mi><mi mathvariant="normal">，</mi><mi mathvariant="normal">则</mi><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>≤</mo><mi>M</mi><mo>≤</mo><mfrac><mrow><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup></mrow><mi>γ</mi></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∵</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msup><mi>w</mi><mo>∗</mo></msup><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn><mtext> </mtext><mo>∴</mo><mtext> </mtext><mi>γ</mi><mi>M</mi><mo>≤</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>w</mi><mo>∗</mo></msup><mo>≤</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msup><mi>w</mi><mi>T</mi></msup><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>⋅</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msup><mi>w</mi><mo>∗</mo></msup><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>=</mo><msqrt><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi></mrow></msqrt><mo>≤</mo><msqrt><mi>M</mi></msqrt></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∴</mo><mi>M</mi><mo>≤</mo><mfrac><mn>1</mn><msup><mi>γ</mi><mn>2</mn></msup></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;设总共调整了M次，则w^Tw\le M\le\frac{w^Tw^*}{\gamma}\\
&amp;\because ||w^*||=1~\therefore~\gamma M\le w^Tw^*\le||w^T||\cdot||w^*||=||w||=\sqrt{w^Tw}\le\sqrt{M}\\
&amp;\therefore M\le\frac1{\gamma^2}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.8781915em;vertical-align:-3.18909575em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.68909575em;"><span style="top:-5.68909575em;"><span class="pstrut" style="height:3.518331em;"></span><span class="mord"></span></span><span style="top:-3.49111525em;"><span class="pstrut" style="height:3.518331em;"></span><span class="mord"></span></span><span style="top:-1.5096752500000001em;"><span class="pstrut" style="height:3.518331em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.18909575em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.68909575em;"><span style="top:-5.68909575em;"><span class="pstrut" style="height:3.518331em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">设</span><span class="mord cjk_fallback">总</span><span class="mord cjk_fallback">共</span><span class="mord cjk_fallback">调</span><span class="mord cjk_fallback">整</span><span class="mord cjk_fallback">了</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">则</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.49111525em;"><span class="pstrut" style="height:3.518331em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∵</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0175405em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span><span style="top:-2.9775405em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.022459499999999966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9755400000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-2.93554em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.06445999999999996em;"><span></span></span></span></span></span></span></span><span style="top:-1.5096752500000001em;"><span class="pstrut" style="height:3.518331em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∴</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.18909575em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="四-算法实现">四、算法实现</h2>
<p>根据上述伪码，我们将通过手动实现与调库的方式，分别实现状态机。</p>
<h3 id="41-数据集">4.1 数据集</h3>
<p>在本次算法实战中，我们将使用到的数据集为sklearn所提供的乳腺癌数据集，我们首先先来了解一下数据集的内容：</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要的库'''
import numpy as np
import pandas as pd
from sklearn.datasets import load_breast_cancer

cancer=load_breast_cancer()
print(cancer.data)#输出数据集内容
print(cancer.target)#输出每个数据集的标签
print(cancer.feature_names)#输出数据集每一列对应的特征
print(cancer.target_names)#输出数据集的标签种类
'''将数据集存储为csv文件'''
df=pd.DataFrame(data=cancer.data,columns=cancer.feature_names)#构建二维表格
df['label']=cancer.target
df.to_csv(&quot;data/cancer_data.csv&quot;,index=False)
</code></pre>
<p>最终我们得到的数据集如下图所示，总共有569个数据，每条数据有30个特征，标签0，1分别代表是否患癌症。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/20220729180742.png" style="zoom: 33%;" />
<h3 id="42-手动实现模型">4.2 手动实现模型</h3>
<p>参考伪码，我们可以实现感知机的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">fit</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span>函数，在此基础上我们引入了两个新的量<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;_&#039; at position 13: lr和max\text{_̲}iter'>lr和max\text{_}iter</span>，学习率<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">lr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>控制每次对超平面的更新程度，最大训练轮数<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;_&#039; at position 10: max\text{_̲}iter'>max\text{_}iter</span>避免数据线性不可分时出现死循环。</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要的库'''
import numpy as np
import pandas as pd
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

class Perceptron(object):
    '''初始化模型'''
    def __init__(self, learning_rate = 0.01, max_iter = 200):
        self.lr = learning_rate     #学习率
        self.max_iter = max_iter    #最大训练轮数
    '''模型训练'''
    def fit(self,data,label):                   #注意data和label都为numpy数组
        self.w = np.array([0.]*data.shape[1])   #权重向量
        self.b = np.array([0.])                 #偏差项
        iter=0                                  #训练轮数
        while True:
            m=0
            for i in range(data.shape[1]):
                x=data[i]
                y=label[i]
                if y*(np.dot(self.w,x)+self.b)&lt;=0:#分类错误，进行更新
                    self.w=self.w+self.lr*y*x
                    self.b=self.b+self.lr*y	#注意在这里我们也对偏差项进行了更新
                    m=m+1
            if m==0:    #在训练集上没有错误
                break
            iter+=1
            if iter&gt;=self.max_iter: #达到最大训练轮数
                break
    '''进行预测'''
    def predict(self,data):
        y_pre = np.matmul(data,self.w) + self.b
        for i in range(len(y_pre)):
            if y_pre[i]&gt;=0:
                y_pre[i]=1
            else:
                y_pre[i]=-1
        return y_pre

'''进行预测'''
cancer=load_breast_cancer()
X=cancer.data
y=np.where(cancer.target==0,-1,1)#重点：一定要将标签修正为-1,+1
'''数据划分'''
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)#选取20%的数据作为测试集
'''初始化感知机'''
params={
    &quot;learning_rate&quot;:0.01,
    &quot;max_iter&quot;:250
}
perceptron=Perceptron(**params)
'''感知机训练'''
perceptron.fit(X_train,y_train)
'''模型预测与评估'''
y_pred=perceptron.predict(X_test)
print(accuracy_score(y_test,y_pred))
</code></pre>
<p>上述的参数得到的准确率为0.9035087719298246，我们可以通过调参过程使得准确率趋于最优。</p>
<h3 id="43-调库实现模型">4.3 调库实现模型</h3>
<p>模型的训练主要用到sklearn所提供的库函数Perceptron，它的函数原型如下：</p>
<pre><code class="language-python">Perceptron(penalty=None, alpha=0.0001, fit_intercept=True, max_iter=None, tol=None, shuffle=True, verbose=0, eta0=1.0, n_jobs=None, random_state=0, early_stopping=False, validation_fraction=0.1, n_iter_no_change=5, class_weight=None, warm_start=False, n_iter=None)
</code></pre>
<p>①penalty：正则化项，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">l2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord">2</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">l1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord">1</span></span></span></span>或弹性网络。<br>
②alpha：正则化项系数，如果使用正则化项，则在正则化项前乘上该系数<br>
③fit_intercept：是否需要计算截距<br>
④max_iter：最大训练轮数<br>
⑤tol：训练的停止标准，训练将在<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;_&#039; at position 20: …&gt;previous\text{_̲}loss-tol'>loss&gt;previous\text{_}loss-tol</span>时停止<br>
⑥shuffle：是否在每轮训练后对训练数据进行随机排列<br>
⑦eta0：学习率</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要的库'''
import numpy as np
import pandas as pd
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.linear_model import Perceptron

'''进行预测'''
cancer=load_breast_cancer()
X=cancer.data
y=np.where(cancer.target==0,-1,1)#重点：一定要将标签修正为-1,+1
'''数据划分'''
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)#选取20%的数据作为测试集
'''初始化感知机'''
params={
    &quot;penalty&quot;:&quot;l1&quot;,
    &quot;alpha&quot;:0.0001,
    &quot;fit_intercept&quot;:True,
    &quot;max_iter&quot;:200,
    &quot;tol&quot;:0.001,
    &quot;shuffle&quot;:True,
    &quot;eta0&quot;:0.01
}
perceptron=Perceptron(**params)
'''感知机训练'''
perceptron.fit(X_train,y_train)
'''模型预测与评估'''
y_pred=perceptron.predict(X_test)
print(accuracy_score(y_test,y_pred))
</code></pre>
<h3 id="44-可视化">4.4 可视化</h3>
<p>我们不妨仅选取两个特征对模型进行训练，观察感知机模型最终得到的超平面划分是什么样的，我们利用make_classification创造具有两个特征的用于二分类的数据集，调用库函数进行预测：</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要的库'''
import numpy as np
import pandas as pd
from sklearn.datasets import load_breast_cancer
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.linear_model import Perceptron
from sklearn.datasets import make_classification

'''进行预测'''
X,y = make_classification(n_samples=1000, n_features=2,n_redundant=0,n_informative=1,n_clusters_per_class=1)
y=np.where(y==0,-1,1)
print(y)
'''数据划分'''
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)#选取20%的数据作为测试集
'''初始化感知机'''
params={
    &quot;penalty&quot;:&quot;l1&quot;,
    &quot;alpha&quot;:0.0001,
    &quot;fit_intercept&quot;:True,
    &quot;max_iter&quot;:200,
    &quot;tol&quot;:0.001,
    &quot;shuffle&quot;:True,
    &quot;eta0&quot;:0.01
}
perceptron=Perceptron(**params)
'''感知机训练'''
perceptron.fit(X_train,y_train)
'''模型预测与评估'''
y_pred=perceptron.predict(X_test)
print(accuracy_score(y_test,y_pred))
'''可视化'''
is_cancer_x,is_cancer_y=[],[]
no_cancer_x,no_cancer_y=[],[]
for i in range(len(X)):
    if(y[i]==1):
        is_cancer_x.append(X[i][0])
        is_cancer_y.append(X[i][1])
    if(y[i]==-1):
        no_cancer_x.append(X[i][0])
        no_cancer_y.append(X[i][1])
line_x = np.arange(-4,4)
line_y = line_x * (-perceptron.coef_[0][0] / perceptron.coef_[0][1]) + perceptron.intercept_
print(perceptron.coef_,perceptron.intercept_)
ax=plt.figure(figsize=(10,4),dpi=100).add_subplot()#初始化画板
ax.scatter(is_cancer_x,is_cancer_y,c=&quot;yellow&quot;,label=&quot;is_cancer&quot;)
ax.scatter(no_cancer_x,no_cancer_y,c=&quot;purple&quot;,label=&quot;no_cancer&quot;)
ax.plot(line_x,line_y,label=&quot;perceptron&quot;)
plt.legend()
plt.show()
</code></pre>
<img src="https://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/20220730165836.png" style="zoom:50%;" />
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[机器学习实战（三）：KNN算法]]></title>
        <id>https://2006wzt.github.io/post/机器学习实战（三）：KNN算法/</id>
        <link href="https://2006wzt.github.io/post/机器学习实战（三）：KNN算法/">
        </link>
        <updated>2022-07-29T04:32:31.000Z</updated>
        <content type="html"><![CDATA[<h1 id="k-nn算法">K-NN算法</h1>
<h2 id="一-形式化定义">一、形式化定义</h2>
<p>K-NN算法（k-nearest neighbor）是一种基本的分类与回归算法，在本节我们主要以分类问题为例介绍K-NN算法。<br>
K-NN模型是一个非参数化模型，参数数量随着训练数据的规模增长，更加的灵活，但是却又较高的计算成本。</p>
<p>①模型假设：相似的输入有着相似的输出<br>
②分类规则：对于测试输入x，在其k个最相似的训练输入之间分配最常见的标签<br>
③回归规则：输出是对象的属性值，该值是k个最近邻值的平均值。</p>
<p>设训练集为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>，输入的测试点的特征向量为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>个近邻点表示为集合<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">S_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">S_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>有如下性质：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">①</mi><msub><mi>S</mi><mi>x</mi></msub><mo>∈</mo><mi>D</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">②</mi><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mi>x</mi></msub><mi mathvariant="normal">∣</mi><mo>=</mo><mi>k</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">③</mi><mi mathvariant="normal">∀</mi><mo>(</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>∈</mo><mi>D</mi><mo>−</mo><msub><mi>S</mi><mi>x</mi></msub><mo separator="true">,</mo><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>≥</mo><munder><mi>max</mi><mo>⁡</mo><mrow><mo>(</mo><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo>)</mo><mo>∈</mo><msub><mi>S</mi><mi>x</mi></msub></mrow></munder><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;①S_x\in D\\
&amp;②|S_x|=k\\
&amp;③\forall (x&#x27;,y&#x27;)\in D-S_x,\text{dist}(x,x&#x27;)\ge \max_{(x&#x27;&#x27;,y&#x27;&#x27;)\in S_x}\text{dist}(x,x&#x27;&#x27;)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.106000000000002em;vertical-align:-2.303000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8030000000000004em;"><span style="top:-4.803em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.303em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.802999999999999em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.303000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8030000000000004em;"><span style="top:-4.963em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">①</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.463em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">②</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span><span style="top:-1.9629999999999992em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">③</span><span class="mord">∀</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.009em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.303000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>根据分类规则，我们可以得到模型函数：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mtext>mode</mtext><mo>(</mo><mo>{</mo><msup><mi>y</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo>:</mo><mo>(</mo><msup><mi>x</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo>)</mo><mo>∈</mo><msub><mi>S</mi><mi>x</mi></msub><mo>}</mo><mo>)</mo><mspace linebreak="newline"></mspace><mtext>mode</mtext><mi mathvariant="normal">返</mi><mi mathvariant="normal">回</mi><mi mathvariant="normal">集</mi><mi mathvariant="normal">合</mi><mi mathvariant="normal">中</mi><mi mathvariant="normal">出</mi><mi mathvariant="normal">现</mi><mi mathvariant="normal">频</mi><mi mathvariant="normal">率</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">高</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">签</mi><msup><mi>y</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h(x)=\text{mode}(\{y&#x27;&#x27;:(x&#x27;&#x27;,y&#x27;&#x27;)\in S_x\})\\
\text{mode}返回集合中出现频率最高的标签y&#x27;&#x27;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">mode</span></span><span class="mopen">(</span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.996332em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">mode</span></span><span class="mord cjk_fallback">返</span><span class="mord cjk_fallback">回</span><span class="mord cjk_fallback">集</span><span class="mord cjk_fallback">合</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">出</span><span class="mord cjk_fallback">现</span><span class="mord cjk_fallback">频</span><span class="mord cjk_fallback">率</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">高</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">签</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>根据上述定义，我们可以通过下图更直观得认识KNN算法，当K=1时，新的数据点被分类为正方形，当K=3时，新的数据点被分为三角形</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220721224302969.png" alt="image-20220721224302969" style="zoom:55%;"/>
<h2 id="二-参数选择">二、参数选择</h2>
<h3 id="21-距离函数">2.1 距离函数</h3>
<p>K-NN分类器基本上依赖于距离函数的选择，距离度量越能反映标签的相似性，分类器的性能就越好。<br>
最为常用的距离函数为闵可夫斯基距离（Minkowski distance），设数据点的特征向量为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>维向量，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(x&#x27;,y&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>之间的距离为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>=</mo><mo>(</mo><munderover><mo>∑</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>r</mi></msub><mo>−</mo><msubsup><mi>x</mi><mi>r</mi><mo mathvariant="normal">′</mo></msubsup><msup><mi mathvariant="normal">∣</mi><mi>p</mi></msup><msup><mo>)</mo><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow><annotation encoding="application/x-tex">\text{dist}(x,x&#x27;)=(\sum_{r=1}^d|x_r-x&#x27;_r|^p)^{\frac1p}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1032260000000003em;vertical-align:-1.267113em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2867899999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0367899999999999em;"><span style="top:-3.44577em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.48288571428571425em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>d</mi></msub><mo>)</mo><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mo>(</mo><msubsup><mi>x</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>2</mn><mo mathvariant="normal">′</mo></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mi>x</mi><mi>d</mi><mo mathvariant="normal">′</mo></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">x=(x_1,x_2,...,x_d),x&#x27;=(x&#x27;_1,x&#x27;_2,...,x&#x27;_d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>取值不同时，得到不同的距离函数。</p>
<p>①<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">p=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>时，为欧氏距离：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>r</mi></msub><mo>−</mo><msubsup><mi>x</mi><mi>r</mi><mo mathvariant="normal">′</mo></msubsup><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">\text{dist}(x,x&#x27;)=\sqrt{\sum_{r=1}^d|x_r-x&#x27;_r|^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.3309760000000006em;vertical-align:-1.267113em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0638630000000004em;"><span class="svg-align" style="top:-5.290976000000001em;"><span class="pstrut" style="height:5.290976000000001em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.677892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-4.023863em;"><span class="pstrut" style="height:5.290976000000001em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.370976em;"><svg width='400em' height='3.370976em' viewBox='0 0 400000 3370' preserveAspectRatio='xMinYMin slice'><path d='M702 80H400000v40H742v3236l-4 4-4 4c-.667.7
-2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667
-294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155
 77-156c66 199.333 139 419.667 219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>欧几里得度量（Euclidean Metric）是一个通常采用的距离定义，指在d维空间中两个点之间的真实距离，或者向量的自然长度（即该点到原点的距离），在二维和三维空间中的欧氏距离就是两点之间的实际距离。</p>
<p>②<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>时，为曼哈顿距离：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>r</mi></msub><mo>−</mo><msubsup><mi>x</mi><mi>r</mi><mo mathvariant="normal">′</mo></msubsup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\text{dist}(x,x&#x27;)=\sum_{r=1}^d|x_r-x&#x27;_r|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1032260000000003em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<p>想象你在城市道路里，要从一个十字路口开车到另外一个十字路口，驾驶距离是两点间的直线距离吗？显然不是，除非你能穿越大楼。<br>
实际驾驶距离就是这个“曼哈顿距离”。而这也是曼哈顿距离名称的来源，曼哈顿距离也称为城市街区距离（City Block distance）。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220507224939214.png" alt="image-20220507224939214" style="zoom:60%;"/>
<p>③<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">p=\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>时，为切比雪夫距离：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>=</mo><munder><mi>max</mi><mo>⁡</mo><mi>r</mi></munder><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>r</mi></msub><mo>−</mo><msubsup><mi>x</mi><mi>r</mi><mo mathvariant="normal">′</mo></msubsup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\text{dist}(x,x&#x27;)=\max_r|x_r-x&#x27;_r|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43056em;"><span style="top:-2.1em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<p>二个点之间的切比雪夫距离定义是其各坐标数值差绝对值的最大值。<br>
国际象棋棋盘上二个位置间的切比雪夫距离是指王要从一个位子移至另一个位子需要走的步数。由于王可以往斜前或斜后方向移动一格,因此可以较有效率的到达目的的格子。上图是棋盘上所有位置距<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">f6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord">6</span></span></span></span>位置的切比雪夫距离。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220507225236135.png" alt="image-20220507225236135" style="zoom:65%;"/>
<h3 id="22-k参数">2.2 K参数</h3>
<p>我们应该如何选择一个合适的K值使得分类器的效果达到最优？</p>
<p>1）一个较小的K值：<br>
①减少在学习过程中的近似误差，即减小在训练集上的误差<br>
②扩大在学习过程中的估计误差，即增大在测试集上的误差<br>
③会使得模型更加复杂，容易导致过拟合</p>
<p>2）一个较大的K值：<br>
①减少在学习过程中的估计误差，即减小在测试集上的误差<br>
②扩大在学习过程中的近似误差，即增大在训练集上的误差<br>
③会使得模型更加简单</p>
<p>因此我们需要对K值进行一个权衡，这取决于所提供的数据集。通常，较大的k值会减少噪声对分类的影响，但会使类之间的边界不那么明显，在二分类问题中，选择k为奇数有助于避免并列。</p>
<h2 id="三-特殊的k-nn分类器">三、特殊的K-NN分类器</h2>
<h3 id="31-1-nn分类器">3.1 1-NN分类器</h3>
<p>当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>时，我们得到的分类器便是1-NN分类器，这是一个最为直观的K-NN分类器，选取离得最近的那个数据点的标签作为预测标签。<br>
1-NN边界划分的方法：<strong>选定每一个点最近的那个邻居，作它们连线间的中垂线，中垂线相连形成边界</strong>，得到的分类边界如下图所示</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508152719515.png" alt="image-20220508152719515" style="zoom: 33%;"/>
<h3 id="32-贝叶斯最优分类器">3.2 贝叶斯最优分类器</h3>
<p>假如我们知道了任何<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>对应的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>，即知道分布<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(y|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>（这在现实中不可能），这样对于一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>你就可以简单地预测最有可能的标签，Bayes optimal classifier预测为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo>=</mo><msub><mi>h</mi><mrow><mi>o</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>y</mi></munder><mtext> </mtext><mi>P</mi><mo>(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat y=h_{opt}(x)=\underset{y}{argmax}~P(y|x)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.780548em;vertical-align:-1.030548em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.20556em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.030548em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span></p>
<p>即：对于一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>，取概率最高的标签作为预测的标签，Bayes optimal classifier 仍然可能出错，它的出错率即为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>B</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>s</mi><mi>O</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><msub><mi>h</mi><mrow><mi>o</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>(</mo><mi>x</mi><mo>)</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\epsilon_{BayesOpt}=1-P(h_{opt}(x)|x)=1-P(\hat y|x)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span></p>
<p>例：假设一个二分类问题，标签仅有+1和-1两种，并且对于某个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>，有：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mo>+</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><mn>0.8</mn><mo separator="true">,</mo><mi>P</mi><mo>(</mo><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">P(+1|x)=0.8,P(-1|x)=0.2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord">+</span><span class="mord">1</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span></span></span></span></span></p>
<p>因此根据Bayes optimal classifier可得：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mo>+</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>ϵ</mi><mrow><mi>B</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>s</mi><mi>O</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\hat y=+1,\epsilon_{BayesOpt}=0.2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9305479999999999em;vertical-align:-0.286108em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span></span></span></span></span></p>
<p>由此我们可以知道贝叶斯最优分类器的错误率是在给定数据分布时的最小可实现错误率。同时我们也能得到如下定理：</p>
<h4 id="定理-3-1">定理 3-1</h4>
<pre><code>当训练数据集的大小接近无穷大时，一个最近邻分类器(1-NN)保证错误率不低于贝叶斯错误率的两倍。
</code></pre>
<p>证明如下：</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508154646749.png" alt="image-20220508154646749" style="zoom:50%;"/>
<p>如上图所示，在数据集趋近于无穷大时，对于任何一个数据点，它与K个近邻的距离趋近于0，即：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">设</mi><mi mathvariant="normal">测</mi><mi mathvariant="normal">试</mi><mi mathvariant="normal">点</mi><mi mathvariant="normal">为</mi><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">，</mi><mi mathvariant="normal">它</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">近</mi><mi mathvariant="normal">邻</mi><mi mathvariant="normal">为</mi><msub><mi>x</mi><mrow><mi>N</mi><mi>N</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">当</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">集</mi><mi mathvariant="normal">大</mi><mi mathvariant="normal">小</mi><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi><mi mathvariant="normal">时</mi><mi mathvariant="normal">，</mi><mtext>dist</mtext><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>N</mi><mi>N</mi></mrow></msub><mo>)</mo><mo>→</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mi>t</mi></msub><mo>→</mo><mtext> </mtext><msub><mi>x</mi><mrow><mi>N</mi><mi>N</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">因</mi><mi mathvariant="normal">此</mi><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">预</mi><mi mathvariant="normal">测</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">签</mi><mi mathvariant="normal">将</mi><mi mathvariant="normal">为</mi><msub><mi>x</mi><mrow><mi>N</mi><mi>N</mi></mrow></msub><mi mathvariant="normal">的</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">签</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;设测试点为x_t，它的近邻为x_{NN},当数据集大小n\rightarrow\infty时，\text{dist}(x_t,x_{NN})\rightarrow0\\
&amp;x_t\rightarrow~x_{NN},因此x_t预测的标签将为x_{NN}的标签
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">设</span><span class="mord cjk_fallback">测</span><span class="mord cjk_fallback">试</span><span class="mord cjk_fallback">点</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">它</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">近</span><span class="mord cjk_fallback">邻</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">当</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">集</span><span class="mord cjk_fallback">大</span><span class="mord cjk_fallback">小</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">∞</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">，</span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">因</span><span class="mord cjk_fallback">此</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">预</span><span class="mord cjk_fallback">测</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">签</span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">签</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508154756213.png" alt="image-20220508154756213" style="zoom:50%;"/>
<p>如上图所示，我们以垃圾邮件分类为例，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Spam</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span></span></span></span>为垃圾邮件，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mi>a</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Ham</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span></span></span></span>为正常邮件，假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>N</mi><mi>N</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{NN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的标签为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Spam</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span></span></span></span>，则有：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>ϵ</mi><mrow><mi>B</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>s</mi><mi>O</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>ϵ</mi><mrow><mn>1</mn><mo>−</mo><mi>N</mi><mi>N</mi></mrow></msub><mo>=</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>)</mo><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>)</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><mn>2</mn><mo>(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>)</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>&lt;</mo><mn>2</mn><mo>(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo>(</mo><mi>s</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>)</mo><mo>=</mo><mn>2</mn><msub><mi>ϵ</mi><mrow><mi>B</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>s</mi><mi>O</mi><mi>p</mi><mi>t</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;\epsilon_{BayesOpt}=1-P(s|x)\\
&amp;\epsilon_{1-NN}=P(s|x)(1-P(s|x))+(1-P(s|x))P(s|x)=2(1-P(s|x))P(s|x)&lt;2(1-P(s|x))=2\epsilon_{BayesOpt}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="四-维度灾难">四、维度灾难</h2>
<p>当向量的维度很高时，KNN模型将变得非常不稳定。</p>
<h3 id="41-数据点之间的距离">4.1 数据点之间的距离</h3>
<p>首先让我们想象一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>维的单位超立方体<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo>]</mo><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">[0,1]^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span>，所有的数据都在此超立方体内均匀采样，即对于任意的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mo>[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo>]</mo><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">x_i\in[0,1]^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span>。接着我们不妨考虑一下<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">K=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span></span></span></span>时，对于一个测试点它的近邻所在的超立方体，如下图所示：</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508161218775.png" style="zoom: 67%;" />
<p>设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> </mtext><mi>l</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">~l~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace nobreak"> </span></span></span></span>是包含<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>个近邻的最小超立方体的边长，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> </mtext><mi>n</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">~n~</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault">n</span><span class="mspace nobreak"> </span></span></span></span>是取样的数据点数，因为数据集是在该单位超立方体中均匀取样，则有：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>l</mi><mi>d</mi></msup><mo>=</mo><mfrac><mi>k</mi><mi>n</mi></mfrac><mo separator="true">,</mo><mi>l</mi><mo>=</mo><mo>(</mo><mfrac><mi>k</mi><mi>n</mi></mfrac><msup><mo>)</mo><mfrac><mn>1</mn><mi>d</mi></mfrac></msup></mrow><annotation encoding="application/x-tex">l^d=\frac{k}{n},l=(\frac{k}{n})^{\frac1d}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0040200000000001em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">d</span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>=</mo><mn>10</mn><mo separator="true">,</mo><mi>n</mi><mo>=</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">K=10,n=1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span>时的情况，则有：</p>
<table>
<thead>
<tr>
<th style="text-align:center">d</th>
<th style="text-align:center">l</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0.1</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">0.63</td>
</tr>
<tr>
<td style="text-align:center">100</td>
<td style="text-align:center">0.955</td>
</tr>
<tr>
<td style="text-align:center">1000</td>
<td style="text-align:center">0.9954</td>
</tr>
</tbody>
</table>
<p>因此，当维度很高（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>&gt;</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d&gt;&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>）时，几乎需要整个空间才能找到某个测试点的10个近邻。<br>
从而导致最近的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>个邻居并不比训练集中其他的点离测试点更近。</p>
<p>这是因为，在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>维空间中随机分布的点之间的距离逐渐趋近于一个很小的范围内，如下图所示：</p>
<img src="https://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508162836224.png" alt="image-20220508162836224" style="zoom:50%;"/>
<h3 id="42-到超平面的距离">4.2 到超平面的距离</h3>
<p>对于二分类问题，我们往往是在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>维空间中寻找一个超平面，将空间一分为二，超平面两侧的数据即为不同的标签。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508163131448.png" style="zoom:50%;" />
<p>如上图所示，维度灾难对于两点之间的距离和点与超平面之间的距离有不同的影响。<br>
同一维度中的移动不能增加或减少到超平面的距离，点只是四处移动并与超平面保持相同的距离。但随着维度的升高，成对点之间的距离变得非常大，到超平面的距离变得相对较小。</p>
<p><font color=PURPLE><strong>维数灾难的一个后果是，大多数数据点往往非常接近这些超平面，并且通常可能轻微的扰动就会更改分类。</strong></font></p>
<h3 id="43-数据降维">4.3 数据降维</h3>
<p>为了解决维度灾难，最好的方法便是对数据进行降维操作，我们以图像识别为例：虽然一张脸的图像可能需要1800万像素，但是我们可能只需要用少于50个属性（例如男性/女性、金发/深色头发等）就可以描述一个人，这些属性会随着脸的变化而变化。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220508164158152.png" style="zoom: 67%;" />
<p>如上图所示，这是从底层二维流形绘制的三维数据集示例。蓝色点位于粉色表面之上，而粉色表面则嵌入在三维空间之中，粉色表面映射为二维平面，进而将数据集从三维映射到二维，实现数据降维。</p>
<h2 id="五-算法实战">五、算法实战</h2>
<p>本次我们使用Scikit-learn所提供的鸢尾花数据集，通过调库的方式实现K-NN算法。</p>
<h3 id="51-数据集">5.1 数据集</h3>
<p>我们首先了解一下该数据集的特点，读取数据并将其存储为csv文件的方式如下：</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要库'''
import numpy as np
import pandas as pd
from sklearn import datasets

'''读取并展示数据'''
iris=datasets.load_iris()
print(iris.data)#输出数据集内容
print(iris.target)#输出每个数据集的标签
print(iris.feature_names)#输出数据集每一列对应的特征
print(iris.target_names)#输出数据集的标签种类
'''将数据集存储为csv文件'''
df=pd.DataFrame(data=iris.data,columns=iris.feature_names)#构建二维表格
df['label']=iris.target
df.to_csv(&quot;data/iris_data.csv&quot;,index=False)
</code></pre>
<p>我们最终得到的数据集如下图所示，总共有150个数据，每条数据有4个特征，分别为花萼长度、花萼宽度、花瓣长度、花瓣宽度，相应的不同特征所对应的标签共有3种，分别为setosa、versicolor、virginica，即鸢尾花的三个种类。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/20220727235413.png" style="zoom:67%;" />
<h3 id="52-模型训练">5.2 模型训练</h3>
<p>模型的训练主要用到sklearn所提供的库函数KNeighborsClassifier，它的函数原型如下：</p>
<pre><code class="language-python">KNeighborsClassifier(n_neighbors=5,weights='uniform',algorithm='auto',leaf_size=30,p=2,metric='minkowski',metric_params=None,n_jobs=1,**kwargs)
</code></pre>
<p>①n_neighbors：即K值的大小，默认为5</p>
<p>②weights：用于预测的权重函数。可选参数如下:</p>
<pre><code class="language-python">'uniform': 统一的权重. 在每一个邻居区域里的点的权重都是一样的。
'distance' : 权重点等于他们距离的倒数。使用此函数，更近的邻居对于所预测的点的影响更大。
[callable] : 一个用户自定义的方法，此方法接收一个距离的数组，然后返回一个相同形状并且包含权重的数组。
</code></pre>
<p>③algorithm：计算最近邻居用的算法。可选参数如下：</p>
<pre><code class="language-python">'ball_tree':是为了克服kd树高纬失效而发明的，其构造过程是以质心C和半径r分割样本空间，每个节点是一个超球体。
'kd_tree':构造kd树存储数据以便对其进行快速检索的树形数据结构，kd树也就是数据结构中的二叉树。以中值切分构造的树，每个结点是一个超矩形，在维数小于20时效率高。
'brute':使用暴力搜索.也就是线性扫描，当训练集很大时，计算非常耗时
'auto':基于传入fit方法的内容，选择最合适的算法。
</code></pre>
<p>球树与kd树将会在后续文章中进行介绍，这是一种优化KNN算法的方式。</p>
<p>④leaf_size：传入BallTree或者KDTree算法的叶子数量，此参数会影响构建、查询BallTree或者KDTree的速度，以及存储BallTree或者KDTree所需要的内存大小。</p>
<p>⑤p：用于Minkowski metric的超参数，即当我们用闵可夫斯基距离作为度量时，p值的大小。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>dist</mtext><mo>(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>=</mo><mo>(</mo><munderover><mo>∑</mo><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>r</mi></msub><mo>−</mo><msubsup><mi>x</mi><mi>r</mi><mo mathvariant="normal">′</mo></msubsup><msup><mi mathvariant="normal">∣</mi><mi>p</mi></msup><msup><mo>)</mo><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow><annotation encoding="application/x-tex">\text{dist}(x,x&#x27;)=(\sum_{r=1}^d|x_r-x&#x27;_r|^p)^{\frac1p}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dist</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1032260000000003em;vertical-align:-1.267113em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2867899999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0367899999999999em;"><span style="top:-3.44577em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.48288571428571425em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>⑥metric：计算距离的方式，默认为闵可夫斯基距离。</p>
<p>我们不妨先用简单的欧几里得距离构建模型，观察模型的预测效果：</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要库'''
import numpy as np
import pandas as pd
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.neighbors import KNeighborsClassifier

'''模型初始化'''
params={
    'n_neighbors':5,
    'weights':'uniform',
    'algorithm':'auto',
    'leaf_size':30,
    'p':2,
    'metric':'minkowski',
    'metric_params':None,
    'n_jobs':1
}
knn=KNeighborsClassifier(**params)
'''数据集划分'''
iris=datasets.load_iris()
X=iris.data
y=iris.target
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)#选取20%的数据作为测试集
'''模型训练'''
knn.fit(X_train,y_train)
y_pred=knn.predict(X_test)
print(accuracy_score(y_test,y_pred))
</code></pre>
<p>在这里准确率的计算方法比较简单，即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>c</mi><mi>c</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>y</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">预</mi><mi mathvariant="normal">测</mi><mi mathvariant="normal">准</mi><mi mathvariant="normal">确</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">点</mi></mrow><mrow><mi mathvariant="normal">总</mi><mi mathvariant="normal">测</mi><mi mathvariant="normal">试</mi><mi mathvariant="normal">点</mi><mi mathvariant="normal">数</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Accuracy=\frac{预测准确的数据点}{总测试点数}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.739em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.394em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">总</span><span class="mord cjk_fallback mtight">测</span><span class="mord cjk_fallback mtight">试</span><span class="mord cjk_fallback mtight">点</span><span class="mord cjk_fallback mtight">数</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">预</span><span class="mord cjk_fallback mtight">测</span><span class="mord cjk_fallback mtight">准</span><span class="mord cjk_fallback mtight">确</span><span class="mord cjk_fallback mtight">的</span><span class="mord cjk_fallback mtight">数</span><span class="mord cjk_fallback mtight">据</span><span class="mord cjk_fallback mtight">点</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>上述模型中，我们最终在测试集上得到的准确率为0.9666666666666667，可以看出模型的效果已经非常好了。</p>
<h3 id="53-可视化">5.3 可视化</h3>
<p>接下来让我们进行一些调参过程，观察能否让准确率再高一些，首先调整<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>值，对于每个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>值我们进行十折交叉验证：</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要库'''
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.model_selection import KFold
from sklearn.neighbors import KNeighborsClassifier

'''模型初始化'''
params={
    'n_neighbors':5,
    'weights':'uniform',
    'algorithm':'auto',
    'leaf_size':30,
    'p':2,
    'metric':'minkowski',
    'metric_params':None,
    'n_jobs':1
}
'''数据读取'''
X=pd.read_csv(&quot;data/iris_data.csv&quot;)
y=X['label']
X.drop('label',axis=1,inplace=True)
'''创建K折交叉验证对象'''
kf = KFold(n_splits=10, shuffle=True)
'''进行交叉验证'''
K_value=[]  #存储不同的K取值
Accuracy=[] #存储各个K值对应的10折交叉验证准确率
for k in range(1,31):#遍历[1,30]的K值
    params['n_neighbors']=k
    K_value.append(k)
    acc=[]
    '''对于某个K值，初始化模型'''
    knn=KNeighborsClassifier(**params)
    '''开始交叉验证'''
    for train_index, test_index in kf.split(X):
        print(&quot;TRAIN:&quot;, train_index, &quot;TEST:&quot;, test_index)
        X_train, X_test = X.iloc[train_index], X.iloc[test_index]
        y_train, y_test = y.iloc[train_index], y.iloc[test_index]
        '''模型训练'''
        knn.fit(X_train,y_train)
        y_pred=knn.predict(X_test)
        acc.append(accuracy_score(y_test,y_pred))
    Accuracy.append(np.array(acc).mean())
'''可视化'''
ax=plt.figure(figsize=(10,4),dpi=100).add_subplot()#初始化画板
ax.plot(K_value,Accuracy,&quot;-.&quot;,label=&quot;score&quot;)#绘制曲线
ax.set_xlabel(&quot;K_value&quot;)#设置标签
ax.set_ylabel(&quot;Score&quot;)
plt.title(&quot;K值对准确率的影响&quot;)
'''设置中文显示'''
plt.rcParams[&quot;font.sans-serif&quot;] = [&quot;KaiTi&quot;]
plt.rcParams[&quot;axes.unicode_minus&quot;] = False
'''显示折线图'''
plt.legend()
plt.show()
</code></pre>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/20220729112719.png" style="zoom:50%;" />
<p>如上图所示，是在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mn>30</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[1,30]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mclose">]</span></span></span></span>上取不同值时十折交叉验证的准确率，因为是随机对数据集进行划分，所以每次所得的曲线图是不同的，不过其大致趋势是相同的，我们最终可以得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>取到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>12</mn><mo separator="true">,</mo><mn>18</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[12,18]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mclose">]</span></span></span></span>能得到最高准确率的概率最高。</p>
<p>而其他参数的调参过程完全可以效仿上述K值调参可视化的过程，只需要修改需要遍历的取值范围以及参数名即可，即这部分代码：</p>
<pre><code class="language-python">for k in range(1,31):#遍历[1,30]的K值
    params['n_neighbors']=k
</code></pre>
<h3 id="54-特征重要性">5.4 特征重要性</h3>
<p>因为在鸢尾花数据集中仅有4个特征，所以我们在此讨论特征重要性其实是没必要的，但是对于具有很多特征的数据集我们则需要依据特征的重要性对特征进行筛选，一方面可以提高预测的准确性，另一方面可以提高模型的效率，我们不妨先观察鸢尾花数据集的4个特征对分类准确性的影响。</p>
<p>我们可以通过各个特征对所对应的标签分布直观得判断特征的重要性，可视化代码如下：</p>
<pre><code class="language-python">'''屏蔽warning'''
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
'''导入重要库'''
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.neighbors import KNeighborsClassifier

'''读取数据'''
df=pd.read_csv(&quot;data/iris_data.csv&quot;)
'''选择特征对'''
fea=(&quot;petal_length&quot;,&quot;petal_width&quot;)
'''初始化存储三种鸢尾花类型坐标的列表'''
setosa_x,setosa_y=[],[]
versicolor_x,versicolor_y=[],[]
virginica_x,virginica_y=[],[]
'''遍历数据'''
for i in df.index:
    if(df['label'][i]==0):#setosa
        setosa_x.append(df[fea[0]][i])
        setosa_y.append(df[fea[1]][i])
    if(df['label'][i]==1):#versicolor
        versicolor_x.append(df[fea[0]][i])
        versicolor_y.append(df[fea[1]][i])
    if(df['label'][i]==2):#virginica
        virginica_x.append(df[fea[0]][i])
        virginica_y.append(df[fea[1]][i])
'''可视化分布'''
ax=plt.figure(figsize=(10,4),dpi=100).add_subplot()#初始化画板
ax.scatter(setosa_x,setosa_y,c=&quot;blue&quot;,label=&quot;setosa&quot;)
ax.scatter(versicolor_x,versicolor_y,c=&quot;red&quot;,label=&quot;versicolor&quot;)
ax.scatter(virginica_x,virginica_y,c=&quot;green&quot;,label=&quot;virginica&quot;)
ax.set_xlabel(fea[0])#设置标签
ax.set_ylabel(fea[1])
plt.legend()
plt.show()
</code></pre>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/20220729121502.png" style="zoom:50%;" />
<p>我们任取两个特征，观察特征对所对应的数据分布即可判断特征的重要性，如上图所示，是我们选择petal_length,petal_width两个特征可视化的结果，可以发现三种标签的分布并没有过多的交织，说明这两个特征对于分类是较为重要的。</p>
<p>4个特征所对应的6个特征对的标签分布如下图所示，由此我们可以大致判断特征的重要性：</p>
<img src="https://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/20220729121841.png" style="zoom:50%;" />
<h2 id="六-总结">六、总结</h2>
<p>1）如果距离可以可靠得反映相异性，则KNN是一个简单高效的模型。</p>
<p>2）在数据集大小<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">n\rightarrow\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mi>N</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">KNN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>模型将变得非常精确，但是也会变得非常缓慢。</p>
<p>3）当数据维度<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>&gt;</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">d&gt;&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>时，会发生维度灾难</p>
<p>4）优点：①没有关于数据的假设，例如：对非线性数据非常有用<br>
②算法简单，易于理解<br>
③具有较高的精度，但是与更好的监督学习模型相比没有竞争力<br>
④用途广泛，适用于分类以及回归问题</p>
<p>5）缺点：①具有较高的计算成本，因为算法要用到所有的训练数据<br>
②具有较高的内存要求，需要存储几乎所有的训练数据<br>
③对无关特征和数据规模较为敏感，存在维度灾难</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[机器学习实战（二）：监督学习]]></title>
        <id>https://2006wzt.github.io/post/机器学习实战（二）：监督学习/</id>
        <link href="https://2006wzt.github.io/post/机器学习实战（二）：监督学习/">
        </link>
        <updated>2022-07-20T16:47:06.000Z</updated>
        <content type="html"><![CDATA[<h1 id="监督学习">监督学习</h1>
<h2 id="一-形式化定义">一、形式化定义</h2>
<p>在监督学习的过程中，我们输入的训练数据是成对输入的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">x\in R_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是输入实例，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>是其标签，整个训练数据表示为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>=</mo><mo>{</mo><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo>(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>)</mo><mo>}</mo><mo>⊆</mo><msub><mi>R</mi><mi>d</mi></msub><mo>×</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">D = \{(x_1, y_1), . . . ,(x_n, y_n)\} ⊆ R_d × C
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">R_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>维特征空间，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>是标签空间，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>个样本的特征向量，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是第i个样本的标签<br>
数据点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_i,y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>来自一些未知的分布<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span></p>
<p>最终我们希望学习出一个模型函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>，对于一个新的数据点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>，我们有较高概率的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> </mtext><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>y</mi><mtext> </mtext><mi mathvariant="normal">或</mi><mtext> </mtext><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>≈</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">~h(x)=y~或~h(x)\approx y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace nobreak"> </span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">或</span><span class="mspace nobreak"> </span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span></p>
<p>监督学习的标签空间决定了问题的类型，典型的标签空间如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Type</th>
<th style="text-align:center">Lable Space</th>
<th style="text-align:left">E.g.</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">二分类</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><mo>{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>}</mo><mtext> </mtext><mi>o</mi><mi>r</mi><mtext> </mtext><mi>C</mi><mo>=</mo><mo>{</mo><mi mathvariant="normal">−</mi><mn>1</mn><mo separator="true">,</mo><mo>+</mo><mn>1</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">C = \{0, 1\}~or~C = \{−1, +1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span><span class="mspace nobreak"> </span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span></span></span></span></td>
<td style="text-align:left">E.g. 垃圾邮件过滤问题. 一个邮件要么是垃圾邮件(-1)要么不是(+1)</td>
</tr>
<tr>
<td style="text-align:center">多分类</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">⋅</mo><mo separator="true">,</mo><mi>K</mi><mo>}</mo><mo>(</mo><mi>K</mi><mo>≥</mo><mn>2</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">C = \{1, 2, · · · , K\} (K ≥ 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mclose">}</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></td>
<td style="text-align:left">E.g. 人脸识别问题.一个人的身份可以是K个身份中的一个</td>
</tr>
<tr>
<td style="text-align:center">回归</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">C = R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></td>
<td style="text-align:left">E.g.预测某一天的温度或者某个人的身高</td>
</tr>
</tbody>
</table>
<h2 id="二-损失函数">二、损失函数</h2>
<h3 id="21-定义">2.1 定义</h3>
<p>什么是损失函数？顾名思义，它是一个用于评估模型对于数据集拟合的损失程度的函数，我们希望预测的效果越差，损失函数的值越大，这也为我们在搭建模型算法的过程中提供了方向：我们要尽可能得使得模型的损失函数输出最小化，以达到较好的拟合效果。<br>
同时在优化过程中，损失函数输出的值变化也可以说明我们的在模型优化上的进展。</p>
<p>事实上，我们可以设计一个非常基本的损失函数来进一步解释它是如何工作的。对于我们所做的每个预测，我们的损失函数将简单地测量预测值和实际值之间的绝对差，即：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>h</mi><mo>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">∣</mi><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">L(h)=\frac1n\sum_{i=1}^n|h(x_i)-y_i|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">n</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>是损失函数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>是我们训练出的模型函数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>是验证集的样本数量，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">h(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>是特征向量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的预测标签，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>则是实际的标签，显然当我们预测完全准确时<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>h</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L(h)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，预测值与实际值差别越大，损失函数的值越大，这满足损失函数的特性。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429205624930.png" alt="image-20220429205624930" style="zoom:60%;"/>
<h3 id="22-经典的损失函数">2.2 经典的损失函数</h3>
<h4 id="221-zero-one-loss">2.2.1 Zero-one loss</h4>
<p>0-1损失函数的形式化定义如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>0</mn></mrow></msub><mo>(</mo><mi>h</mi><mo>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>δ</mi><mrow><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mpadded width="0px"><mo></mo></mpadded><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mspace linebreak="newline"></mspace><mi mathvariant="normal">对</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">分</mi><mi mathvariant="normal">类</mi><mi mathvariant="normal">问</mi><mi mathvariant="normal">题</mi><mi mathvariant="normal">：</mi><msub><mi>δ</mi><mrow><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mpadded width="0px"><mo></mo></mpadded><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mi>f</mi><mtext> </mtext><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mpadded width="0px"><mo></mo></mpadded><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>0</mn><mo separator="true">,</mo><mi>o</mi><mi mathvariant="normal">.</mi><mi>w</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow><mspace linebreak="newline"></mspace><mi mathvariant="normal">对</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">回</mi><mi mathvariant="normal">归</mi><mi mathvariant="normal">问</mi><mi mathvariant="normal">题</mi><mi mathvariant="normal">：</mi><msub><mi>δ</mi><mrow><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mpadded width="0px"><mo></mo></mpadded><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mi>f</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mo>&gt;</mo><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>0</mn><mo separator="true">,</mo><mi>o</mi><mi mathvariant="normal">.</mi><mi>w</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">L_{1/0}(h)=\frac1n\sum_{i=1}^n\delta_{h(x_i)\not=y_i}\\
对于分类问题：\delta_{h(x_i)\not=y_i}=
\left\{
\begin{aligned}
&amp;1,if~h(x_i)\not=y_i\\
&amp;0,o.w.\\
\end{aligned}
\right.\\
对于回归问题：\delta_{h(x_i)\not=y_i}=
\left\{
\begin{aligned}
&amp;1,if~|h(x_i)-y_i|&gt;t\\
&amp;0,o.w.\\
\end{aligned}
\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">n</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">类</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">题</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.00003em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace nobreak"> </span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">回</span><span class="mord cjk_fallback">归</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">题</span><span class="mord cjk_fallback">：</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.00003em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace nobreak"> </span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">t</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>根据<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span></span></span></span>函数的定义，当我们的预测值准确时，会给损失函数加上0，对于不准确的预测值则会给损失函数加上1<br>
0-1损失函数也有明显的缺点，对于分类问题影响并不大，但是对于回归问题，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>是某个自定义的阈值，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span></span></span></span>函数对于所有的误差大于阈值的惩罚相同，即错误的预测所带来的惩罚都为1，对于一些很离谱的预测（比如1预测成了10000）并没有额外的惩罚。</p>
<h4 id="222-squared-loss">2.2.2 Squared loss</h4>
<p>平方损失函数的形式化定义如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>s</mi><mi>q</mi></mrow></msub><mo>(</mo><mi>h</mi><mo>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L_{sq}(h)=\frac1n\sum_{i=1}^n(h(x_i)-y_i)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">n</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>平方损失函数常用于分类问题，它有两个主要特点：<br>
①损失函数的值永远是非负的<br>
②损失函数的值与预测的绝对误差呈二次关系</p>
<p>显然平方损失函数规避了0-1损失函数的缺点，对于预测误差较大的样本，所带来的惩罚也越大，但同时对于预测较准确的点，所带来的惩罚也会变得更小，对于噪声数据的处理会使得模型的效果变差。</p>
<h4 id="223-absolute-loss">2.2.3 Absolute loss</h4>
<p>绝对损失函数的形式化定义如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>a</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>(</mo><mi>h</mi><mo>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">∣</mi><mi>h</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">L_{abs}(h)=\frac1n\sum_{i=1}^n|h(x_i)-y_i|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">n</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<p>绝对损失函数的值随着预测失误而线性增长，因此更适合于噪声数据</p>
<h2 id="三-泛化能力">三、泛化能力</h2>
<p>学习方法的泛化能力，是指由该学习方法学习到的模型对未知数据的预测能力，是学习方法本质上重要的性质。</p>
<p>对于给定的一个损失函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>，我们可以得到一个使得损失函数最小化的模型<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>，即：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><mi>n</mi></mo><mrow><mi>h</mi><mo>∈</mo><mi>H</mi></mrow></munder><mtext> </mtext><mi>L</mi><mo>(</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">h=\underset{h\in H}{argmin}~L(h)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7239179999999998em;vertical-align:-0.973918em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.65952em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.973918em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span></span></p>
<p>机器学习的很大一部分集中在这个问题上，即如何有效地进行最小化。如果我们得到一个模型函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mo separator="true">⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">h(·)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span></span></span></span>，它在我们的训练数据<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>上的损失很小，我们该如何确定它在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>之外的数据上的损失也很小呢？这就是泛化的问题，一个泛化能力较差的模型如下：</p>
<p>Bad example：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>∈</mo><mi>D</mi><mo>∩</mo><mi>x</mi><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>0</mn><mtext> </mtext><mo separator="true">,</mo><mi>o</mi><mi mathvariant="normal">.</mi><mi>w</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">h(x)=\left\{
\begin{aligned}
&amp;y_i,(x_i,y_i)\in D \cap x=x_i\\
&amp;0~,o.w.
\end{aligned}
\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.00003em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">0</span><span class="mspace nobreak"> </span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">o</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>对于这个模型函数，我们在训练的数据集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>上的误差为0，但是对于数据集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>外的数据点，显然将会有很大的误差，这就是过拟合问题。</p>
<h2 id="四-过拟合">四、过拟合</h2>
<p>什么是过拟合？</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429214453836.png" alt="image-20220429214453836" style="zoom:60%;"/>
<p>在模型的监督学习过程中，我们往往是在训练集上设计模型，在测试集上评估模型的准确性，如上图所示，图1是欠拟合的情况，即模型在训练集上也没有很好的准确性，因此在测试集上的准确性也不会高；图2是较为合适的拟合，它规避了噪声的影响，较为准确得对两类点进行了划分；图3则是过拟合的情况，它最大化了模型在训练集上的准确度而忽略了噪声点的影响，使得模型在训练集上表现得很好，但是在测试集上却表现不佳。</p>
<p>在西瓜书中也有一个比较形象的例子：</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429214520865.png" alt="image-20220429214520865" style="zoom: 60%;"/>
<h2 id="五-训练与测试">五、训练与测试</h2>
<h3 id="51-定义">5.1 定义</h3>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429214711346.png" alt="image-20220429214711346" style="zoom:50%;"/>
<p>训练是使得模型可以学习的过程，而测试则是模型进行预测的过程，训练集的标签是已知的，即可观察的，而测试集的正确标签则是未知的，我们的模型要从已知的特征与标签的对应关系中进行学习，然后对未知的测试集进行预测。</p>
<p>**No free lunch rule：**一个模型<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">h_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>即使在某些问题上比另一个模型<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">h_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>好，也必然存在另一些问题使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">h_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>效果比<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">h_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>好</p>
<h3 id="52-数据集的划分">5.2 数据集的划分</h3>
<p>对于所提供的数据集，为了训练模型，我们往往需要对数据集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>进行划分，一般划分成训练集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、验证集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、测试集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>三部分。<br>
一般的划分比例为80%（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>），10%（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>），10%（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>），对于不同的数据集可以进行调整。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429215011461.png" alt="image-20220429215011461" style="zoom:60%;"/>
<p>为什么我们需要验证集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>？<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>用于检查从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>中获得的模型函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mo>⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">h(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span>是否存在过拟合的问题，也就是我们所追求的目标不只是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>在训练集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>上的损失最小化，也要兼顾在验证集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>上的损失最小化，如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mo>⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">h(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span>在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>上的损失很大，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mo separator="true">⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">h(·)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span></span></span></span>将根据<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>进行修订，并在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>上再次验证。该过程将不断来回，直到在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>上产生低损失，在验证集上的误差是接近泛化误差的。</p>
<p>在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的大小之间有一个权衡：对于较大的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{TR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，训练结果会更好，但如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>V</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{VA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>较大，验证会更可靠（噪音更少）。</p>
<p>对于监督学习实际的应用问题，我们一般只需要在提供的已知标签的数据集上进行训练集与验证集的划分，根据所提供的数据集的特点，有如下的划分规则：<br>
①含有时间成分的数据集：一定要遵循过去预测未来的规则，不能利用未来的数据去预测过去的数据。<br>
②不含有时间成分的数据集：可以均匀随机得进行划分</p>
<p>利用验证集进行模型评估的常用方法为k折交叉验证，其原理如下图所示：</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220504164717077.png" alt="image-20220504164717077" style="zoom:60%;"/>
<h2 id="六-总结">六、总结</h2>
<p>1）学习的过程：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>:</mo><mi>h</mi><mo>(</mo><mo>⋅</mo><mo>)</mo><mo>=</mo><munder><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><mi>n</mi></mo><mrow><mi>h</mi><mo>∈</mo><mi mathvariant="script">H</mi></mrow></munder><mtext> </mtext><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>∈</mo><msub><mi>D</mi><mrow><mi>T</mi><mi>R</mi></mrow></msub></mrow></munder><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>h</mi><mo>(</mo><mo>⋅</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Learning:h(\cdot)=\underset{h\in \mathcal{H}}{argmin}~\frac1{|D_{TR}|}\sum_{(x,y)\in D_{TR}}L(x,y|h(\cdot))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.8374449999999998em;vertical-align:-1.516005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.65952em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.973918em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>2）评估的过程：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>:</mo><msub><mi>ϵ</mi><mrow><mi>T</mi><mi>E</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">∣</mi><msub><mi>D</mi><mrow><mi>T</mi><mi>E</mi></mrow></msub><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>∈</mo><msub><mi>D</mi><mrow><mi>T</mi><mi>E</mi></mrow></msub></mrow></munder><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>h</mi><mo>(</mo><mo>⋅</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Evaluation:\epsilon_{TE}=\frac{1}{|D_{TE}|}\sum_{(x,y)\in D_{TE}}L(x,y|h(\cdot))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">u</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.8374449999999998em;vertical-align:-1.516005em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>根据监督学习的上述基本原理，我们将在后续文章中开始相关算法的实战！</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[机器学习实战（一）：机器学习导论]]></title>
        <id>https://2006wzt.github.io/post/机器学习实战（一）：机器学习导论/</id>
        <link href="https://2006wzt.github.io/post/机器学习实战（一）：机器学习导论/">
        </link>
        <updated>2022-07-19T16:18:15.000Z</updated>
        <content type="html"><![CDATA[<h1 id="机器学习导论">机器学习导论</h1>
<h2 id="一-什么是机器学习">一、什么是机器学习</h2>
<p>机器学习是人工智能的一个分支，涉及算法的设计和开发，允许计算机根据经验数据进化行为。由于智能需要知识，计算机必须获取知识。Tom Mtichell于1997年对机器学习的定义：一个计算机程序A，从经验E中学习关于某个任务T的性能度量P，E有助于提高计算机在任务T上的性能表现，这是基于统计和优化的，而不是基于逻辑的。</p>
<h2 id="二-ml-vs-cs">二、ML VS CS</h2>
<p>机器学习的核心是程序，但是最终目标是结果。以垃圾邮件分类为例，我们所要研究的是进行分类的算法，但是我们的最终目标是邮件的类型。而传统的计算机科学则是根据一定的逻辑规则由输入得到正确的输出。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220719223212512.png" alt="image-20220719223212512" style="zoom:70%;"/>
<h2 id="三-基本分类">三、基本分类</h2>
<h3 id="31-监督学习">3.1 监督学习</h3>
<p>在监督学习（supervised learning）的过程中，算法从我们所提供的数据集中进行学习。<br>
监督学习与非监督学习的最大区别在于我们知道用于训练的数据集的正确结果或期望输出，算法对验证集进行预测，由监督者对预测结果进行评估与纠正，进而优化算法，当算法达到可接受的性能水平时，则停止学习。</p>
<p>监督学习有两种主要类型：分类与回归</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220719225615115.png" alt="image-20220719225615115" style="zoom:60%;"/>
<h4 id="311-分类问题">3.1.1 分类问题</h4>
<p>顾名思义，就是根据特征对事物进行分类，一些经典的分类问题例子：<br>
①垃圾邮件过滤问题：根据邮件内容对邮件是否为垃圾邮件进行分类，这是一个二分类问题。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429112418400.png" alt="image-20220429112418400" style="zoom:40%;"/>
<p>②人脸识别问题：显然这就是一个多分类问题，根据照片中所包含的数据判断出人脸所对应的身份</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429112443122.png" alt="image-20220429112443122" style="zoom:40%;"/>
<h4 id="312-回归问题">3.1.2 回归问题</h4>
<p>回归用于预测输入和输出变量之间的关系，特别是当输入变量的值发生变化时，输出变量的值也随之发生变化，经典的回归问题如下：<br>
①房价预测：根据所提供的相关特征对某个楼盘的房价进行预测<br>
②天气预测：根据相关指标对未来的天气，例如PM2.5值进行预测</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429112504552.png" alt="image-20220429112504552" style="zoom:40%;"/>
<h3 id="32-非监督学习">3.2 非监督学习</h3>
<p>无监督学习（unsupervised learning）是一类用于在数据中寻找模式的机器学习技术。无监督学习算法使用的输入数据都是没有标注过的，这意味着数据只给出了输入变量（自变量 X）而没有给出相应的输出变量（因变量y）。<br>
在无监督学习中，算法本身将发掘数据中有趣的结构。人工智能研究的领军人物 Yann LeCun，解释道：无监督学习能够自己进行学习，而不需要被显式地告知他们所做的一切是否正确。</p>
<p>非监督学习最为经典的例子便是聚类问题。</p>
<h4 id="321-聚类问题">3.2.1 聚类问题</h4>
<p>顾名思义，聚类就是根据所提供的相关数据，对具有相似特征的事物进行分类，比如照片的类型、网页主题的聚类。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429113111281.png" alt="image-20220429113111281" style="zoom:40%;"/>
<p>在后期的学习中我们主要关注监督学习的相关算法。</p>
<h3 id="33-强化学习">3.3 强化学习</h3>
<p>强化学习（reinforcement learning）是指智能系统在与环境的连续互动中学习最优化行为策略的机器学习问题，强化学习的本质是学习最优的序贯决策。<br>
智能系统与环境的互动如下图所示，在每一步t，智能系统从环境中观测到一个状态（state）<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>与一个奖励<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，采取一个动作（action）<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">a_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。环境根据只能系统选择的动作，决定下一步t+1的状态<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>与奖励<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">r_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>。要学习的策略表示为给定的状态下采取的动作。<br>
智能系统的目标不是短期奖励的最大化，而是长期累积奖励的最大化，强化学习的过程中系统不断试错，以达到学习最优策略的目的。</p>
<img src="https://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220719235756674.png" alt="image-20220719235756674" style="zoom:67%;"/>
<h3 id="34-半监督学习">3.4 半监督学习</h3>
<p>半监督学习（semi-supervised learning）是指利用标注数据和未标注数据学习预测模型的机器学习问题。通常有少量标注数据、大量未标注数据，因为标注数据的构成往往需要人工，成本较高，未标注的数据的收集则不需要太多成本，半监督学习旨在利用未标注数据中的信息，辅助标注数据，进行监督学习，以较低的成本达到较好的学习效果。</p>
<h2 id="四-经典的机器学习过程">四、经典的机器学习过程</h2>
<p>如下图所示，这是一个属于监督学习的二分类问题的机器学习过程，通过所提供的训练数据使用学习算法训练出模型，再将我们所要预测的不带标签（label）的新数据样本输入到模型中去，进而预测出该样本所属的类别。</p>
<img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220429113559867.png" alt="image-20220429113559867" style="zoom:45%;"/>
<p>在后续的博客中，我将会介绍机器学习中的重要概念与相关算法，还请大家多多支持与关注😄！</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Python入门与实战]]></title>
        <id>https://2006wzt.github.io/post/Python入门与实战/</id>
        <link href="https://2006wzt.github.io/post/Python入门与实战/">
        </link>
        <updated>2022-07-18T13:27:22.000Z</updated>
        <content type="html"><![CDATA[<h2 id="python">Python</h2>
<h3 id="一python初探">一.Python初探</h3>
<h4 id="1python语言的基本要素">1.Python语言的基本要素</h4>
<h5 id="1符号和注释">（1）符号和注释</h5>
<p>①符号：需要用英文字符,程序前面不能随便加空格</p>
<p>②注释：单行注释用#开头，选中部分Ctrl+/可以代码和注释间相互转化</p>
<h5 id="2变量">（2）变量</h5>
<p>变量有名字，其值可以存储数据</p>
<pre><code class="language-python">a=12
b=a#让b的值变得跟a一样
print(a+b)#输出24
a=&quot;hello&quot;
print(a)#输出hello
</code></pre>
<h5 id="3赋值语句">（3）赋值语句</h5>
<p>变量=表达式，使变量的值变得跟表达式一样</p>
<pre><code class="language-python">a,b=&quot;he&quot;,12
print(a,b)#输出he 12
a,b=b,a
print(a,b)#输出12 he
a=b=c=10
print(a,b,c)#输出10 10 10
</code></pre>
<h4 id="2初步认识字符串">2.初步认识字符串</h4>
<h5 id="1字符串初步">（1）字符串初步</h5>
<p>字符串可以且必须用单引号，双引号和三引号括起来；当字符串太长时，可以用\进行分行输出</p>
<p>三双引号字符串中可以包含换行符，制表符等其他字符，双引号中也可以有\n</p>
<pre><code class="language-python">print(&quot;I said:'hello'&quot;)#I said:'hello'
print('I said:&quot;hello&quot;')#I said:&quot;hello&quot;
print('''I said:'he said&quot;hello&quot;'.''')#I said:'he said&quot;hello&quot;'.
print(&quot;this\
 is good!&quot;)#this is good!
print(&quot;&quot;&quot;Tab\tEnter&quot;&quot;&quot;)#Tab Enter
</code></pre>
<p>有n个字符的字符串，编号从左向右为0-&gt;n-1，从右往左编号为-1-&gt;-n</p>
<pre><code class="language-python">a=&quot;string&quot;
print(a[-1])#g
print(a[0])#s
</code></pre>
<p>字符串可以用+号连接</p>
<pre><code class="language-python">a=&quot;ABCD&quot;
b=&quot;1234&quot;
c=a+b
d=c+a[1]
print(c)#ABCD1234
print(d)#ABCD1234B
</code></pre>
<p>注意字符串不可以修改，在初始化后不可以修改该字符串中任何一个字符</p>
<p>可以用in和not in判断子串</p>
<pre><code class="language-python">a=&quot;hello&quot;
b=&quot;python&quot;
print(&quot;el&quot; in a)#True
print(&quot;py&quot; not in b)#False
</code></pre>
<h5 id="2字符串和数的转换">（2）字符串和数的转换</h5>
<pre><code class="language-python">x=&quot;1234&quot;
y=&quot;12.34&quot;
z=1234
a=1.2
b=2.6
print(int(x))#1234,int(x)返回值为x对应的整数，但是不会改变x，要求x一定为整数才能调用int(x)
print(int(a),int(b))#1 2,int(a)还可以作用于数字，用于取整
print(float(y))#12.34,float(y)返回值为y对应的小数，不会改变y，y可以为小数或整数
print(str(z))#1234,str(z)返回值为数字z对应的字符串
print(eval(&quot;x+y&quot;))#123412.34把字符串看成一个python表达式并求其值
</code></pre>
<h4 id="3简单的输入输出">3.简单的输入输出</h4>
<h5 id="1输入输出初步">（1）输入输出初步</h5>
<p>输出语句print()，可以输出一项或多项，输出多项时用，隔开，输出效果为用空格隔开，输出后自动换行</p>
<p>有时不想换行可以在print的括号最后加上end=&quot;&quot;,缺省的情况下为end=&quot;\n&quot;</p>
<pre><code class="language-python">a=&quot;hello&quot;
b=&quot;world&quot;
print(a,b,end=&quot;&quot;)
print(&quot; ok&quot;)#hello world ok
</code></pre>
<p>输入语句x=input(y)，先输出y再等待输入，最后将输入的内容以字符串的形式赋值给x。</p>
<p>要求y一定要是字符串，且赋值输入字符串给x时不带最后的回车</p>
<pre><code class="language-python">y=&quot;input your information\n&quot;
x=input(y)#先显示input your information，后输入1234
print(x)#1234
#输入两个整数并求其和
a=int(input())#输入1
b=int(input())#输入2
print(a+b)#输出3
</code></pre>
<h4 id="4初步认识列表">4.初步认识列表</h4>
<h5 id="1列表初步">（1）列表初步</h5>
<p>列表可以有0到多个元素，并且可以通过下标访问，下标的概念与字符串相同，列表中的元素类型可以不同</p>
<pre><code class="language-python">lst=[1,2,&quot;hello&quot;,3,'world']
lst[1]=5
print(&quot;lst[4]:&quot;,lst[4])#lst[4]: world
a=1
print(lst[a])#5
print(len(lst))#5,len(lst)为列表lst的长度
</code></pre>
<p>可以用in判断列表中是否有某个元素</p>
<pre><code class="language-python">lst=[1,2,&quot;hello&quot;,3,'world']
print(&quot;world&quot; in lst,5 in lst)#True False
</code></pre>
<p>输入两个整数并求和</p>
<pre><code class="language-python">s=input()
numbers=s.split()#对于字符串s以空格，制表符，换行符为分隔符，将s分为若干子串作为列表的每个元素，返回一个列表
print(int(numbers[0])+int(numbers[1]))#输入3 4，输出7
</code></pre>
<pre><code class="language-python">print(&quot;1234\t 56\n78&quot;.split())#输出['1234','56','78']
</code></pre>
<h3 id="二基本运算-条件分支和输出格式控制">二.基本运算、条件分支和输出格式控制</h3>
<h4 id="1算术运算-逻辑运算和分支语句">1.算术运算、逻辑运算和分支语句</h4>
<h5 id="1算术运算">（1）算术运算</h5>
<p>+，-，*，/结果为小数，%取模，//求商结果为整数，**求幂</p>
<pre><code class="language-python">print(10%8)#2
print(15//4)#3
print(2**3)#8
print(3+-5)#-2
</code></pre>
<h5 id="2关系运算符逻辑运算符逻辑表达式">（2）关系运算符，逻辑运算符，逻辑表达式</h5>
<p>①关系运算符：==,&lt;,&lt;=,&gt;,&gt;=,!=，比较结果为bool值，True或者False，字符串按照字典排序进行比较</p>
<p>②逻辑运算符：and（与），or（或），not（非），False等于0，True等于1，优先级not&gt;and&gt;or</p>
<p>0，&quot;&quot;(空字符串)，[]（空表）都相当于False；非0数，非空字符串，非空列表都相当于True</p>
<p>③逻辑表达式：逻辑表达式是短路计算的，当表达式的值可以确定时则会停止计算</p>
<h5 id="3条件分支语句">（3）条件分支语句</h5>
<pre><code class="language-python">if int(input())==5:#注意一定要有&quot;:&quot;
    print(&quot;a&quot;,end=&quot;&quot;)#if语句下缩进相同的语句属于同一个语句组
    print(&quot;b&quot;)#若输入5，则输出ab，否则无输出，转入下一个条件语句
elif not (4&lt;7):#elif即为else if，一旦前一个语句组得以执行，则不再执行剩下分支
    print(&quot;cd&quot;)#中间分支用elif
else:#最后一个分支用else时不需要判断语句，用elif时需要有判断语句
    print(&quot;OK&quot;)
</code></pre>
<pre><code class="language-python">#if语句实例：温度转换程序
tmpStr=input(&quot;请输入带有符号的温度值：&quot;)
if tmpStr[-1] in ['F','f']:#如果输入华氏温度
    c=((float(tmpStr[0:-1])-32)/1.8)
    print(&quot;转换后的温度是&quot;+str(c)+&quot;C&quot;)
elif tmpStr[-1] in ['C','c']:#如果输入摄氏温度
    f=float(tmpStr[0:-1])*1.8+32
    print(&quot;转换后的温度是&quot;+str(f)+&quot;F&quot;)
else:
    print(&quot;输入格式错误&quot;)#注意不要把if...elif...else写成多个if
</code></pre>
<p>字符串切片：若s为一个字符串，则s[x:y]为从下标x到下标y-1的子串</p>
<h4 id="2输出格式控制">2.输出格式控制</h4>
<p>输出格式控制符与C语言的大致相同，且输出格式控制符仅能作用在字符串的输出中</p>
<pre><code class="language-python">h=1.746
print(&quot;My name is %s,I am %.2fm tall.&quot; %(&quot;tom&quot;,h))#My name is tom,I am 1.75m tall.
#%s用对应的字符串替代，%.nf输出保留n位小数的小数，且遵从四舍六入，五可能舍可能入
#注意&quot;My name is %s,I am %.2fm tall.&quot; %(&quot;tom&quot;,h)是一个完整的字符串
#也可以写成&quot;My name is %s,&quot;%&quot;tom&quot;+&quot;I am %.2fm tall.&quot; %h
print(&quot;%d%s&quot;%(18,&quot;hello&quot;))#18hello,注意双引号外的百分号%
</code></pre>
<h3 id="三循环语句">三.循环语句</h3>
<h4 id="1for循环语句">1.for循环语句</h4>
<p>for<variable>in<sequence>:</p>
<p>​    <statements1>令variable的值依次是sequence里面的每一个元素，并对每个variable值进行操作statements1</p>
<pre><code class="language-python">for i in range(5):#range可以看成一个区间range(n)为区间[0,n),range(x,y)为区间[x,y)，range(0)range(x,x)为空
    print(i,end=&quot; &quot;)#输出0 1 2 3 4,注意for语句后的冒号:
for i in range(0,10,3):#range(x,y,z)从x开始以步长z输出[x,y)中的元素
    print(i,end=&quot; &quot;)#输出0 3 6 9
a=['a','b','c']
for i in range(len(a)):#len()可以求字符串，列表，字典，集合的元素个数
    print(i,a[i],end=&quot; &quot;)#输出1 a 2 b 3 c
</code></pre>
<h4 id="2break-continue语句">2.break、continue语句</h4>
<p>break语句用于跳出循环，continue语句用于直接进入下一层循环，其用法与C语言类似</p>
<p>下为一些for循环语句的例题:</p>
<pre><code class="language-python">#连续输出26个字母
for i in range(26):
    print(chr(ord(&quot;a&quot;)+i),end=&quot;&quot;)
#ord(x)为字符x(长度为1的字符串)对应的编码，chr(x)为编码x对应的字符
</code></pre>
<pre><code class="language-python">#求n个整数的和
n=int(input())
total=0
for i in range(n):
    total+=int(input())
print(total)
</code></pre>
<pre><code class="language-python">#从小到大或从大到小输出n的因子
n=int(input())
for i in range(1,n+1):#从小到大输出
    if n%i==0:
        print(i,end=&quot; &quot;)
print()
for i in range(n,0,-1):#从大到小输出
    if n%i==0:
        print(i,end=&quot; &quot;)
</code></pre>
<h4 id="3while循环语句">3.while循环语句</h4>
<pre><code class="language-python">count=0
while count&lt;3:
    print(count,&quot;小于3&quot;)
    count+=1
else:
    print(count,&quot;大于等于3&quot;)
#0 小于3
#1 小于3
#2 小于3
#3 大于等于3
</code></pre>
<pre><code class="language-python">#密码输入系统
while(input(&quot;请输入密码:&quot;)!=&quot;python&quot;):
    print(&quot;输入密码错误!&quot;)
print(&quot;输入密码正确!&quot;)
</code></pre>
<pre><code class="language-python">#求三个数的最小公倍数
s=input().split()
x,y,z=int(s[0]),int(s[1]),int(s[2])
n=1
while True:#枚举法
    if n%x==0 and n%y==0 and n%z==0:
        break
    n+=1
print(n)
#优化
s=input().split()
x,y,z=int(s[0]),int(s[1]),int(s[2])
n=m=max(x,y,z)
while True:#枚举法,从m开始试，且每隔m试一次
    if n%x==0 and n%y==0 and n%z==0:
        break
    n+=m
print(n)
</code></pre>
<h4 id="4异常处理">4.异常处理</h4>
<p>常见的异常有：<br>
（1）不合适的转换：int(&quot;abc&quot;),float(&quot;abc&quot;),int(12.34)</p>
<p>（2）输入已经结束后还执行input()</p>
<p>（3）除法的除数为0</p>
<p>（4）整数和字符串相加</p>
<p>（5）列表下标越界</p>
<pre><code class="language-python">try:#用try和except处理异常，如果try的语句组出现异常则执行except的语句组，反之则不执行expect的语句组
    n=int(input())#输入n为&quot;abc&quot;等不符合要求的字符串时会出现异常
    print(&quot;hello&quot;)
    a=100/n#当n为0时会出现异常
    print(a)
except:
    print(&quot;error&quot;)#当try的语句组出现异常时，会输出error
print(&quot;end&quot;)
</code></pre>
<pre><code class="language-python">try:
    while True:
        s=input()#在pycharm中输入中止的标志为Ctrl+D
        print(s)
except:
    pass#pass语句不执行任何操作
print(&quot;end&quot;)
</code></pre>
<h4 id="5循环综合例题">5.循环综合例题</h4>
<pre><code class="language-python">#求斐波那契数列的第k项
k=int(input())
if k==1 or k==2:
    print(1)
else:
    a1=a2=1
    for i in range(k-2):
        a1,a2=a2,a1+a2
    print(a2)
</code></pre>
<pre><code class="language-python">#求阶乘之和1!+2!+...+n!
n=int(input())
s,f=0,1
for i in range(1,n+1):#进行了优化，每计算一个阶乘都保留其结果参与下一个阶乘的计算
    f*=i
    s+=f
print(s)
</code></pre>
<pre><code class="language-python">#求不大于n(n&gt;=2)的质数
n=int(input())
print(2)
for i in range(3,n+1,2):#大于2的偶数都是合数，所以只用检验奇数
    ok=True
    for k in range(3,i,2):
        if i%k==0:
            ok=False
            break
        if k*k&gt;i:#大于根号i后不用检验
            break
    if ok:
        print(i)
</code></pre>
<h3 id="四函数和递归">四.函数和递归</h3>
<h4 id="1函数的概念和用法">1.函数的概念和用法</h4>
<pre><code class="language-python">def Max(x,y):#def用于定义函数
    if(x&gt;y):
        return x#用return返回值，一个函数也可以没有返回值
    else:
        return y#一个函数也可以返回多个值如return x,y
print(Max(4,6))#6
print(Max(&quot;about&quot;,&quot;take&quot;))#take
</code></pre>
<p>函数中的变量：在函数中定义的变量不在函数外起到作用，如果函数内的变量x与全局变量x重名，则如果在函数中未对变量x进行赋值，则认为x为全局变量，反之则为函数内部的变量，在函数内可以用global x声明x为全局变量</p>
<pre><code class="language-python">x=4#全局变量x
def f0():
    print(x)#4,这里的x为全局变量x
def f1():
    x=8
    print(x)#8,这里的x为函数内部的变量x
def f2():
    global x#说明函数体中的x为全局变量x
    print(x)#4
    x=5#改变全局变量x的值
    print(x)#5
#def f3():
#    print(x)#错误，因为后面对x进行了赋值，则x为函数内部的x，但此时还未对x进行赋值
#    x=9
f0()
f1()
f2()
</code></pre>
<p>python还有很多内置函数，除了前面所讲，还有abs(x)求x绝对值，max(x),min(x)求列表x中元素的的最大最小值，max(x1,x2...),min(x1,x2...)等</p>
<h4 id="2递归的概念">2.递归的概念</h4>
<pre><code class="language-python">def Factorial(n):#求n的阶乘
    if n&lt;2:
        return 1#终止条件,一个递归函数必须要有终止条件
    else:
        return n*Factorial(n-1)
</code></pre>
<pre><code class="language-python">#汉诺塔问题
def Hanoi(n,src,mid,dest):#将n个盘子从src柱以mid柱做中转移动到dest柱子上
    if n==1:
        print(src+&quot;-&gt;&quot;+dest)
        return#递归中止
    else:
        Hanoi(n-1,src,dest,mid)#先将n-1个盘子移动到mid柱子上
        Hanoi(1,src,mid,dest)#将最底层最大的盘子从src直接移动到dest上
        Hanoi(n-1,mid,src,dest)#将mid上的n-1个盘子移动到dest上
n=int(input())
Hanoi(n,'A','B','C')
</code></pre>
<pre><code class="language-python">#雪花曲线的递归定义
#长为size，方向为x的0阶雪花曲线为方向x上一根长为size的线段
#长为size，方向为x的n阶雪花曲线由以下四部分组成
#1.长为size/3，方向为x的n-1阶雪花曲线
#2.长为size/3，方向为x+60的n-1阶雪花曲线
#3.长为size/3，方向为x-60的n-1阶雪花曲线
#4.长为size/3，方向为x的n-1阶雪花曲线从
import turtle#画图要用turtle包，python自带
def snow(n,size):#n是阶数，size是长度，从当前起点出发，在当前方向画一个长度为size阶为n的科赫雪花
    if n==0:
        turtle.fd(size)#笔沿当前方向前进size
    else:
        for angel in [0,60,-120,60]:
            turtle.left(angel)#笔左转angel度
            snow(n-1,size/3)
# turtle.setup(800,600)#窗口缺省位于屏幕正中间，宽800，高600，窗口中央坐标(0,0)，笔初始方向为0即为正东方向
# turtle.penup()#抬起笔
# turtle.goto(-300,-50)#将笔移动到(-300,-50)的位置
# turtle.pendown()#放下笔
# turtle.pensize(3)#笔的粗度是3
# snow(3,600)#绘制3阶科赫雪花，长度为600
# turtle.done()#保持绘图窗口
#绘制完整雪花
turtle.setup(800,800)
turtle.speed(1000)#笔的移动速度为1000
turtle.penup()#抬起笔
turtle.goto(-200,100)#将笔移动到(-200,100)的位置
turtle.pendown()#放下笔
turtle.pensize(2)#笔的粗度是2
level=3
snow(level,400)
turtle.right(120)#笔的方向右转120°
snow(level,400)
turtle.right(120)
snow(level,400)
turtle.done()#保持绘图窗口
</code></pre>
<h3 id="五字符串和元组">五.字符串和元组</h3>
<h4 id="1python变量的指针本质">1.Python变量的指针本质</h4>
<p>isinstance函数：</p>
<pre><code class="language-python">#isinstance(x,y)用于查询数据x是否是类型y
a=&quot;1233&quot;
print(isinstance(a,str))#True
print(isinstance(a,int))#False
</code></pre>
<p>python中的变量都是指针，赋值的过程即为指针指向某个内存的过程，列表中的元素也可以进行赋值，因此列表中的每个元素都是指针</p>
<p>is运算符和==运算符的区别：</p>
<p>①a is b 为True代表a，b指向同一个内存</p>
<p>②a==b代表a，b指向内存中的值相等</p>
<pre><code class="language-python">a=[1,2,3,4]
c=a#c指向和a相同的内存
a[2]='ok'#c也会跟着改变
print(c)#[1,2,'ok',4]
#对于list,dict,set类型的变量a，b，我们需要关注a==b与a is b的区别所在
</code></pre>
<h4 id="2字符串详解">2.字符串详解</h4>
<p>转义字符：\与其后面的一个字符一同构成，\n为换行符，\t为制表符等等</p>
<pre><code class="language-python">print(&quot;a\\tb&quot;)#a\tb
print(r&quot;a\\tb&quot;)#a\\tb,前面加r代表字符串中的\不转义
</code></pre>
<p>字符串切片：s[x:y]代表下标x到y-1的子串，字符串切片的方法也适用于元组和列表</p>
<pre><code class="language-python">s=&quot;ABCD&quot;
print(s[1:2])#B
print(s[:3])#ABC,起始下标不写则代表从开头开始
print(s[1:])#BCD,末尾下标不写则代表以末尾结束
print(s[0:3:2])#AC,第三个数代表步长，步长为2
print(s[::-1])#DCBA,可用于字符串反转，步长为负数则从右往左数
</code></pre>
<p>字符串的分割：s.split(x)为以x为分隔符，将字符串s分割成一个列表，列表中的每个元素为字符串的子串</p>
<pre><code class="language-python">#字符串的高级分割
import re#引入re包
a=&quot;A*B\n;C:D&quot;
print(re.split('\*|\n|;|:',a))#不同的分隔符用|隔开，re.split()将括号中各符号都当作分隔符，相邻分隔符之间会得出一个空串
#输出['A','B','','C','D']
</code></pre>
<p>字符串的函数：</p>
<pre><code class="language-python">s=&quot;AABBAA&quot;
print(s.count('AA'))#2,count用于计算字符串中子串的个数
print(s.lower())#aabbaa,lower用于使字符串中大写转成小写，但是不改变原来字符串，而是返回一个新的字符串
print(s.lower().upper())#AABBAA,upper则为小写转大写
print(s.find(&quot;AB&quot;))#1,find返回找到第一个子串的起始下标，找不到则返回-1
print(s.rfind(&quot;AB&quot;))#1,rfind则为从后往前查找
try:
    s.index(&quot;ABA&quot;)#index也用于查找，但是如果没找到则会引发异常，rindex同理
except Exception as e:#将异常存入e
    print(e)#输出异常结果
a=&quot;1234abcd5678&quot;
print(a.find(&quot;12&quot;,4))#-1,4规定了查找的起始下标
print(a.replace(&quot;abcd&quot;,&quot;1234&quot;))#用1234替代abcd，a本身不会发生变化
print(&quot;123.4&quot;.isdigit())#False,isdigit判断字符串中的字符是否都是数字
print(&quot;ab123&quot;.islower())#True,islower判断字符串中的字母是否都是小写字母
print(&quot;Aa123&quot;.isupper())#False,isupper判断字符串中的字母是否都是大写字母
</code></pre>
<pre><code class="language-python">#strip()用于删去字符串两端的空字符如：空格，\n，\t等,返回一个字符串，但是不改变原字符串
string=&quot;   abc\t\n   &quot;
string=string.strip()
print(string)#abc
</code></pre>
<p>字符串编码：字符串的编码在内存中的编码是unicode的</p>
<p>字符串的格式化：</p>
<pre><code class="language-python">x=&quot;Hello {0} {1:10},you get ${2:0.4f}&quot;.format(&quot;Mr.&quot;,&quot;Jack&quot;,3.2)#format用于格式化
print(x)#输出Hello Mr. Jack      ,you get $3.2000
#{序号:宽度.精度 类型}用于规范输出格式，与format中的变量一一对应
#宽度前还可以加对齐设定，&gt;右对齐，&lt;左对齐，^中对齐
x=&quot;Hello {0} {1:^10},you get ${2:0.4f}&quot;.format(&quot;Mr.&quot;,&quot;Jack&quot;,3.2)#format用于格式化
print(x)#Hello Mr.    Jack   ,you get $3.2000,实现Jack的中对齐
</code></pre>
<h4 id="3元组">3.元组</h4>
<p>元组：一个元组由数个逗号分隔的值组成，前后的括号可加可不加</p>
<p>元组与列表的区别在于：元组不可修改，不可增删元素，不可对元素进行赋值，不可修改元素的排序，对元组进行处理的速度比列表快</p>
<pre><code class="language-python">t=12345,54321,&quot;hello&quot;#t为一个元组
print(t)#(12345,54321,&quot;hello&quot;)
print(t[0])#12345
u=t,(1,2,3,4,5)#u也是一个元组，且u中的两个元素也都是元组
print(u[1][2])#3
print(len(u))#2,len也可以作用于元组
</code></pre>
<p>注意元组的元素的内容可以被修改。<br>
元组的元素本质上是指针，元组的元素不可修改指的是元组元素的指向不可被改变，但指向的内容可修改</p>
<pre><code class="language-python">t=([1,2,3,4],['a','b'])
t[1][1]='c'#正确，不会报错
print(t)#([1,2,3,4],['a','c'])
</code></pre>
<pre><code class="language-python">empty=()#空元组
a=&quot;hello&quot;,#注意最后的逗号，说明a是一个只含一个元素的元组
print(a)#(&quot;hello&quot;,)
#注意只含一个元素的元组，不管加不加括号，最后一定要加上一个逗号！！！
</code></pre>
<p>元组的下标访问、切片规则以及运算法则与字符串完全相同</p>
<pre><code class="language-python">t=(&quot;Google&quot;,&quot;Runoob&quot;,1997,2000)
s=(1,2,3,4)
print(t[0])#Google
print(t[1:3])#(&quot;Runoob&quot;,1997)
print(t[::-1])#(2000,1997,&quot;Runoob&quot;,&quot;Google&quot;)
t+=('a','b','c')
print(t)#(&quot;Google&quot;,&quot;Runoob&quot;,1997,2000,'a','b','c')
print(t+s)#(&quot;Google&quot;,&quot;Runoob&quot;,1997,2000,'a','b','c',1,2,3,4)
</code></pre>
<p>元组的运算、迭代和赋值</p>
<pre><code class="language-python">x=(1,2,3)*3#重复写三次元组
print(x)#(1,2,3,1,2,3,1,2,3)
print(4 in x)#False
#元组的赋值特殊
x=(1,2,3,4)
b=x#b和x指向同一内存
print(b is x)#True
x+=(100,)#等效于x=x+(100,)在等号右边新建一个元组，改变了x原有的指向,因为不能在元组上增删元素！！！！！
print(x)#(1,2,3,4,100)
print(b)#(1,2,3,4)
print(b is x)#False
</code></pre>
<p>元组比大小：类似于字符串按照字典顺序和数字大小一一对应进行比较，但是数字于字符串不能比大小，此时会报错</p>
<pre><code class="language-python">print((2,&quot;a&quot;)&gt;(1,'b','c'))#True
#print((2,&quot;a&quot;)&gt;(&quot;ab&quot;,&quot;c&quot;))#runtime error,会报错
#列表大比大小与元组比大小的规则完全相同
</code></pre>
<p>我们可以用列表或元组取代复杂的分支结构</p>
<pre><code class="language-python">#万年历，已知2012年1月25日是星期三，现输入一个2012年1月25日之后的日期，输出该日期是星期几
monthDays=[-1,31,28,31,30,31,30,31,31,30,31,30,31]
days=0#从2012.1.25开始过了多少天
lst=input().split()
year,month,date=int(lst[0]),int(lst[1]),int(lst[2])
for y in range(2012,year):
    if y%4==0 and y%100!=0 or y%400==0:#判断是否为闰年
        days+=366
    else:
        days+=365
if year%4==0 and year%100!=0 or year%400==0:
    monthDays[2]=29
for i in range(1,month):
    days+=monthDays[i]
days+=date
days-=25
print((days+3)%7)
</code></pre>
<h3 id="六列表">六.列表</h3>
<h4 id="1列表的基本操作">1.列表的基本操作</h4>
<p>列表是可以增删元素的，并且列表中的元素也可以进行修改</p>
<pre><code class="language-python">lst=[1,2,3,4,5]
del lst[2]#删减元素
print(lst)#[1，2，4，5]
lst.append(6)#增加元素,括号中的元素被当作一个元素插入进列表尾部
print(lst)#[1，2，4，5，6] 
lst2=[lst,7,8]#注意lst2建立之后，与lst还有着联系，lst中的元素改变，lst2中对应的元素也跟着改变
print(lst2)#[[1, 2, 4, 5, 6], 7, 8]
print(lst2[0][1])#2
</code></pre>
<pre><code class="language-python">a=[1,2,3]
b=['a','b','c']
c=a+b#注意c建立之后指向一个新的内存，不再与a，b之间产生联系
print(c)#[1,2,3,'a','b','c']
a[0]=100
print(c)#[1,2,3,'a','b','c']
</code></pre>
<pre><code class="language-python">a=[1,2,3]
c=a
b=['a','b','c']
a+=b#不同于元组，a+=b不等效于a=a+b,a的指向未改变
#a+=b相当于在a后面加上b
#a=a+b相当于用a+b构建一个新的列表，然后使a指向新的内存
print(c)#[1,2,3,'a','b','c']，c与a仍指向同一内存
</code></pre>
<p>列表的运算</p>
<pre><code class="language-python">a=[1,2]
b=a*3#b建立之后与a不再有联系
c=[a]*3#c建立之后，列表中的每个元素都指向a，与a还有联系
#当建立一个新的变量时，如果是以列表或元组的形式对其赋值且[]或()中有一个其他变量，则新变量与这个变量有联系
print(b)#[1,2,1,2,1,2]
print(c)#[[1, 2], [1, 2], [1, 2]]
a.append(3)
print(b)#[1,2,1,2,1,2]
print(c)#[[1, 2, 3], [1, 2, 3], [1, 2, 3]]
print(b.index(1))#0,注意列表只有index用于查找，没有find
</code></pre>
<pre><code class="language-python">#例题
a=[[0]]*2+[[0]]*2#+前后两个[0]不是同一个！！！
a[0][0]=5
print(a)#[[5], [5], [0], [0]]
</code></pre>
<p>列表的切片</p>
<pre><code class="language-python">a=[1,2,3,4]
b=a[1:3]#b创建之后，与a没有任何联系
print(b)#[2,3]
print(a[::-1])#[4,3,2,1]
</code></pre>
<h4 id="2列表的排序">2.列表的排序</h4>
<p>选择排序：基础的排序算法，但是效率较低</p>
<pre><code class="language-python">def SelectionSort(a):#即为冒泡排序
    n=len(a)
    for i in range(n-1):#每次从a[i]及其右边的元素中选择最小的元素并将其放在a[i]位置
        for j in range(i+1,n):#依次考察a[i]右边的元素
            if a[j]&lt;a[i]:
                a[i],a[j]=a[j],a[i]
lst=[1,12,4,56,6,2]
SelectionSort(lst)
print(lst)#[1, 2, 4, 6, 12, 56]
</code></pre>
<p>python自带的排序函数：</p>
<pre><code class="language-python">a=[7,5,6,4,3,1,2]
a.sort()#对a进行排序，默认从小到大排,不仅可以对数字进行排序，也可以对于其他数据类型按照字典排序，sort为稳定的排序
print(a)#[1,2,3,4,5,6,7]
a.sort(reverse=True)#从大到小进行排序
print(a)#[7,6,5,4,3,2,1]
b=sorted(a)#将排序好的a赋值给b，但是不改变a
print(b)#[1,2,3,4,5,6,7]
b=sorted(a,reverse=True)#同理，从大到小排序
print(b)#[7,6,5,4,3,2,1]
</code></pre>
<p>对于不同的需求，我们可以自定义比较函数用在sort函数上</p>
<pre><code class="language-python">def myKey(x):
    return x%10
a=[25,7,16,33,6,1,2]
a.sort(key=myKey)#key是函数，sort按照对每个元素调用该函数的返回值大小进行排序
print(a)#[1,2,33,4,25,16,7]
b=sorted(&quot;This is a test string from Andrew&quot;.split(),key=str.lower)#以各个字符串的小写形式比大小
print(b)#['a', 'Andrew', 'from', 'is', 'string', 'test', 'This']
</code></pre>
<h4 id="3复杂列表的自定义排序">3.复杂列表的自定义排序</h4>
<h5 id="1lambda表达式">（1）lambda表达式</h5>
<p>lambda x:x[2]，表示一个函数，参数是x，返回值是x[2]，相当于是一个匿名函数</p>
<pre><code class="language-python">k=lambda x,y:x+y#k为一个函数
print(k(4,5))#9
</code></pre>
<h5 id="2自定义排序">（2）自定义排序</h5>
<pre><code class="language-python">students=[('John','A',15),('Mike','B',12),('Mike','C',18),('Bom','D',10)]#列表中的每个元素都是一个三元组
students.sort(key=lambda x:x[2])#按年龄进行排序
print(students)#[('Bom', 'D', 10), ('Mike', 'B', 12), ('John', 'A', 15), ('Mike', 'C', 18)]
</code></pre>
<h5 id="3元组的排序">（3）元组的排序</h5>
<p>元组的元素不能被修改，因此没有相应的sort函数，但是有sorted函数可以作用于元组，但是返回值是一个列表</p>
<h4 id="4列表和元组的高级用法">4.列表和元组的高级用法</h4>
<p>列表的相关函数：</p>
<pre><code class="language-python">a=[1,2,3,4,1]
a.insert(3,5)#将5插入到下标为3的位置
print(a)#[1,2,3,5,4,1]
a.remove(1)#删除第一个值为1的元素
print(a)#[2,3,5,4,1]
a.reverse()#反转a
print(a)#[1,4,5,3,2]
del a[2]#删除a中下标为2的元素
print(a)#[1,4,3,2]
</code></pre>
<p>列表映射：</p>
<pre><code class="language-python">def f(x):
    print(x,end=&quot;&quot;)
    return x*x
a=map(f,[1,2,3])#map用于将一个序列映射到另一个序列，返回一个延时求值对象，可以转换成list，tuple，set...
#调用完map后，将序列中每个元素调用f的操作存储下来，并不会执行f（称此为延时求值），因此没有任何输出
print(list(a))#123[1,4,9],将延时求值对象转换为列表，并将每个元素调用f的结果存储到该列表中
print(tuple(a))#(),延时求值对象的操作已经执行完，因此再转换成元组时不会有任何操作，返回空元组
a=list(map(lambda x:x*2,[2,4,6]))
print(a)#[4,8,12]
</code></pre>
<pre><code class="language-python">#map可以用于简化输入
x,y,z=map(int,input().split())#输入1 2 3
print(x,y,z)#1 2 3
</code></pre>
<p>列表过滤：</p>
<pre><code class="language-python">def f(x):
    return x%2==0
a=tuple(filter(f,[1,2,3,4,5]))#filter用于筛选出序列中调用f返回值为True的元素，并返回一个延时求值对象
print(a)#(2，4)
</code></pre>
<p>列表生成式：</p>
<pre><code class="language-python">a=[x*x for x in range(1,11)]
print(a)#[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
b=[x*x for x in range(1,11) if x%2==0]
print(b)#[4, 16, 36, 64, 100]
c=[m+n for m in 'ABC' for n in 'XYZ']
print(c)#['AX', 'AY', 'AZ', 'BX', 'BY', 'BZ', 'CX', 'CY', 'CZ']
d=[[m+n for m in 'ABC']for n in 'XYZ']
print(d)#[['AX', 'BX', 'CX'], ['AY', 'BY', 'CY'], ['AZ', 'BZ', 'CZ']]
#同理有元组生成式
e=tuple(x*x for x in range(1,11))#元组生成式前面必须有tuple
print(e)#(1, 4, 9, 16, 25, 36, 49, 64, 81, 100)
</code></pre>
<p>二维列表的定义：</p>
<pre><code class="language-python">matrix=[[1,2,3],[4,5,6],[7,8,9]]#正确,相当于一个矩阵
print(matrix[1][1])#5
matrix=[[0 for i in range(3)] for i in range(3)]#利用列表生成式生成二维列表
print(matrix)#[[0,0,0],[0,0,0],[0,0,0]]
lst=[]
for i in range(3):
    lst.append([0]*4)
print(lst)#3行4列的元素全为0的矩阵
#同理可以定义二维元组
</code></pre>
<p>列表的拷贝：</p>
<pre><code class="language-python">a=[1,2,3,4]
b=a[:]#b是a的拷贝，b和a指向不同的对象,但是未能进行深拷贝
b+=[10]
print(b)#[1,2,3,4,10]
print(a)#[1,2,3,4]
</code></pre>
<p>列表的深拷贝：</p>
<pre><code class="language-python">a=[1,[2]]
b=a[:]
print(b)#[1,[2]]
a[1].append(3)
print(b)#[1,[2,3]],说明未能深拷贝
</code></pre>
<pre><code class="language-python">#深拷贝的实现
import copy#引入copy包
a=[1,[2]]
b=copy.deepcopy(a)#进行深拷贝
a[1].append(3)
print(b)#[1,[2]]
</code></pre>
<p>元组和列表的互转：</p>
<pre><code class="language-python">a=[1,2,3]
b=(1,2,3)
print(tuple(a))#(1,2,3)
print(list(b))#[1,2,3]
[x,y,z]=a
print(x,y,z)#1 2 3
(x,y,z)=b
print(x,y,z)#1 2 3
</code></pre>
<p>元组列表和字符串的互转：</p>
<pre><code class="language-python">a=list(&quot;hello&quot;)
print(a)#['h', 'e', 'l', 'l', 'o']
b=tuple(&quot;hello&quot;)
print(b)#('h', 'e', 'l', 'l', 'o')
c=&quot;&quot;.join(['a','b','c'])
print(c)#abc
d=&quot;&quot;.join(('a','b','c'))
print(d)#abc
</code></pre>
<h4 id="5例题">5.例题</h4>
<pre><code class="language-python">#成绩排序：输入n个人名和成绩，按照成绩从大到小进行排序，如果成绩相等，则按照姓名的字典序从小到大排
n=int(input())
a=[]
for i in range(n):
    s=input().split()
    a.append((s[0],int(s[1])))
a.sort(key=lambda x:(-x[1],x[0]))
for i in a:
    print(i[0],i[1])
</code></pre>
<pre><code class="language-python">#图像模糊处理：给定n行m列的图像各像素点的灰度值，要求用如下方法对其进行模糊处理
#1.四周最外侧的像素点灰度值不变
#2.中间各像素点的灰度值为该像素点与其上下左右各像素点灰度值的平均
import copy
n,m=map(int,input().split())
a=[]#建立一个空表
for i in range(n):#建立二维列表
    lst=list(map(int,input().split()))
    a.append(lst)
b=copy.deepcopy(a)#b为a的深拷贝
for i in range(1,n-1):#处理中间像素点
    for j in range(1,m-1):
        b[i][j]=int((a[i][j]+a[i-1][j]+a[i][j-1]+a[i+1][j]+a[i][j+1])/5)
for i in range(n):
    for j in range(m):
        print(b[i][j],end=&quot; &quot;)
    print(&quot;&quot;)
</code></pre>
<h3 id="七字典和集合">七.字典和集合</h3>
<h4 id="1字典的基本概念">1.字典的基本概念</h4>
<p>字典中的每个元素由“键：值”两部分组成，每个元素的键是唯一且不与其他元素的键相同的，可以根据键对元素进行快速查找</p>
<p>键必须是不可变的数据类型，如字符串，整数，小数，元组；而列表，集合，字典等可变数据类型不能作为字典元素的键</p>
<pre><code class="language-python">dt={'Jack':18,&quot;Mike&quot;:19,128:37,(1,2):[4,5]}#dt为一个字典
print(dt['Jack'])#18，输出键为Jack的元素的值
dt[128]=40#将键为128的元素的值改为40
print(dt)#{'Jack': 18, 'Mike': 19, 128: 40, (1, 2): [4, 5]}
#print(dt['c'])#error
</code></pre>
<p>字典的增删元素：</p>
<pre><code class="language-python">dt={'Jack':18,&quot;Mike&quot;:19,128:37,(1,2):[4,5]}#dt为一个字典
del dt['Mike']#删除键为Mike的元素
print(dt)#{'Jack': 18, 128: 37, (1, 2): [4, 5]}
dt['Sam']=17#增加键为Sam值为17的元素
print(dt)#{'Jack': 18, 128: 37, (1, 2): [4, 5], 'Sam': 17}
</code></pre>
<p>字典元素不能重复，如果重复则保留后一个出现的元素：</p>
<pre><code class="language-python">a=(1,2,3)
b=(1,2,3)
dt={a:10,b:20,(1,2,3):30}
print(dt)#{(1,2,3):30}
</code></pre>
<p>字典的构造：</p>
<pre><code class="language-python">lst=[('Jack',18),('Mike',19)]#只有元素为含有两个元素的列表或元组的列表或元组才能转为字典
dt=dict(lst)#将列表转为字典
print(dt)#{'Jack': 18, 'Mike': 19}
dt=dict(name='Sam',height=177)#此种方法只适用于键都为字符串的字典的创建，且键不带引号
print(dt)#{'name': 'Sam', 'height': 177}
</code></pre>
<h4 id="2字典的相关函数">2.字典的相关函数</h4>
<pre><code class="language-python">dt={'name':'Gumby','age':42,'GPA':3.5}
print(dt.keys())#dict_keys(['name', 'age', 'GPA']),keys()取字典键的序列
print(dt.items())#dict_items([('name', 'Gumby'), ('age', 42), ('GPA', 3.5)]),items()取字典元素序列
print(dt.values())#dict_values(['Gumby', 42, 3.5])，values()取字典值的序列
#注意上述序列不是list、tuple或set
dt.pop('GPA')#删除键为‘GPA’的元素，如果未找到则产生异常
print(dt)#{'name': 'Gumby', 'age': 42}
dt.clear()#清空字典
print(dt)#{}
</code></pre>
<p>遍历字典：</p>
<pre><code class="language-python">dt={'name':'Gumby','age':42,'GPA':3.5}
for x in dt.items():#此时x为元组
    print(x,end=&quot; &quot;)#('name', 'Gumby') ('age', 42) ('GPA', 3.5) 
</code></pre>
<p>字典的浅拷贝与深拷贝：</p>
<pre><code class="language-python">#浅拷贝
x={'username':'wzt',1978:[1,2,3]}
y=x.copy()
y['username']='hust'#不影响x
y[1978].remove(2)#影响x
print(y)#{'username': 'hust', 1978: [1, 3]}
print(x)#{'username': 'wzt', 1978: [1, 3]}
#深拷贝
import copy
z=copy.deepcopy(x)#深拷贝
z[1978].remove(1)#不影响x
print(z)#{'username': 'wzt', 1978: [3]}
print(x)#{'username': 'wzt', 1978: [1, 3]}
</code></pre>
<h4 id="3字典例题">3.字典例题</h4>
<pre><code class="language-python">#统计单词频率，输入若干单词，按照出现频率从大到小输出频率和单词，如果频率相同则按照字典序从小到大输出
dt={}#空字典
while True:
    try:
        wd=input()
        # if wd in dt:
        #     dt[wd]+=1#如果有元素wd，则给其次数加一
        # else:
        #     dt[wd]=1#如果没有元素wd，则在字典中插入wd
        dt[wd]=dt.get(wd,0)+1#如果dt中有键为wd的元素，则返回该元素的值，否则返回后一个数0
    except:
        break
result=[]#空列表用于存储结果
for i in dt.items():
    result.append(i)#i为元组，i[0]为单词，i[1]为数字
result.sort(key=lambda x:(-x[1],x[0]))
for x in result:
    print(x[1],x[0])
</code></pre>
<h4 id="4集合">4.集合</h4>
<p>集合的定义同数学上的集合，集合中元素类型可以不同，不会有重复的元素，可以增删元素，集合中的元素类型应为可变数据类型如：字符串，整数，小数，复数，元组，而不能为列表、字典和集合</p>
<p>集合的作用是可以快速地判断某个元素是否在一堆元素里面</p>
<p>集合的构造：</p>
<pre><code class="language-python">x=set([])#构造一个空集合，也可以写成set()
a={1,2,2,&quot;hello&quot;,(1,3)}#a是一个集合，会自动去重
print(a)#{'hello', 1, 2, (1, 3)},注意集合中的元素是没有顺序的！！！！
#print(a[2])#error,因为集合没有顺序，所以无法用下标进行访问
b=[1,2,3,4]#b为列表
c=('a','b','c')#c为元组
d={1:2,'OK':3,(1,2):7}#d为字典
print(set(b))#{1, 2, 3, 4}，用列表构建集合
print(set(c))#{'b', 'c', 'a'}，用元组构建集合
print(set(d))#{1, (1, 2), 'OK'}，用字典构建集合，只取键
</code></pre>
<p>集合常用的函数：</p>
<pre><code class="language-python">a={1,2,3,4}#a为一个集合
b=[5,6,7,8]
a.add(5)#在集合中插入元素5，如果集合中已存在5，则不添加
print(a)#{1, 2, 3, 4, 5}
a.remove(2)#在集合中删除2，如果集合中没有2，则产生异常
print(a)#{1, 3, 4, 5}
a.update(b)#将序列b中的元素加入集合
print(a)#{1, 3, 4, 5, 6, 7, 8}
c=a.copy()#返回集合的浅拷贝
print(c)#{1, 3, 4, 5, 6, 7, 8}
a.clear()#清空集合
print(a)#set(),注意空集合用set()表示，空字典用{}表示
</code></pre>
<p>集合的逻辑运算：</p>
<pre><code class="language-python">a={1,2,3}
b={2,3,4}
print(1 in a)#True
print(a|b)#{1,2,3,4},a|b为a与b的并集
print(a&amp;b)#{2,3},a&amp;b为a与b的交集
print(a-b)#{1},a-b为a与b的差
print(a^b)#{1,4},a^b为a与b的对称差，即a|b-a&amp;b
</code></pre>
<p>集合的比较：</p>
<pre><code class="language-python">a={1,2,3}
b={1,2,3,4,5}
print(a==b)#False，判断a，b是否相同
print(a!=b)#True,判断a，b是否不同
print(a&lt;=b)#True,判断a是否是b的子集
print(a&lt;b)#True,判断a是否是b的真子集
</code></pre>
<h3 id="八文件读写和文件夹操作和数据库">八.文件读写和文件夹操作和数据库</h3>
<h4 id="1文本文件的读写">1.文本文件的读写</h4>
<p>创建文本文件并写入内容：</p>
<pre><code class="language-python">a=open(&quot;F:\\test.txt&quot;,&quot;w&quot;)#open用于按照路径打开或创建文件，w表示打开文件的方式为写，如果原文件存在则会覆盖原文件
a.write(&quot;hello,world\n&quot;)#write用于向文件中写入内容
a.write(&quot;good!&quot;)
a.close()#open之后一定要记得close
#操作完之后F:\\test.txt中的内容为
#hello,world
#good!
</code></pre>
<p>读取现有文件：</p>
<pre><code class="language-python">f=open(&quot;F:\\test.txt&quot;,&quot;r&quot;)#r表示打开文件的方式为读，如果文件不存在则会产生异常
lines=f.readlines()#readlines()返回一个列表，每个元素都是一个字符串，代表文件文本内容的一行(带\n)
line1=f.readline()#readline()只读取一行，返回一个字符串
line2=f.readline()
f.close()
for x in lines:
    print(x,end=&quot;&quot;)#注意列表每个元素都带有换行符
#输出结果为F:\\test.txt中的内容
#hello,world
#good!
</code></pre>
<pre><code class="language-python">f=open(&quot;F:\\test.txt&quot;,&quot;r&quot;)
line1=f.readline()#readline()只读取一行，返回一个字符串,结尾如果有换行符会带\n
line2=f.readline()
f.close()
print(line1,end=&quot;&quot;)#hello,world
print(line2,end=&quot;&quot;)#good!
</code></pre>
<pre><code class="language-python">f=open(&quot;F:\\test.txt&quot;,&quot;r&quot;)
txt=f.read()#将整个文件内容读入一个字符串txt
f.close()
print(txt)
#输出结果为F:\\test.txt中的内容
#hello,world
#good!
</code></pre>
<p>在文件中添加内容：</p>
<pre><code class="language-python">f=open(&quot;F:\\test.txt&quot;,&quot;a&quot;)#a表示向文件中添加新内容而不覆盖原内容，若文件不存在就创建文件
f.write(&quot;OK\n&quot;)#向新文件中添加OK
f.close()
#操作完之后F:\\test.txt中的内容为
#hello,world
#good!
#OK
</code></pre>
<h4 id="2文本文件的编码">2.文本文件的编码</h4>
<p>常见文件的编码有gbk和utf-8两种，ANSI对应gbk，创建和读写文件时都可以指定编码，如果不指定则默认为缺省的编码</p>
<p>.py文件必须存成utf-8格式才能运行，如果存成ansi格式（即为gbk格式），应在文件开头写#coding =gbk</p>
<pre><code class="language-python">f=open(&quot;F:\\test.txt&quot;,&quot;r&quot;,encodeing=&quot;utf-8&quot;)#以utf-8的编码格式打开文件
f.close()
</code></pre>
<h4 id="3文件的路径">3.文件的路径</h4>
<p>相对路径：文件路径没有包含盘符</p>
<p>当前文件夹：一般来说.py文件所在的文件夹就是当前文件夹</p>
<pre><code class="language-python">f=open(&quot;../../test.txt&quot;,&quot;r&quot;)#文件在当前文件夹的上两层文件夹里面,/等价于\\
f.close()
f=open(&quot;/tmp/test.txt&quot;,&quot;r&quot;)#文件在当前盘符的根文件夹下
f.close()
</code></pre>
<pre><code class="language-python">#可以获取当前文件夹
import os
print(os.getcwd())#输出当前.py文件所在文件夹
</code></pre>
<p>绝对路径：文件路径指明了盘符</p>
<h4 id="4文件夹操作">4.文件夹操作</h4>
<p>python的文件夹和文件操作函数：</p>
<pre><code class="language-python">import os#引入os包
import shutil#引入shutil包
os.chdir(x)#将程序当前文件夹设置为x
os.getcwd()#求程序当前文件夹
os.listdir(x)#返回一个列表，列表元素是文件夹x中所有文件和子文件夹的名字
os.mkdir(x)#创建文件夹x
os.path.getsize(x)#获取文件x的大小
os.path.isfile(x)#判断x是不是文件
os.remove(x)#删除文件x
os.rmdir(x)#删除文件夹，前提是文件夹为空文件夹
os.rename(x,y)#将文件或文件夹x改名为y，也可以起到移动文件的作用
shutil.copy(x,y)#拷贝文件x到文件y，如果y已存在，则会覆盖y
</code></pre>
<p>有时文件夹非空但也想要删除文件夹，则不能调用os.rmdir(x)，可以自己定义删除文件夹的函数：</p>
<pre><code class="language-python">#递归删除文件夹
import os
def powerRmdir(path):#连根删除文件夹path，删除的文件夹不能恢复，慎用
    lst=os.listdir(path)#将当前文件夹下的文件和子文件夹名存储至lst
    for x in lst:#x只是文件名和文件夹名，不包含路径
        actualFileName=path+&quot;/&quot;+x#构建完整路径
        if os.path.isfile(actualFileName):#actualFileName是文件
            os.remove(actualFileName)
        else:#actualFileName是文件夹
            powerRmdir(actualFileName)
    os.rmdir(path)#最后删除空文件夹
</code></pre>
<p>获取文件夹总大小也可以同理自己定义函数：</p>
<pre><code class="language-python">#递归获取文件总大小
def getTotalSize(path):
    total=0
    lst=os.listdir(path)
    for x in lst:#x只是文件名和文件夹名，不包含路径
        actualFileName=path+&quot;/&quot;+x#构建完整路径
        if os.path.isfile(actualFileName):#actualFileName是文件
            total+=os.path.getsize(actualFileName)
        else:#actualFileName是文件夹
            total+=getTotalSize(actualFileName)
    return total
</code></pre>
<h4 id="5命令行参数">5.命令行参数</h4>
<p>Win+R并输入cmd即可打开控制台，输入python ×××.py即可运行×××.py，注意需要先将控制台转到.py当前文件夹下</p>
<p>当.py文件需要输入参数时，我们希望可以直接在命令行直接输入，可进行如下操作：</p>
<pre><code class="language-python">#求和程序，假设.py文件的文件名为pythonfile.py且在命令行输入python main.py 3 4
import sys#引入sys包
for x in sys.argv:
    print(x)#argv即为一个列表，列表的参数为命令行输入的字符串
#输出结果：
#main.py
#3
#4
print(int(sys.argv[1])+int(sys.argv[2]))#7
</code></pre>
<h4 id="6文件处理实例">6.文件处理实例</h4>
<pre><code class="language-python">#统计文章中单词的词频
#运用命令行输入python main.py 源文件 结果文件
#对源文件进行单词词频分析，将结果写入结果文件，单词按照字典排序
import sys#用于命令行输入
import re#用于分隔源文件
def countFile(filename,words):#处理源文件，将处理结果存入字典words
    try:
        f=open(filename,&quot;r&quot;,encoding=&quot;utf-8&quot;)
    except Exception as e:#如果打开文件失败，则报错并返回
        print(e)
        return 0
    txt=f.read()#将整个文件内容读入字符串txt
    f.close()
    splitChars=set([])#分割串的集合
    for c in txt:
        if not(c&gt;='a' and c&lt;='z' or c&gt;='A' and c&lt;='Z'):
            splitChars.add(c)
    splitStr=&quot;&quot;#用于re.split的正则表达式
    for c in splitChars:
        if c in ['.','?','!','&quot;',&quot;'&quot;,'(',')','[',']','{','}','|','*','$','\\','^']:
        #这些字符比较特殊，在正则表达式中需要加\
            splitStr+=&quot;\\&quot;+c+&quot;|&quot;
        else:
            splitStr+=c+&quot;|&quot;
    splitStr+=&quot; &quot;#'|'后面必须要有东西，空格多写一遍没关系
    lst=re.split(splitStr,txt)#将文章分割为若干单词
    for x in lst:
        if x==&quot;&quot;:#忽略空串
            continue
        else:
            lx=x.lower()
        words[lx]=words.get(lx,0)+1#将lx的信息整合到字典，没有则插入lx，有则次数+1
    return 1
result={}#空字典用于存储结果
if countFile(sys.argv[1],result)==0:#处理源文件
    exit()
lst=list(result.items())#将字典信息转为列表，写为list(result)只会保留键
lst.sort()#对列表中的二元组进行排序
f=open(sys.argv[2],&quot;w&quot;)
for x in lst:
    f.write(&quot;%s\t%d\n&quot; % (x[0],x[1]))
f.close()
</code></pre>
<h4 id="7数据库和sql语言简介">7.数据库和SQL语言简介</h4>
<h5 id="1数据库">（1）数据库：</h5>
<p>数据库可以存放大量数据，并且提供了方便快捷的检索手段，一个数据库可以是一个文件</p>
<p>一个数据库中可以有多张表，每张表又又不同的字段，字段又有其相应的类型</p>
<h5 id="2sql语言">（2）SQL语言：</h5>
<p>SQL命令是用于进行数据库操作的标准语句</p>
<pre><code class="language-python">#创建数据库并写入数据
import sqlite3#提供了数据库功能
db=sqlite3.connect(&quot;F:/tmp/test.db&quot;)#连接数据库，若不存在则自动创建
cur=db.cursor()#获取光标，对数据库的操作一般要通过光标
sql='''CREATE TABLE if not exists students(id integer primary key,name text,gpa real,birthday date,age integer,picture blob)'''#创建表student的SQL命令
#primary key用于声明主关键字，integer表整数，real表小数，date表日期，blob表二进制,它们是字段的数据类型
cur.execute(sql)#执行SQL命令
sql1='''INSERT INTO students VALUES(1000,'张三',3.81,'2000-09-12',18,null)'''#插入数据的SQL命令
#在没有相应数据时，只有在SQL命令中才可以写成null，在元组中一般写成None
cur.execute(sql1)#执行SQL命令
mylist=[(1700,'李四',3.25,'2001-12-01',17,None),
        (1800,'王五',3.35,'1999-01-01',18,None)]
for s in mylist:#依次插入mylist中的每个记录
    cur.execute('INSERT INTO students VALUES(?,?,?,?,?,?)',(s[0],s[1],s[2],s[3],s[4],s[5]))#?对应于后面某项
db.commit()#落实对数据库的修改，真正地写入数据库，一定要写！！！
cur.close()#关闭光标
db.close()#关闭数据库
</code></pre>
<p>用sqlite3.exe打开.db文件时，输入select * from 表名;即可显示表中信息，注意一定要加分号</p>
<h5 id="3数据库的查询和修改">（3）数据库的查询和修改</h5>
<p>数据库的查询：</p>
<pre><code class="language-python">import sqlite3
db=sqlite3.connect(&quot;F:/tmp/test.db&quot;)#连接数据库，若不存在则自动创建
cur=db.cursor()#获取光标，对数据库的操作一般要通过光标
sql=&quot;SELECT * FROM students&quot;#检索students表中的全部记录,*代表全部
cur.execute(sql)#提取出的记录存储在光标中
for x in cur.fetchall():#fetchall取得所有满足条件的记录，以元组的形式存储
    print(x)
#输出结果为数据库中的内容，后续不再做输出
sql1=&quot;SELECT * FROM students ORDER BY age&quot;#检索students表中的全部记录，并按年龄排序，后面再加DESC表示按降序排
cur.execute(sql1)
sql2=&quot;SELECT name,age FROM students&quot;##检索students表中的全部记录,但每个记录只取name和age两个字段
cur.execute(sql2)
sql3=&quot;SELECT * FROM students WHERE name='张三'&quot;#检索students表中的全部name为张三的记录，WHERE表示检索条件
cur.execute(sql3)
sql4=&quot;SELECT * FROM students WHERE name='张三' AND age&gt;10&quot;
cur.execute(sql4)
db.commit()#落实对数据库的修改，真正地写入数据库，一定要写！！！
cur.close()#关闭光标
db.close()#关闭数据库
</code></pre>
<p>数据库的修改：</p>
<pre><code class="language-python">import sqlite3
db=sqlite3.connect(&quot;F:/tmp/test.db&quot;)#连接数据库，若不存在则自动创建
cur=db.cursor()#获取光标，对数据库的操作一般要通过光标
sql=&quot;UPDATE students SET birthday='2001-06-28' WHERE name='钱六'&quot;
#将钱六的生日改为2001-06-28,没有WHERE限制条件，则会更改所有
cur.execute(sql)
db.commit()#落实对数据库的修改，真正地写入数据库，有写入操作时一定要写！！！
cur.close()#关闭光标
db.close()#关闭数据库
</code></pre>
<pre><code class="language-python">import sqlite3
db=sqlite3.connect(&quot;F:/tmp/test.db&quot;)#连接数据库，若不存在则自动创建
cur=db.cursor()#获取光标，对数据库的操作一般要通过光标
sql=&quot;DELETE FROM students WHERE age&lt;18&quot;#删除数据库中年龄小于18的人
cur.execute(sql)
db.commit()#落实对数据库的修改，真正地写入数据库，有写入操作时一定要写！！！
cur.close()#关闭光标
db.close()#关闭数据库
</code></pre>
<h5 id="4数据库二进制字段处理">（4）数据库二进制字段处理</h5>
<pre><code class="language-python">import sqlite3
f=open('F:/tmp/picture.jpg','rb')#以二进制的形式打开文件
img=f.read()#将图片的二进制信息存入img
f.close()
db=sqlite3.connect(&quot;F:/tmp/test.db&quot;)#连接数据库，若不存在则自动创建
cur=db.cursor()#获取光标，对数据库的操作一般要通过光标
sql=&quot;UPDATE students SET picture=? WHERE name='小魏'&quot;
cur.execute(sql,(img,))#设置小魏的照片，img对应于?
db.commit()#落实对数据库的修改，真正地写入数据库，有写入操作时一定要写！！！
cur.close()#关闭光标
db.close()#关闭数据库
</code></pre>
<pre><code class="language-python">import sqlite3
import requests#用于访问网络资源
imgUrl=&quot;https://gss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/43a7d933c895d14345aa24687df082025baf0799.jpg&quot;#从网络获得照片
imgStream=requests.get(imgUrl,stream=True)#将图片的二进制数据存到imgStream,该句格式如此，记住就好
db=sqlite3.connect(&quot;F:/tmp/test.db&quot;)#连接数据库，若不存在则自动创建
cur=db.cursor()#获取光标，对数据库的操作一般要通过光标
sql=&quot;UPDATE students SET picture=? WHERE name='张三'&quot;
cur.execute(sql,(imgStream.content,))#设置张三的照片，imgStream.content对应于?
db.commit()#落实对数据库的修改，真正地写入数据库，有写入操作时一定要写！！！
cur.close()#关闭光标
db.close()#关闭数据库
</code></pre>
<h3 id="九正则表达式">九.正则表达式</h3>
<h4 id="1正则表达式的概念">1.正则表达式的概念</h4>
<p>正则表达式是某些字符有特殊含义的字符串，可以用相关函数用来判断其他字符串是否能与正则表达式进行匹配</p>
<p>正则表达式中的功能字符：\d等不是转义字符，都是两个字符</p>
<pre><code class="language-python">#(1). :可以匹配除\n外的任何字符，如'a.b'匹配'acb','a(b'等
#(2)*:量词，表示左边的字符可以出现0次或任意多次，如'a*b'匹配'b','aaaab'等
#(3)?:量词，表示左边的字符必须出现1次或0次，如'a?b'匹配'ab','b'
#(4)+:量词，表示左边的字符必须出现1次或更多次，如'a?b'匹配'ab','aab'等
#(5){m}:量词，表示左边的字符必须且只能出现m次，如'a{2}b'匹配'aab'
#(6){m,n}:量词，表示左边的字符必须出现至少m次，至多n次，{m,}代表没有上限
#(7)\d:表示一个数字字符
#(8)\D:表示一个非数字字符
#(9)\s:表示一个空白字符，如空格,\n,\t,\r等
#(10)\S:表示一个非空白字符
#(11)\w:表示一个单词字符，包含汉字，数字，字母，下划线或其他语言文字
#(12)\W:表示一个非单词字符
#(13)|:A|B表示能匹配A或能匹配B算匹配
</code></pre>
<p>正则表达式中的特殊字符：. + ? * ( ) [ ] { } ^ \ $，如果要在正则表达式中表示这几个字符本身，应该在前面加\</p>
<h4 id="2字符范围和量词">2.字符范围和量词</h4>
<pre><code class="language-python">#(1)[abc]:匹配a,b,c三个字符之一，如's[abc]t'匹配'sat','sbt','sct'
#(2)[a-zA-Z]:匹配任一英文字母
#(3)[\da-z\?]:匹配一个数字或一个小写英文字母或?
#(4)[^abc]:匹配一个非a,b,c的字符
#(5)[^a-f0-3]:匹配一个不是a-f且不是0-3的字符
#(6)[\u4e00-\u9fa5]:表示一个汉字，汉字的unicode编码范围是4e00-9fa5,\u表示16进制
</code></pre>
<p>字符的复合：</p>
<pre><code class="language-python">#(1).+:匹配任意长度不为0且不含\n的字符串
#(2).*:匹配任意不含\n的字符串
#(3)[\dac]+:匹配长度不为0的由数字或a，c构成的字符串
#(4)\w{5}:匹配长度为5的由单词字符构成的字符串
</code></pre>
<p>正则表达式示例：</p>
<pre><code class="language-python">#[1-9]\d*:正整数，正整数第一个数字一定是1-9
#-?[1-9]\d*|0:整数，-?表示-可有可无，|0或上0的情况
</code></pre>
<h4 id="3正则表达式的函数">3.正则表达式的函数</h4>
<p>使用正则表达式要import re</p>
<p>(1)re.match(pattern,string,flags=0)：从string的起始位匹配一个模式pattern，flags标志位用于控制模式串的匹配方式，如果匹配的上则返回一个匹配对象，否则返回None</p>
<pre><code class="language-python">import re
def match(pattern,string):
    x=re.match(pattern,string)
    if x!=None:
        print(x.group())#匹配对象有函数group用于返回匹配上的字符串
    else:
        print(&quot;None&quot;)
match(&quot;a c&quot;,&quot;a cbcd&quot;)#a c
match(&quot;abc&quot;,&quot;kabc&quot;)#None,从起始位置开始匹配，匹配不上
match(&quot;a\tb*c&quot;,&quot;a\tbbbbcabc&quot;)#a	bbbbc
</code></pre>
<p>(2)re.search(pattern,string,flags=0)：查找字符串中第一个可以匹配成功的子串，查找成功返回匹配对象，否则返回None</p>
<pre><code class="language-python">import re
def search(pattern,string):
    x=re.search(pattern,string)
    if x!=None:
        print(x.group(),x.span())#匹配对象有函数group用于返回匹配上的字符串,x.span()表示子串的起止位置
    else:
        print(&quot;None&quot;)
search(&quot;abc&quot;,&quot;kabc&quot;)#abc (1,4)，(1,4)代表下标1-3
search(&quot;[1-9]\d+&quot;,&quot;ab1234cd&quot;)#1234 (2,6)
</code></pre>
<p>(3)re.findall(pattern,string,flags=0)：查找字符串中所有可以匹配成功的子串，返回一个列表，如果匹配失败则返回空表</p>
<pre><code class="language-python">import re
print(re.findall(&quot;\d+&quot;,&quot;123 abc 456 def&quot;))#['123','456']
print(re.findall(&quot;[a-zA-Z]+&quot;,&quot;A dog has 4 legs&quot;))#['A', 'dog', 'has', 'legs']
print(re.findall(&quot;aaa&quot;,&quot;abaaaa&quot;))#['aaa']#非重叠查找
</code></pre>
<p>(4)re.finditer(pattern,string,flags=0)：查找字符串中所有可以匹配成功的子串，返回一个序列，序列中的每个元素都是一个匹配对象</p>
<h4 id="4边界符号">4.边界符号</h4>
<p>边界符号本身不与任何字符匹配</p>
<pre><code class="language-python">#\A:表示字符串的左边界，即要求从此往左边不能有任何字符
#\Z:表示字符串的右边界，即要求从此往右边不能有任何字符
#^:与\A相同，但在多行匹配模式下还可以表示一行文字的左边界
#$:与\Z相同，但在多行匹配模式下还可以表示一行文字的右边界
#\b:表示此处是单词的左边界或右边界，即不可是单词字符，在正则表达式中\b是两个字符，但是python字符串中\b看作一个字符，因此字符串中，应写成\\b，或者在字符串前加r取消\的转义
#\B:表示此处不是单词的左边界或右边界，即必须是单词字符
</code></pre>
<pre><code class="language-python">import re
def search(pattern,string):
    x=re.search(pattern,string)
    if x!=None:
        print(x.group(),x.span())#匹配对象有函数group用于返回匹配上的字符串,x.span()表示子串的起止位置
    else:
        print(&quot;None&quot;)
pt=&quot;ka\\b.*&quot;
search(pt,&quot;ka&quot;)#ka (0,2),a的右边不是单词字符，可以匹配
search(pt,&quot;kab&quot;)#None,a的右边是单词字符，匹配失败
</code></pre>
<h4 id="5分组">5.分组</h4>
<p>括号中的一个表达式就是分组，多个分组按照左括号，从左到右从1开始编号</p>
<pre><code class="language-python">import re
m=&quot;(((ab*)c)d)e&quot;
r=re.match(m,&quot;abcdefg&quot;)
print(r.group(0))#abcde,group(0)等价于group()
print(r.group(1))#abcd输出第一个分组
print(r.group(2))#abc
print(r.group(3))#ab
print(r.groups())#('abcd','abc','ab'),groups()返回一个元组，元组各元素是一个分组
</code></pre>
<p>在分组的右边可以通过分组的编号引用该分组所匹配的子串</p>
<pre><code class="language-python">import re
m=r'(((ab*)c)d)e\3'#r说明取消\的转义，\3要求ab*cde后面跟着3号分组在本次匹配中匹配上的子串
r=re.search(m,&quot;abbbcdeabbb&quot;)#3号分组对应的子串为abbb，因此只有abbbcde后面跟上abbb才能匹配成功
print(r.groups())#('abbbcd', 'abbbc', 'abbb')
</code></pre>
<p>分组作为一个整体，后面可以跟量词，且不一定需要匹配相同的字符串</p>
<pre><code class="language-python">import re
m='(((ab*)+c)d)e'#说明3号分组可以在相应位置出现多次
r=re.search(m,&quot;abababcde&quot;)
print(r.groups())#('abababcd', 'abababc', 'ab')
r=re.search(m,&quot;abacde&quot;)#a也算是ab*的重复出现，因为*允许b出现0次
print(r.groups())#('abacd', 'abac', 'a'),3号分组进行了两次匹配，第一次匹配上了ab，第二次匹配上了a，取最后一次匹配结果
</code></pre>
<p>当正则表达式中没有分组时，re.findall返回所有匹配子串构成的列表</p>
<p>当正则表达式有且仅有一个分组时，re.findall返回的是一个子串的列表，每个元素是一个匹配子串中分组对应的内容</p>
<p>当正则表达式中有超过一个分组时，re.findall返回的是一个元组的列表，元组中的每个元素依次是各个分组的内容</p>
<pre><code class="language-python">import re
m='[a-z]+(\d+)[a-z]+'#匹配两边被字母夹着的数
x=re.findall(m,&quot;abc12def asd34bdf&quot;)
print(x)#['12','34']
</code></pre>
<h4 id="6的用法">6.|的用法</h4>
<p>|表示或，如果没有放在分组中，|的起作用范围是直到整个正则表达式开头或结尾的另一个”|“</p>
<p>|从左到右短路匹配，当匹配到左边的后不会再匹配右边</p>
<pre><code class="language-python">import re
pt=&quot;aa|aab&quot;
x=re.findall(pt,&quot;aab123cdaaaab&quot;)#短路匹配
print(x)#['aa', 'aa', 'aa']
</code></pre>
<p>|也可以用在分组中，起作用的范围就仅限于分组</p>
<h4 id="7贪婪模式和懒惰模式">7.贪婪模式和懒惰模式</h4>
<h5 id="1贪婪模式">（1）贪婪模式</h5>
<p>量词+,*,?,{m,n}都默认匹配尽可能长的子串，存在很明显的弊端</p>
<h5 id="2懒惰模式">（2）懒惰模式</h5>
<p>即为非贪婪模式，在量词+,*,?,{m,n}后面加上？则匹配尽可能短的子串</p>
<pre><code class="language-python">import re
m1=&quot;a.*b&quot;#贪婪模式
m2=&quot;a.*?b&quot;#懒惰模式
r1=re.findall(m1,&quot;abcdadbb&quot;)
print(r1)#['abcdadbb']
r2=re.findall(m2,&quot;abcdadbb&quot;)
print(r2)#['ab', 'adb']
</code></pre>
<h4 id="8匹配对象的函数">8.匹配对象的函数</h4>
<pre><code class="language-python">import re
m=re.match(r&quot;(\w+) (\w+)(.)&quot;,&quot;hello world!ss&quot;)#匹配两个单词加一个字符
print(m.string)#hello world!ss,string返回用来做匹配的整个母串
print(m.lastindex)#3,lastindex返回在整个正则表达式中最后一个被匹配上的分组的编号
print(m.group(0,1,2,3))#('hello world!', 'hello', 'world', '!')
print(m.groups())#('hello', 'world', '!')
print(m.start(2))#6,start返回第二个分组起始位置在母串中的下标
print(m.end(2))#11，end返回第二个分组终止位置在母串中的下标+1
print(m.span(2))#(6,11)
</code></pre>
<h3 id="十玩转python生态">十.玩转Python生态</h3>
<h4 id="1用datatime库处理日期-时间">1.用datatime库处理日期、时间</h4>
<p>处理日期：</p>
<pre><code class="language-python">import datetime#导入datatime模块
dtBirth=datetime.date(2002,4,16)#创建日期对象，日期为2002年4月16日
print(dtBirth.weekday())#2,输出dtBirth对应的日期是星期几，0表示星期一
dtNow=datetime.date.today()#取今天日期
print(dtNow&gt;dtBirth)#True,日期可以比大小
life=dtNow-dtBirth#取两个日期的时间差
print(life.days,life.total_seconds())#输出天数以及对应的秒数
delta=datetime.timedelta(days=-10)#构建时间差对象，时间差为-10天
newDate=dtNow+delta#新日期为当前时间往前推十天
print(newDate.year,newDate.month,newDate.day)#输出年月日
print(newDate.strftime(r'%m/%d/%Y'))#strftime用于控制输出格式，%m输出两位的月，%d输出两位的日，%Y输出四位的年,输出字符串
newDate=datetime.datetime.strptime(&quot;2022.1.24&quot;,&quot;%Y.%m.%d&quot;)#将字符串转为日期对象
print(newDate.strftime(&quot;%Y %m %d&quot;))#将日期对象转为字符串
</code></pre>
<p>处理时刻：</p>
<pre><code class="language-python">import datetime
tm=datetime.datetime.now()#取当前时刻精确到微秒
print(tm.year,tm.month,tm.day,tm.hour,tm.minute,tm.second,tm.microsecond)#输出当前时刻
tm=datetime.datetime(2022,1,24,19,23,10,0)#构建时刻对象，时刻为2022年1月24日19时23分10秒0微妙
print(tm.strftime(&quot;%Y%m%d: %H:%M:%S&quot;))#20220124: 19:23:10,strftime也可以将时刻转为字符串
print(tm.strftime(&quot;%Y%m%d: %I:%M:%S %p&quot;))#20220124: 07:23:10 PM,也可以按照12小时制输出，%p用于输出AM/PM
tm2=datetime.datetime.strptime(&quot;2002.01.24 07:23:10&quot;,&quot;%Y.%m.%d %H:%M:%S&quot;)#由字符串生成一个时间对象
delta=tm-tm2#求两个时间的时间差，delta即为一个时间差对象
print(delta.days,delta.seconds,delta.total_seconds())#7305 43200 631195200.0
#时间差是7305天零43200秒，总计631195200秒  
</code></pre>
<h4 id="2用random库处理随机事务">2.用random库处理随机事务</h4>
<pre><code class="language-python">import random
print(random.random())#0.6122495917345335，生成一个介于0和1之间的随机数
print(random.uniform(1.2,7.8))#6.9827624080681465,生成一个在[1.2,7.8]之间的随机数
print(random.randint(-20,70))#-13，生成一个在[-20,70]间的随机整数
print(random.randrange(2,20,3))#11,按步长为3生成一个[2,20)间的随机整数
print(random.choice([1,2,3,'Jack','Mike',4,5]))#4,在列表中随机抽取一个元素
lst=[1,2,3,4,5]
random.shuffle(lst)#随机排列lst
print(lst)#[3, 1, 2, 5, 4]
print(random.sample(lst,3))#[4,2,3],从lst中随机取出三个元素
</code></pre>
<p>设置随机数种子：如果没有设置则是按照系统时间作为随机数种子，随机数种子设定后每次随机结果都是唯一的</p>
<pre><code class="language-python">import random
random.seed(2)#设置随机数种子为2，随机数种子可以任意，既可以为数字也可以为字符串等
print(random.randint(1,100))#8,每次随机结果都为8
</code></pre>
<p>random库应用实例：</p>
<pre><code class="language-python">#实现四人玩牌的发牌模拟
import random
cards=[str(i) for i in range(2,11)]
cards.extend(list(&quot;JQKA&quot;))#设置好牌列表
allCards=[]#一副牌
for s in &quot;♠♣♥♦&quot;:
    for c in cards:
        allCards.append(s+c)#将52张牌放入整副牌中
random.shuffle(allCards)#随机打乱整副牌
for i in range(4):
    onePlayer=allCards[i::4]#每个玩家每隔三张取一张牌
    onePlayer.sort()#按照花色对牌进行排序
    print(onePlayer)
#输出示例：
# ['♠3', '♠6', '♠8', '♣4', '♣6', '♣7', '♥2', '♥6', '♥A', '♥K', '♦10', '♦A', '♦Q']
# ['♠10', '♠5', '♠7', '♠J', '♣2', '♣9', '♥3', '♥4', '♥8', '♥9', '♦2', '♦8', '♦9']
# ['♠4', '♠9', '♠A', '♣10', '♣3', '♣5', '♣K', '♣Q', '♥5', '♥7', '♥Q', '♦6', '♦K']
# ['♠2', '♠K', '♠Q', '♣8', '♣A', '♣J', '♥10', '♥J', '♦3', '♦4', '♦5', '♦7', '♦J']
</code></pre>
<h4 id="3用jieba库进行分词和中文词频统计">3.用jieba库进行分词和中文词频统计</h4>
<pre><code class="language-python">import jieba#导入分词库
jieba.setLogLevel(jieba.logging.INFO)#避免jieba库报错
s=&quot;我们热爱中华人民共和国&quot;
lst=jieba.lcut(s)#对s进行分词并转成一个列表，默认用精确模式分词，分词的结果正好可以拼成原文
print(lst)#['我们', '热爱', '中华人民共和国']
lst=jieba.lcut(s,cut_all=True)#全模式分词，输出所有可能的词
print(lst)#['我们', '热爱', '中华', '中华人民', '中华人民共和国', '华人', '人民', '人民共和国', '共和', '共和国']
lst=jieba.lcut_for_search(s)#搜索引擎模式分词，会对一些比较长的词进行细分
print(lst)#['我们', '热爱', '中华', '华人', '人民', '共和', '共和国', '中华人民共和国']
s=&quot;拼多多是个网站&quot;
lst=jieba.lcut(s)#在jieba库中并未收录&quot;拼多多&quot;这个词，所以会拆分开
print(lst)#['拼', '多多', '是', '个', '网站']
jieba.add_word(&quot;拼多多&quot;)#向字典中加入拼多多这个词
lst=jieba.lcut(s)
print(lst)#['拼多多', '是', '个', '网站']
</code></pre>
<p>不仅可以将一个词加入jieba的字典，也可以将一个文件中的词加入jieba的字典</p>
<pre><code class="language-python">import jieba#导入分词库
jieba.setLogLevel(jieba.logging.INFO)#避免jieba库报错
s=&quot;关山口男子职业技术学院和五道口职业技术学院&quot;
print(jieba.lcut(s))#['关山', '口', '男子', '职业', '技术', '学院', '和', '五道口', '职业', '技术', '学院']
jieba.load_userdict(&quot;F:/tmp/test1.txt&quot;)#文件的内容为：关山口男子职业技术学院 五道口职业技术学院
print(jieba.lcut(s))#['关山口男子职业技术学院', '和', '五道口职业技术学院']
</code></pre>
<h4 id="4用openpyxl库处理excel文档">4.用openpyxl库处理excel文档</h4>
<h5 id="1用openpyxl库读取excel文档">（1）用openpyxl库读取excel文档</h5>
<pre><code class="language-python">import openpyxl as pxl#以下代码用pxl代替openpyxl
book=pxl.load_workbook(&quot;F:/tmp/book.xlsx&quot;)#打开excel文档
sheet=book.worksheets[0]#取第0张工作表,也可以写成sheet=book.active#取活跃的工作表，缺省的就是第0张工作表
#worksheets是工作表构成的列表
print(sheet.title)#打印工作表名称
print(sheet.min_row,sheet.max_row)#输出工作表的最小有效行号和最大有效行号
print(sheet.min_column,sheet.max_column)#输出工作表的最小有效列号和最大有效列号
for row in sheet.rows:#按行遍历整个工作表，从第1行到第sheet.max_row行
    for cell in row:#遍历一行的每个单元格
        print(cell.value)#cell.value是单元格的值，空单元格的值是None
for cell in sheet['B']:#遍历名为'B'的那一列
    print(cell.value)
for cell in sheet[3]:#遍历第三行
    print(cell.value,type(cell.value),cell.coordinate,cell.col_idx,cell.number_format)
#type()返回单元格值的类型；cell.coordinate是单元格的坐标，是一个字符串；cell.col_idx是单元格列号，是一个整数，从1开始算
#cell.number_format是单元格数据的显示格式，通常为&quot;General&quot;
</code></pre>
<pre><code class="language-python">import openpyxl as pxl#以下代码用pxl代替openpyxl
book=pxl.load_workbook(&quot;F:/tmp/book.xlsx&quot;)
sheet=book.worksheets[0]
print(pxl.utils.get_column_letter(5))#E,根据列号求列名
print(pxl.utils.column_index_from_string('D'))#4,根据列名求列号
print(pxl.utils.column_index_from_string('AC'))#29
colRange=sheet['C:F']#取sheet的第C列到第F列，包含F列
for col in colRange:#遍历C-F列
    for cell in col:
        print(cell.value)
rowRange=sheet[2:9]#取sheet的第2行到第9行，包含第9行
for row in rowRange:#遍历2-9行
    for cell in row:
        print(cell.value)
print(sheet['C9'].value)#输出'C9'单元格的值
print(sheet.cell(row=8,column=4).value)#输出第8行第4列的单元格的值
</code></pre>
<p>有时候单元格中的内容是公式，希望打开文档的时候自动计算公式的值，则可进行如下操作：</p>
<pre><code class="language-python">import openpyxl as pxl
book=pxl.pxl.load_workbook(&quot;F:/tmp/book.xlsx&quot;,data_only=True)#data_only=True使得公式的值自动计算
</code></pre>
<h5 id="2用openpyxl库创建excel文档">（2）用openpyxl库创建excel文档</h5>
<pre><code class="language-python">import openpyxl
import datetime
book=openpyxl.Workbook()#在内存中创建一个Excel文档，但是还未存到硬盘中，注意W为大写
sheet=book.active#取第0张工作表
sheet.title=&quot;sample1&quot;#工作表取名为sample1
dataRows=((10,20,30,40),(100,200,'=sum(A1:B2)'),[],['1000',datetime.datetime.now(),'OK'])
#准备添加进excel文档的数据信息,'=sum(A1:B2)'为求和公式,注意1000是字符串形式，在excel文档中对应的单元格左上角会有绿色小三角
for row in dataRows:
    sheet.append(row)#在工作表中添加一行，要求row是一个列表或元组
sheet.column_dimensions['B'].width=len(str(sheet['B4'].value))
#datetime.datetime.now()为一个较长的字符串，为了保证正常显示，则需要设置好B列的宽度
sheet.row_dimensions[2].height=48#设置第二行高度为48 points
sheet['E1'].value='=sum(A1:D1)'#将E1单元格的值设置为公式
sheet['E2'].value=0.125
sheet['E2'].number_format=&quot;0.00%&quot;#设置单元格显示格式为百分比形式
sheet2=book.create_sheet(&quot;sample0&quot;,0)#添加一个名为sample0的工作表，且将之设为第0张工作表，原来的第0张工作表变为第1张
sheet3=book.copy_worksheet(sheet)#在最右侧添加一张新的工作表，其为sheet的拷贝
book.remove_sheet(book[&quot;sample0&quot;])#删除名为sample0的工作表
book.save(&quot;F:/tmp/sample.xlsx&quot;)#保存文件
</code></pre>
<h5 id="3用openpyxl库设定excel文档单元格样式">（3）用openpyxl库设定excel文档单元格样式</h5>
<pre><code class="language-python">import openpyxl
from openpyxl.styles import Font,colors,PatternFill,Alignment,Side,Border#引入openpyxl.styles中的一些包
book=openpyxl.Workbook()#在内存中创建一个Excel文档，但是还未存到硬盘中，注意W为大写
sheet=book.active#取第0张工作表
for i in range(4):
    sheet.append([i*5+j for j in range(5)])
side=Side(style=&quot;thin&quot;)#边线类型，还可以是thick，medium，dotted等
border=Border(left=side,right=side,top=side,bottom=side)#边框类型
for row in sheet.rows:
    for cell in row:
        cell.border=border
sheet['A1'].fill=PatternFill(patterntype='solid',start_color=colors.GREEN)
#单元格的fill代表填充样式，solid代表背景纯色填充，单元格底色设置为绿色
a1=sheet['A1']
italicRedFont=Font(size=18,name='Times New Roman',bold=True,color=colors.RED)
#创建一个Font对象,字体大小为18，字体为Times New Roman，bold代表是否为粗体，color代表字体颜色
a1.font=italicRedFont#设置单元格的字体
sheet['A2'].font=a1.font.copy(italic=True)#将A2单元格的格式设置为和A1一样，但是字体是斜体，italic代表斜体
sheet.merge_cells('C2:D3')#从C2到D3合并为一个单元格，此后该单元格名为C2
sheet['C2'].alignment=Alignment(horizontal='left',vertical='center')
#horizontal代表水平对齐格式，vertical代表垂直对齐格式，将C2设置为水平左对齐和垂直居中
book.save(&quot;F:/tmp/style.xlsx&quot;)
</code></pre>
<h4 id="4用pillow处理图像">4.用Pillow处理图像</h4>
<h5 id="1图像基本常识">（1）图像基本常识：</h5>
<p>图像由像素构成：屏幕上每个像素点由三个距离非常近的点构成，分别显示红绿蓝三种颜色，每个像素可以由一个元组表示(r,g,b)，     r，g，b通常是不大于255的整数，分别表示红绿蓝三原色的深浅程度</p>
<p>图像模式：</p>
<p>①RGB：一个像素有红绿蓝三个分量</p>
<p>②RGBA：一个像素有红绿蓝三个分量以及透明分量</p>
<p>③CYMK：一个像素有青色（Cyan），洋红色（Magenta），黄色（Yellow），黑色（K代表黑）四个分量构成，每个像素用元组(c,y,m,k)表示，对应于彩色打印机或者印刷机的四种颜色墨水</p>
<p>L：黑白图像，像素就是一个整数，代表灰度</p>
<h5 id="2图像的基本操作">（2）图像的基本操作：</h5>
<p>①图像的缩放：</p>
<pre><code class="language-python">from PIL import Image#导入Image类进行图像处理
img=Image.open(&quot;F:/tmp/HUST.jpg&quot;)#将图像文件载入对象img
w,h=img.size#获取图像的宽和高，单位为像素，img.size是一个元组
print(w,h)
newSize=(w//2,h//2)#生成一个新的图像尺寸，//为了保留整数
newImg=img.resize(newSize)#得到一张原图像一半大小（1/4）的新图像，resize返回一张新图像
newImg.save(&quot;F:/tmp/half_HUST.jpg&quot;)#保存新图像文件
newImg.thumbnail((128,128))#变成宽高各128像素的缩略图
newImg.save(&quot;F:/tmp/128_HUST.png&quot;,&quot;PNG&quot;)#保存新图像为png文件
newImg.show()#显示图像文件
</code></pre>
<p>②图像的旋转、翻转和滤镜效果：</p>
<pre><code class="language-python">from PIL import Image#导入Image类进行图像处理
from PIL import ImageFilter#导入ImageFilter实现滤镜效果
img=Image.open(&quot;F:/tmp/HUST.jpg&quot;)#将图像文件载入对象img
print(img.format,img.mode)#JPEG RGB，format为图像的格式，mode为图像的模式
newImg=img.rotate(90,expand=True)#图像逆时针旋转90°，expand=True说明图像的长宽跟随旋转变化
newImg.show()
newImg=img.transpose(Image.FLIP_LEFT_RIGHT)#左右翻转
newImg.show()
newImg=img.transpose(Image.FLIP_TOP_BOTTOM)#上下翻转
newImg.show()
newImg=img.filter(ImageFilter.BLUR)#模糊效果
newImg.show()
#ImageFilter.CONTOUR，轮廓效果
#ImageFilter.EDGE_ENHANCE，边缘增强
#ImageFilter.EMBOSS，浮雕
#ImageFilter.SMOOTH，平滑
#ImageFilter.SHARPEN，锐化
</code></pre>
<p>③图像的裁剪：</p>
<pre><code class="language-python">#以裁剪九宫格图像为例,先将图片拆分成九张图，再将九张图组合成一张九宫图
from PIL import Image#导入Image类进行图像处理
img=Image.open(&quot;F:/tmp/HUST.jpg&quot;)#将图像文件载入对象img
w,h=img.size[0]//3,img.size[1]//3#获取九宫格图片宽与高
gap=10#九宫图中相邻两幅子图间的空白宽10像素
newImg=Image.new(&quot;RGB&quot;,(w*3+gap*2,h*3+gap*2),&quot;white&quot;)
#生成一幅新的图，图片模式为RGB，设置好宽高为对应九宫图宽高，新图的底色为白色
for i in range(3):
    for j in range(3):
        clipImg=img.crop((j*w,i*h,(j+1)*w,(i+1)*h))#crop用于进行图片的切割，4个元素对应所要切割部分左上角和右下角的坐标
        newImg.paste(clipImg,(j*(w+gap),i*(h+gap)))#将clipImg粘贴到newImg上，坐标为粘贴左上角的坐标
newImg.save(&quot;F:/tmp/HUST_9.jpg&quot;)
newImg.show()
</code></pre>
<p>④图像素描化：</p>
<pre><code class="language-python">from PIL import Image#导入Image类进行图像处理
def makeSketch(img,threshold):
#进行图像img素描化处理，threshold为阈值，当黑白图片相邻两个像素的灰度差值超过阈值，则认为此处为轮廓
    w,h=img.size
    img=img.convert('L')#图像转换成灰度模式，convert用于转换图像的模式
    pix=img.load()#获取像素矩阵
    for x in range(w-1):#遍历像素矩阵
        for y in range(h-1):
            if abs(pix[x,y]-pix[x+1,y+1])&gt;=threshold:#取一个像素和它右下角像素点作为相邻
                pix[x,y]=0#变为黑色
            else:
                pix[x,y]=255#变为白色
    return img
img=Image.open(&quot;F:/tmp/HUST.jpg&quot;)#将图像文件载入对象img
img=makeSketch(img,15)#取15作为阈值
img.show()
</code></pre>
<p>⑤为图像添加水印：</p>
<p>原理：在将一个图像粘贴到另一个图像上时，会用到paste函数，paste函数还有一个参数mask称为“掩膜”指定img的每个像素粘贴过去的透明度，如果透明度为0则完全透明，如果透明度为255则完全遮盖原图像的像素</p>
<p>mask本质上是一个模式为“L”的图片即一个Image对象</p>
<pre><code class="language-python">from PIL import Image#导入Image类进行图像处理
def getMask(img,isTransparent,alpha):
    #返回由img变出来的掩膜
    #isTransparent为一个函数用来指明img中什么样的像素应该是完全透明的，alpha为透明度，指明不为完全透明的像素的透明度
    if img.mode!=&quot;RGBA&quot;:
        img=img.convert(&quot;RGBA&quot;)#将图像模式转为RGBA
    w,h=img.size
    pixels=img.load()#获取像素矩阵
    for x in range(w):
        for y in range(h):
            p=pixels[x,y]#p是一个四元组(r,g,b,a)
            if isTransparent(p[0],p[1],p[2]):#判断p是否应变成透明像素，三个参数对应像素点的红绿蓝分量
                pixels[x,y]=(p[0],p[1],p[2],0)
            else:
                pixels[x,y]=(p[0],p[1],p[2],alpha)
    r,g,b,a=img.split()#分理出img中的四个分量，a就是掩膜
    return a
img=Image.open(&quot;F:/tmp/logo.png&quot;)#将图像文件载入对象img,水印图像
img=img.resize((img.size[0]*10,img.size[1]*10))#适当扩大图像
msk=getMask(img,lambda r,g,b:r&gt;245 and g&gt;245 and b&gt;245,130)#白色点的r，g，b都为255
imgSrc=Image.open(&quot;F:/tmp/HUST.jpg&quot;)#将图像文件载入对象imgSrc,目标图像
imgSrc.paste(img,(imgSrc.size[0]-img.size[0]-30,imgSrc.size[1]-img.size[1]-30),mask=msk)
#粘贴透明图像img到imgSrc的合适位置
imgSrc.show()
</code></pre>
<h3 id="十一数据分析和展示">十一.数据分析和展示</h3>
<h4 id="1numpy库的使用">1.numpy库的使用</h4>
<p>numpy是一个多维数组库，创建多维数组很方便，可以代替多维列表，速度比多维列表快，支持向量和矩阵的各种数学运算，所有元素类型必须相同</p>
<h5 id="1用numpy库创建数组">（1）用numpy库创建数组</h5>
<pre><code class="language-python">import numpy as np#以下np即为numpy
print(np.array([1,2,3]))#[1 2 3],以列表[1,2,3]创建数组
print(np.arange(1,9,2))#[1 3 5 7],在区间[1,9)中从1开始以步长为2创建一个数组
print(np.linspace(1,10,4))
#[ 1.  4.  7. 10.]，在区间[1,10]以步长为4取数，即对[1,10]三等分，取等分点和1，10构成数组，注意取出的数都为小数
print(np.random.randint(10,20,[2,3]))#从[10,20)中随机取整数，构成2行3列的二维数组
#[[19 15 11]
# [13 17 10]]
print(np.random.randint(10,20,5))#[15 16 16 14 15]，从[10,20)中随机取整数，构成5个元素的一维数组
a=np.zeros(3)#创建一个包含三个小数0的数组
print(a)#[0. 0. 0.]
print(list(a))#[0.0, 0.0, 0.0]
a=np.zeros((2,3),dtype=int)#创建一个2行3列，元素都是整数0的数组
print(a)
#[[0 0 0]
# [0 0 0]]
</code></pre>
<h5 id="2numpy常用的属性与函数">（2）numpy常用的属性与函数</h5>
<pre><code class="language-python">import numpy as np
b=np.array([i for i in range(12)])
#b是[ 0  1  2  3  4  5  6  7  8  9 10 11]
a=b.reshape((3,4))#将数组转成3行4列的数组赋给a，b不变
#[[ 0  1  2  3]
# [ 4  5  6  7]
# [ 8  9 10 11]]
print(len(a))#3,a有3行
print(a.size)#12,输出a中的元素个数
print(a.ndim)#2,输出a是几维数组
print(a.shape)#(3,4),输出a是几行几列的，输出一个元组
print(a.dtype)#int32,输出a中的元素类型是32bit的整数
L=a.tolist()#转换成列表，a不变
print(L)#[[0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11]]
L=list(a)#最外层维转换成列表，如果是多维数组则内部仍为数组
print(L)#[array([0, 1, 2, 3]), array([4, 5, 6, 7]), array([ 8,  9, 10, 11])]
b=a.flatten()#转换成一维数组
print(b)#[ 0  1  2  3  4  5  6  7  8  9 10 11]
</code></pre>
<h5 id="3numpy数组元素增删">（3）numpy数组元素增删</h5>
<p>numpy数组一旦生成，则不能增删元素，此处的增删指的是增删之后生成一个新数组，原数组保持不变</p>
<p>numpy增添数组元素：</p>
<pre><code class="language-python">import numpy as np
a=np.array((1,2,3))#a为数组[1 2 3]
b=np.append(a,10)#向a中插入10得到新数组赋给b，a不变
#append(x,y)即将y中元素插入到数组x中去
print(a,b)#[1 2 3] [ 1  2  3 10]
c=np.zeros((2,3),dtype=int)#c为2行3列的元素都为整数0的二维数组
print(np.append(a,c))#[1 2 3 0 0 0 0 0 0]
print(np.concatenate((a,[10,20],a)))#[ 1  2  3 10 20  1  2  3]
#concatenate将元组中元素连接起来得到一个新的数组，原数组不变
d=np.concatenate((c,np.array([[10,20,30]])))#c拼接1行得到新数组
print(d)
#[[ 0  0  0]
# [ 0  0  0]
# [10 20 30]]
e=np.concatenate((c,np.array([[1,2],[10,20]])),axis=1)#c第一行拼接[1,2]，第二行拼接[10,20]得到新数组
#axis指明拼接发生在行上面还是发生在列上面，axis缺省为0，拼接发生在行上面，axis=1时拼接发生在列上面
print(e)
#[[ 0  0  0  1  2]
# [ 0  0  0 10 20]]
</code></pre>
<p>numpy删除数组元素：</p>
<pre><code class="language-python">import numpy as np
a=np.array((1,2,3,4))
b=np.delete(a,1)#删除a中下标为1的元素得到新数组
print(a,b)#[1 2 3 4] [1 3 4]
b=np.array([i for i in range(12)]).reshape((3,4))
c=np.delete(b,1,axis=0)#删除b的第一行得到新数组
print(c)
#[[ 0  1  2  3]
# [ 8  9 10 11]]
d=np.delete(b,1,axis=1)#删除b的第一列得到新数组
print(d)
#[[ 0  2  3]
# [ 4  6  7]
# [ 8 10 11]]
e=np.delete(b,[0,1],axis=0)#删除b的第0行和第1行得到新数组
print(e)
#[[ 8  9 10 11]]
</code></pre>
<h5 id="4在numpy数组中查找元素">（4）在numpy数组中查找元素</h5>
<pre><code class="language-python">import numpy as np
a=np.array((1,2,3,5,3,4))
pos=np.argwhere(a==3)#在pos中查找元素3，返回值为一个数组，数组中存储着查找到的元素下标
print(pos)
#[[2]
# [4]]
a=np.array([[1,2,3],[4,5,2]])
print(2 in a)#True
pos=np.argwhere(a==2)#pos为一个二维数组，存储着2的坐标[行号,列号]
print(pos)
#[[0 1]
# [1 2]]
b=a[a&gt;2]#抽取a中大于2的元素构成一个一维数组
print(b)#[3 4 5]
a[a&gt;2]=-1#使a中大于2的元素值变为-1
print(a)
#[[ 1  2 -1]
# [-1 -1  2]]
</code></pre>
<h5 id="5numpy数组的数学运算">（5）numpy数组的数学运算</h5>
<pre><code class="language-python">import numpy as np
a=np.array((1,2,3,4))
b=a+1#得到一个新数组，该数组中每个元素都是a中的元素+1
print(b)#[2 3 4 5]
print(a*b)#[2 6 12 20],a,b中对应元素相乘
print(a+b)#[3 5 7 9],a,b中对应元素相加
c=np.sqrt(a*10)#a*10是[10 20 30 40],将其每个元素开方后赋给新数组c
print(c)#[3.16227766 4.47213595 5.47722558 6.32455532]
</code></pre>
<h5 id="6numpy数组的切片">（6）numpy数组的切片</h5>
<p>不同于列表的切片，numpy数组的切片是“视图”，即为原数组的一部分，而非原数组一部分的拷贝，切片改变原数组也改变</p>
<pre><code class="language-python">import numpy as np
a=np.arange(8)#[0 1 2 3 4 5 6 7]
b=a[3:6]#b是a的一部分
print(b)#[3 4 5]
c=np.copy(a[3:6])#c是a一部分的拷贝
b[0]=100
print(a)#[  0   1   2 100   4   5   6   7]
print(c)#[3 4 5]
a=np.array([i for i in range(1,17)]).reshape((4,4))
b=a[1:3,1:4]#行从第1行取到第2行，列从第1列取到第3列
print(b)
#[[ 6  7  8]
# [10 11 12]]
</code></pre>
<h4 id="2数据分析库pandas">2.数据分析库pandas</h4>
<p>pandas的核心功能是在二维表格上做各种操作，需要numpy库的支持，在openpyxl库的支持下还可以读取excel文档</p>
<p>pandas中最为关键的类是DataFrame，用于表示二维表格</p>
<h5 id="1pandas的重要类series">（1）pandas的重要类Series</h5>
<p>Series为一维表格，每个元素带有标签与下标，类似于列表和字典的结合</p>
<pre><code class="language-python">import pandas as pd
s=pd.Series(data=[80,90,100],index=['语文','数学','英语'])
#创建一个一维表格，data为表格中的数据，index为每一个表格的标签
for x in s:
    print(x,end=&quot; &quot;)#80 90 100,输出表格中的元素
print(&quot;&quot;)
print(s['语文'],s[1])#80,90，可以用标签和下标进行访问
print(s[0:2]['数学'])#90，切片与列表等切片规则相同，但是注意Series切片也是视图！！！！
print(s['数学':'英语'][1])#100，当用标签做切片时，终点是算在内的
for i in range(len(s.index)):
    print(s.index[i],end=&quot; &quot;)#语文 数学 英语
s['体育']=110#与字典相同，在表格末尾添加体育项
s.pop('数学')#与字典相同，删除数学项
s2=s.append(pd.Series(120,index=['政治']))#append不会改变s而是会创建一个新的一维表格，它的功能不是添加而是连接
print(list(s2))#[80,100,110,120]
print(list(s))#[80,100,110]
print(s.sum(),s.min(),s.max(),s.mean(),s.median())
#290 80 110 96.66666666666667 100.0，输出和，最小值，最大值，平均数，中位数
print(s.idxmax(),s.argmax())#'体育',2,输出最大元素的标签与下标
</code></pre>
<h5 id="2dataframe的构造和访问">（2）DataFrame的构造和访问</h5>
<p>DataFrame是带行列标签的二维表格，它的每一行都是一个Series</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
scores=[['男',108,115,97],['女',115,87,105],['女',100,60,130],['男',112,80,50]]#表格信息
name=['刘一哥','王二姐','张三妹','李四弟']#标签信息
courses=['性别','语文','数学','英语']#列信息
df=pd.DataFrame(data=scores,index=name,columns=courses)#构建二维表格
print(df)
#         性别  语文  数学  英语
# 刘一哥   男   108   115    97
# 王二姐   女   115    87   105
# 张三妹   女   100    60   130
# 李四弟   男   112    80    50
print(df.values[0][1],type(df.values))#108 &lt;class 'numpy.ndarray'&gt;,values部分其实是一个numpy数组
print(list(df.index))#['刘一哥', '王二姐', '张三妹', '李四弟']
print(list(df.columns))#['性别', '语文', '数学', '英语']
print(df.index[2],df.columns[2])#'张三妹' '数学'
s1=df['语文']#s1是一个Series，代表'语文'那一列
print(s1['刘一哥'],s1[0])#108 108
print(df['语文']['刘一哥'])#108,注意访问时一定要保证列索引先写
s2=df.loc['王二姐']#s2是一个Series，代表'王二姐'那一行，注意取行需要加loc
#注意s1和s2都是视图，改变s1和s2，df也会跟着改变
print(list(s2))#['女', 115, 87, 105]
</code></pre>
<h5 id="3dataframe的切片-增删和统计">（3）DataFrame的切片、增删和统计</h5>
<p>①DataFrame的切片：</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
scores=[['男',108,115,97],['女',115,87,105],['女',100,60,130],['男',112,80,50]]#表格信息
name=['刘一哥','王二姐','张三妹','李四弟']#标签信息
courses=['性别','语文','数学','英语']#列信息
df=pd.DataFrame(data=scores,index=name,columns=courses)#构建二维表格
print(df)
#         性别  语文  数学  英语
# 刘一哥   男   108   115    97
# 王二姐   女   115    87   105
# 张三妹   女   100    60   130
# 李四弟   男   112    80    50

df2=df.iloc[1:3]#iloc为用下标做切片，取1，2两行，没有写列选择器说明所有的列都要取
df2=df.loc['王二姐':'张三妹','性别':'英语']#loc为用标签做切片，取1，2两行，取'性别'列到'英语'列
print(df2)
#       性别  语文  数学  英语
#王二姐   女   115    87   105
#张三妹   女   100    60   130

df3=df.iloc[[1,3],[1,3]]#取1，3行，1，3列
df3=df.loc[['王二姐','李四弟'],['语文','英语']]#取1，3行，1，3列
print(df3)
#        语文  英语
#王二姐   115   105
#李四弟   112    50
</code></pre>
<p>②DataFrame的分析统计：</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
scores=[['男',108,115,97],['女',115,87,105],['女',100,60,130],['男',112,80,50]]#表格信息
name=['刘一哥','王二姐','张三妹','李四弟']#标签信息
courses=['性别','语文','数学','英语']#列信息
df=pd.DataFrame(data=scores,index=name,columns=courses)#构建二维表格
print(df)
#         性别  语文  数学  英语
# 刘一哥   男   108   115    97
# 王二姐   女   115    87   105
# 张三妹   女   100    60   130
# 李四弟   男   112    80    50

print(df.T)#df.T是df的转置矩阵 
print(df.sort_values('语文',ascending=False))#按语文成绩降序排列，返回一个新的DataFrame，对行进行了重排
#注意sort_values(...inplace=True,axis=1)inplace说明进行原地排序，会改变df，axis=1说明对列进行重排
#性别  语文  数学  英语
#王二姐   女   115    87   105
#李四弟   男   112    80    50
#刘一哥   男   108   115    97
#张三妹   女   100    60   130
print(df.sum()['语文'],df.mean()['数学'],df.median()['英语'],df.min()['语文'])#默认为求列的相应值
#435 85.5 101.0 100语文成绩和，数学平均分，英语中位数，语文最低分
print(df.max(axis=1)['王二姐'])#115,axis=1说明进行列检索，求王二姐的最高分
print(df['语文'].idxmax())#'王二姐',输出语文最高分所在行的标签
print(df['数学'].argmin())#'2',输出数学最低分所在行的行号
print(df.loc[(df['语文']&gt;100)&amp;(df['数学']&gt;=85)])#求切片，行选择器为语文大于100，数学大于85
</code></pre>
<p>③DataFrame的修改和增删：</p>
<p>修改和增加：</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
scores=[['男',108,115,97],['女',115,87,105],['女',100,60,130],['男',112,80,50]]#表格信息
name=['刘一哥','王二姐','张三妹','李四弟']#标签信息
courses=['性别','语文','数学','英语']#列信息
df=pd.DataFrame(data=scores,index=name,columns=courses)#构建二维表格
print(df)
#         性别  语文  数学  英语
# 刘一哥   男   108   115    97
# 王二姐   女   115    87   105
# 张三妹   女   100    60   130
# 李四弟   男   112    80    50

df.loc['王二姐','英语']=df.iloc[0,1]=150
#修改王二姐的英语和刘一哥的语文成绩为150
df['物理']=[80,70,90,100]#增添物理列为最后一列
df.insert(1,'体育',[89,77,76,45])#为所有人插入体育成绩到第一列
df.loc['钱五叔']=['男',100,100,100,100,100]#增添钱五叔行到最后一行
df.loc[:,'英语']+=10#为所有人英语加10分，等价于df['英语']+=10
df.columns=['性别','体育','语文','数学','English','物理']#修改列标签
#df.columns[4]='English'#错误，不可单独修改
print(df)
#       性别  体育  语文  数学  English  物理
#刘一哥   男    89   150   115      107    80
#王二姐   女    77   115    87      160    70
#张三妹   女    76   100    60      140    90
#李四弟   男    45   112    80       60   100
#钱五叔   男   100   100   100      110   100
</code></pre>
<p>删除：</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
scores=[['男',108,115,97],['女',115,87,105],['女',100,60,130],['男',112,80,50]]#表格信息
name=['刘一哥','王二姐','张三妹','李四弟']#标签信息
courses=['性别','语文','数学','英语']#列信息
df=pd.DataFrame(data=scores,index=name,columns=courses)#构建二维表格
print(df)
#         性别  语文  数学  英语
# 刘一哥   男   108   115    97
# 王二姐   女   115    87   105
# 张三妹   女   100    60   130
# 李四弟   男   112    80    50

df.drop(['英语'],axis=1,inplace=True)#只删除一列时，可以不加[]
#删除英语那一列，axis=1说明删除列，inplace=True说明在df本身进行修改而不产生新的DataFrame
df.drop('王二姐',axis=0,inplace=True)#删除王二姐那一行
df.drop([df.index[i] for i in range(2)],axis=0,inplace=True)#删除0，1行
print(df)
#性别  语文  数学
#李四弟   男   112    80
</code></pre>
<h5 id="4用pandas库读取excel和csv文档">（4）用pandas库读取excel和csv文档</h5>
<p>需要依赖于openpyxl库</p>
<p>①用pandas读excel文档：读取的每张工作表都是一个DataFrame</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
dt=pd.read_excel(&quot;F:/tmp/book.xlsx&quot;,sheet_name=['sheet1',1],index_col=0)
#sheet_name为表名，[]中的是需要读取的表，既可以用表名读取如'sheet1'，也可以用表的编号读取如1，index_col来说明用哪一列作为标签，index_col=0说明取第0列作为标签
#函数返回值是一个字典，字典元素的键是表名，值是DataFrame
df=dt['sheet1']#dt是字典，df是Dataframe
print(df.iloc[0,0],df.loc[14,'课程名称'],df['课程名称'][15])#Verilog语言 Verilog语言 机器学习
#三种访问DataFrame单元格的方式
print(df)#空单元格显示NaN
print(pd.isnull(df.iloc[0,0]))#False,isnull用于判断某个单元格是不是空
df.fillna(0,inplace=True)#将NaN替换成0，fillna用于将NaN替换成其他的值，inplace=True说明在df本身进行修改
</code></pre>
<p>②用pandas写excel文档</p>
<pre><code class="language-python">import pandas as pd
pd.set_option('display.unicode.east_asian_width',True)#输出对齐方面的设置
scores=[['男',108,115,97],['女',115,87,105],['女',100,60,130],['男',112,80,50]]#表格信息
name=['刘一哥','王二姐','张三妹','李四弟']#标签信息
courses=['性别','语文','数学','英语']#列信息
df=pd.DataFrame(data=scores,index=name,columns=courses)#构建二维表格
print(df)
#         性别  语文  数学  英语
# 刘一哥   男   108   115    97
# 王二姐   女   115    87   105
# 张三妹   女   100    60   130
# 李四弟   男   112    80    50

writer=pd.ExcelWriter(&quot;F:/tmp/new.xlsx&quot;)#创建ExcelWriter对象
df.to_excel(writer,sheet_name=&quot;S1&quot;)#将df写入excel
df['语文'].to_excel(writer,sheet_name=&quot;S2&quot;)#只写入一列
writer.save()#保存excel文档
</code></pre>
<h4 id="3用matplotlib进行数据展示">3.用matplotlib进行数据展示</h4>
<p>在此感慨：清华镜像源yyds！！！</p>
<h5 id="1绘制直方图">（1）绘制直方图</h5>
<pre><code class="language-python">import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
from matplotlib import rcParams
rcParams['font.family']=rcParams['font.sans-serif']='SimHei'
#设置中文支持，中文字体为简体黑体，当不需要中文时则不需要这两行
ax=plt.figure().add_subplot()#建图，获取子图对象ax
#plt.figure()创建了一个窗口对象，add_subplot()在窗口对象上创建一个子图对象
ax.bar(x=(0.2,0.6,0.8,1.2),height=(1,2,3,0.5),width=0.1)
#bar用于绘制直方图,x为柱子的横坐标,height为柱子高度，width表示柱子宽度
#一般来说x，height等参量可以为元组也可以为列表
#画横向直方图时，调用barh并且将参数中的x改为y
ax.set_title('我的直方图')#设置直方图的名称
plt.show()#显示直方图
</code></pre>
<h5 id="2绘制堆叠直方图">（2）绘制堆叠直方图</h5>
<pre><code class="language-python">import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
ax=plt.figure().add_subplot()#建图，获取子图对象ax
labels=['Jan','Feb','Mar','Apr']#横坐标
num1=[20,30,15,35]#Dept1的数据
num2=[15,30,40,20]#Dept2的数据
cordx=range(len(num1))#x轴刻度位置
ax.bar(x=cordx,height=num1,width=0.5,color='red',label='Dept1')#绘制第一个直方图
#color可以设置直方图的颜色，label用于指明直方图的标签
ax.bar(x=cordx,height=num2,width=0.5,color='green',label='Dept2',bottom=num1)#绘制第二个直方图
#bottom用于指示每根柱子的底部有多高
ax.set_title('My Company')#设置直方图的名称
ax.set_ylim(0,100)#设置y轴坐标范围，如果不设置，python会自动调整到合适范围
ax.set_ylabel(&quot;Profit&quot;)#设置y轴标签
ax.set_xlabel(&quot;In year 2020&quot;)#设置x轴标签
ax.set_xticks(cordx)#设置x轴刻度位置
ax.set_xticklabels(labels)#设置x轴刻度下方文字
ax.legend()#在右上角显示图例说明
plt.show()
</code></pre>
<h5 id="3绘制对比直方图">（3）绘制对比直方图</h5>
<pre><code class="language-python">import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
ax=plt.figure(figsize=(10,5)).add_subplot()#建图，获取子图对象ax,figsize用于指定窗口的大小
ax.set_ylim(0,400)#指定y轴范围
ax.set_xlim(0,80)#指定x轴范围
x1=[7,17,27,37,47,57]#第一组直方图每个柱子中心点的横坐标
x2=[13,23,33,43,53,63]#第二组直方图每个柱子中心点的横坐标
x3=[10,20,30,40,50,60]#第三组直方图每个柱子中心点的横坐标
#三组直方图高度
y1=[41,39,56,89,102,31]
y2=[56,257,344,12,98,123]
y3=[125,67,89,363,46,57]
rects1=ax.bar(x=x1,height=y1,width=3,color='red',label='Iphone')#绘制第一个直方图
rects2=ax.bar(x=x2,height=y2,width=3,color='green',label='Huawei')#绘制第二个直方图
rects3=ax.bar(x=x3,height=y3,width=3,color='blue',label='Xiaomi')#绘制第三个直方图
ax.set_xticks(x3)#设置x轴刻度位置
ax.set_xticklabels(('A1','A2','A3','A4','A5','A6'))#设置x轴刻度下方文字
ax.legend()#在右上角显示图例说明
def label(ax,rects):#在每个柱子顶端标记数值
    for rect in rects:#rects代表一组直方图，是一个序列，则rect表示每个柱子
        height=rect.get_height()#显示数值的高度位置
        ax.text(rect.get_x()+rect.get_width()/2.0,height+14,str(height),rotation=90)
#text()可以在子图任意位置写文字，第一个参数为写文字的位置的横坐标，get_x()得到的是柱子左端坐标，第二个参数是书写高度
#第三个参数是所要书写的数值字符串，第四个参数rotation可以控制文字逆时针旋转的角度，可以不设定
label(ax,rects1)
label(ax,rects2)
label(ax,rects3)
plt.show()
</code></pre>
<h5 id="4绘制折线图和散点图">（4）绘制折线图和散点图</h5>
<pre><code class="language-python">import math,random
import matplotlib.pyplot as plt#引入matplotlib包中的pyplot

def drawPlot(ax):#在ax上画出散点图，折线图
    #画曲线y=10*sin(x)的折线图，因为点间隔很小，等价于画曲线图
    xs=[i/100 for i in range(1500)]#1500个点的横坐标，间隔0.01
    ys=[10*math.sin(x) for x in xs]#对应曲线y=10*sin(x)上的点的纵坐标
    ax.plot(xs,ys,&quot;red&quot;,label=&quot;Beijing&quot;)#画曲线y=10*sin(x),plot用于绘制折线图
    #画散点图
    ys=list(range(-18,18))
    random.shuffle(ys)#随机排列ys
    ax.scatter(range(16),ys[:16],c=&quot;blue&quot;)#画散点图，共有16个散点，scatter用于绘制散点图,注意参数中颜色参数一定要写c
    #以各个散点为结点画折线图
    ax.plot(range(16),ys[:16],&quot;blue&quot;,label=&quot;Shanghai&quot;)#画折线
    ax.legend()#在右上角显示图例说明
    ax.set_xticks(range(16))#设置x轴刻度位置
    ax.set_xticklabels(range(16))#设置x轴刻度下方文字
    
ax=plt.figure(figsize=(10,4),dpi=100).add_subplot()#dpi设置了清晰度
drawPlot(ax)
plt.show()
</code></pre>
<h5 id="5绘制饼图">（5）绘制饼图</h5>
<pre><code class="language-python">import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
def drawPie(ax):#在ax上绘制饼图
    lbs=('A','B','C','D')#四个扇区的标签
    sectors=[16,29.55,44.45,10]#四个扇区的份额（百分比）
    expl=[0,0.1,0,0]#四个扇区的突出程度
    ax.pie(x=sectors,labels=lbs,explode=expl,
           autopct='%.2f',shadow=True,labeldistance=1.1,pctdistance=0.6,startangle=90)
    #autopct控制输出格式，shadow控制输出时是否有阴影效果，labeldistance控制输出标签的位置是半径的多少倍
    #pctdistance控制输出百分比的位置是半径的多少倍，startangle控制从多少度开始以逆时针方向绘制扇形图
    ax.set_title(&quot;Pie Sample&quot;)#设置饼图名称
ax=plt.figure().add_subplot()#建图，获取子图对象ax
drawPie(ax)
plt.show()
</code></pre>
<h5 id="6绘制热力图">（6）绘制热力图</h5>
<p>热力图用于展示二维数据：</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
data=np.random.randint(0,100,30).reshape((5,6))#创建一个随机的5行6列的矩阵
print(data)
xlabels=['Beijing','Shanghai','Chengdu','Guangzhou','Hangzhou','Wuhan']#x轴显示的标签
ylabels=['2016','2017','2018','2019','2020']#y轴显示的标签
ax=plt.figure(figsize=(10,8)).add_subplot()#建图，获取子图对象ax
ax.set_xticks(range(len(xlabels)))#设置x轴刻度位置
ax.set_xticklabels(xlabels)#设置x轴刻度下方文字
ax.set_yticks(range(len(ylabels)))#设置y轴刻度位置
ax.set_yticklabels(ylabels)#设置y轴刻度下方文字
heatMp=ax.imshow(data,cmap=plt.cm.hot,aspect='auto',vmin=0,vmax=100)#绘制热力图
#cmap用于设置绘制图的风格，plt.cm.hot为暖色调，plt.cm.cool为冷色调
#vmin和vmax指定了热力图中的最小值与最大值，显示的颜色随之变化
for i in range(len(xlabels)):#在热力图对应格子上写上数字
    for j in range(len(ylabels)):
        ax.text(i,j,data[j][i],ha=&quot;center&quot;,va=&quot;center&quot;,color=&quot;blue&quot;,size=26)
        #ha为水平对齐方式，va为垂直对齐方式
plt.colorbar(heatMp)#绘制右边的颜色数值对照柱
plt.xticks(rotation=45,ha=&quot;right&quot;)#将x轴刻度文字进行旋转，且水平方向右对齐
plt.title(&quot;Sales Volume(ton)&quot;)#也可以用ax.set_title()
plt.show()
</code></pre>
<h5 id="7绘制雷达图">（7）绘制雷达图</h5>
<pre><code class="language-python">import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
from matplotlib import rcParams
rcParams['font.family']=rcParams['font.sans-serif']='SimHei'
#设置中文支持，中文字体为简体黑体，当不需要中文时则不需要这两行
def drawRadar(ax):#在ax上绘制雷达图
    pi=3.1415926
    labels=['力量','经验','防守','发球','技术','速度']#6个属性名称
    attrNum=len(labels)#属性种类数
    data=[10,10,10,10,10,10]
    angles=[2*pi*i/attrNum for i in range(attrNum)]#angles是以弧度为单位的6个属性对应的6条半径线的角度
    angles2=[x*180/pi for x in angles]#angles2是以角度为单位的6个属性对应的6条半径线的角度
    ax.set_title('马龙',y=1.05)#y指明标题的垂直位置是直径的多少倍
    ax.set_ylim(0,10)#限定半径线上的坐标范围
    ax.set_thetagrids(angles2,labels,fontproperties=&quot;SimHei&quot;)#绘制6个属性对应的6条半径和整个雷达图圆圈
    ax.fill(angles,data,facecolor=&quot;r&quot;,alpha=0.25)#填充雷达图数据，alpha为透明度
ax=plt.figure().add_subplot(projection=&quot;polar&quot;)#生成极坐标形式的子图
drawRadar(ax)
plt.show()
#还可以绘制多幅雷达图的堆叠，略
</code></pre>
<h5 id="8一个窗口绘制多幅子图">（8）一个窗口绘制多幅子图</h5>
<pre><code class="language-python">import math,random
import matplotlib.pyplot as plt#引入matplotlib包中的pyplot
from matplotlib import rcParams
rcParams['font.family']=rcParams['font.sans-serif']='SimHei'

def drawPlot(ax):#在ax上画出散点图，折线图
    #画曲线y=10*sin(x)的折线图，因为点间隔很小，等价于画曲线图
    xs=[i/100 for i in range(1500)]#1500个点的横坐标，间隔0.01
    ys=[10*math.sin(x) for x in xs]#对应曲线y=10*sin(x)上的点的纵坐标
    ax.plot(xs,ys,&quot;red&quot;,label=&quot;Beijing&quot;)#画曲线y=10*sin(x),plot用于绘制折线图
    #画散点图
    ys=list(range(-18,18))
    random.shuffle(ys)#随机排列ys
    ax.scatter(range(16),ys[:16],c=&quot;blue&quot;)#画散点图，共有16个散点，scatter用于绘制散点图,注意参数中颜色参数一定要写c
    #以各个散点为结点画折线图
    ax.plot(range(16),ys[:16],&quot;blue&quot;,label=&quot;Shanghai&quot;)#画折线
    ax.legend()#在右上角显示图例说明
    ax.set_xticks(range(16))#设置x轴刻度位置
    ax.set_xticklabels(range(16))#设置x轴刻度下方文字
    
def drawPie(ax):#在ax上绘制饼图
    lbs=('A','B','C','D')#四个扇区的标签
    sectors=[16,29.55,44.45,10]#四个扇区的份额（百分比）
    expl=[0,0.1,0,0]#四个扇区的突出程度
    ax.pie(x=sectors,labels=lbs,explode=expl,
           autopct='%.2f',shadow=True,labeldistance=1.1,pctdistance=0.6,startangle=90)
    #autopct控制输出格式，shadow控制输出时是否有阴影效果，labeldistance控制输出标签的位置是半径的多少倍
    #pctdistance控制输出百分比的位置是半径的多少倍，startangle控制从多少度开始以逆时针方向绘制扇形图
    ax.set_title(&quot;Pie Sample&quot;)#设置饼图名称
    
def drawRadar(ax):#在ax上绘制雷达图
    pi=3.1415926
    labels=['力量','经验','防守','发球','技术','速度']#6个属性名称
    attrNum=len(labels)#属性种类数
    data=[10,10,10,10,10,10]
    angles=[2*pi*i/attrNum for i in range(attrNum)]#angles是以弧度为单位的6个属性对应的6条半径线的角度
    angles2=[x*180/pi for x in angles]#angles2是以角度为单位的6个属性对应的6条半径线的角度
    ax.set_title('马龙',y=1.05)#y指明标题的垂直位置是直径的多少倍
    ax.set_ylim(0,10)#限定半径线上的坐标范围
    ax.set_thetagrids(angles2,labels,fontproperties=&quot;SimHei&quot;)#绘制6个属性对应的6条半径和整个雷达图圆圈
    ax.fill(angles,data,facecolor=&quot;r&quot;,alpha=0.25)#填充雷达图数据，alpha为透明度
    
fig=plt.figure(figsize=(8,8))
ax=fig.add_subplot(2,2,1)#窗口分割成2*2，取位于第1个方格的子图
drawPie(ax)
ax=fig.add_subplot(2,2,2,projection=&quot;polar&quot;)#取位于第二个方格的子图
drawRadar(ax)
ax=plt.subplot2grid((2,2),(1,0),colspan=2)
#subplot2grid第一个参数(2,2)说明将子图分成2*2，第二个参数(1,0)说明取坐标(1,0)的格子，colspan=2说明取列宽为2
drawPlot(ax)
plt.figtext(0.05,0.05,'subplot sample')#显示左下角的图像标题
#两个0.05说明显示位置为窗口宽与高的0.05倍
plt.show()
</code></pre>
<h3 id="十二网络爬虫设计">十二.网络爬虫设计</h3>
<h4 id="1爬虫的用途和原理">1.爬虫的用途和原理</h4>
<p>1）爬虫的用途：</p>
<p>①在网络上搜集数据（搜索引擎）</p>
<p>②模拟浏览器快速操作（如抢票，选课）</p>
<p>③模拟浏览器操作，替代填表等重复操作</p>
<p>2）最基本的爬虫写法：数据获取型爬虫的本质就是自动获取网页并抽取其中的内容</p>
<p>①手工找出合适的url（网址）</p>
<p>②用浏览器手工查找url对应的网页，并查看网页源码，找出包含想要内容的字符串的模式</p>
<p>③在程序中获取url对应的网页</p>
<p>④在程序中用正则表达式或BeautifulSoup库抽取网页中想要的内容并保存</p>
<pre><code class="language-python">#示例：获取百度图片的搜索结果图片
#在百度浏览器搜索图片desk，获取其相应网址如下：
#https://image.baidu.com/search/index?tn=baiduimage&amp;ps=1&amp;ct=201326592&amp;lm=-1&amp;cl=2&amp;nc=1&amp;ie=utf-8&amp;dyTabStr=MCwzLDIsNCw2LDEsNSw3LDgsOQ%3D%3D&amp;word=desk
#分析上述网址，可以发现word=desk一句控制搜索内容，不妨将desk改为猫，则可以搜索猫的图片结果，任取一张猫的照片地址
#https://img1.baidu.com/it/u=3789058185,1808652640&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=750&amp;h=500
#右键查看搜索猫的图片的网页源代码，Ctrl+F进行搜索，输入图片网址，可以发现图片网址前都有thumbURL
#因此我们需要用爬虫搜索thumbURL来获取图片的网址
</code></pre>
<pre><code class="language-python">import re
import requests#requests用于获取网络资源
def getHtml(url):#获取网址为url的网页
    fakeHeaders = {'User-Agent': #用于伪装浏览器发送请求
                       'Mozilla/5.0 (Windows NT 10.0; Win64; x64) \
                       AppleWebKit/537.36 (KHTML, like Gecko) \ '
                       'Chrome/81.0.4044.138 Safari/537.36 Edg/81.0.416.77',
                   'Accept': 'text/html,application/xhtml+xml,*/*'}
    try:
        r=requests.get(url,headers=fakeHeaders)
        r.encoding=r.apparent_encoding#确保网页编码正确
        return r.text#返回值是一个字符串，内含整个网页的内容
    except Exception as e:
        print(e)
        return &quot;&quot;
def getBaiduPictures(word,n):#下载n个百度图片搜索的关于word的图片到本地
    url=&quot;https://image.baidu.com/search/index?tn=baiduimage&amp;ps=1&amp;ct=201326592&amp;lm=-1&amp;cl=2&amp;nc=1&amp;ie=utf-8&amp;dyTabStr=MCwzLDIsNCw2LDEsNSw3LDgsOQ%3D%3D&amp;word=&quot;
    url+=word#补充完整的网址
    html=getHtml(url)#获取网址对应的网页
    pt='\&quot;thumbURL\&quot;:.*?\&quot;(.*?)\&quot;'#用于寻找图片网址的正则表达式
    i=0#用来记录取了多少幅图
    for x in re.findall(pt,html):#x是图片url的网址,findall用于根据正则表达式pt，寻找html中相应的网址
        x=x.replace(&quot;%3A&quot;,&quot;:&quot;)
        x=x.replace(&quot;%2F&quot;,&quot;/&quot;)#有时网址中用%3A来表示:,用%2F来表示/
        if not(x.lower().find(&quot;jpg&quot;)!=-1 or x.lower().find(&quot;jpeg&quot;)!=-1 or x.lower().find(&quot;png&quot;)!=-1):
            continue#只取.png和.jpg图片
        try:
            print(x)
            r=requests.get(x,stream=True)#获取x对应的网络资源,stream=True说明获取二进制形式的图片
            pos1=x.rfind(&quot;&amp;f=&quot;)#获取后缀名的下标
            pos2=x.rfind(&quot;?&quot;)
            f=open(&quot;F:/tmp/{0}{1}{2}&quot;.format(word,i,&quot;.&quot;+x[pos1+3:pos2].lower()),&quot;wb&quot;)#表示以二进制写方式打开文件
            f.write(r.content)#将图片内容写入文件
            f.close()
        except Exception as e:
            print(e)
        i=i+1
        if i&gt;=n:
            break
getBaiduPictures(&quot;熊猫&quot;,3)#存储3张熊猫图片到相应地址
</code></pre>
<p>上述代码原来if语句写的是：</p>
<p>if not(x.lower().endswith(&quot;.jpg&quot;) or x.lower().endswith(&quot;.jpeg&quot;) or x.lower().endswith(&quot;.png&quot;)):<br>
continue#只取.png和.jpg图片</p>
<p>但是发现爬取失败，经过查看各个图片网址可以发现，各个图片网址格式为：<a href="https://img0.baidu.com/it/u=623374478,4175757280&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=658">u=623374478,4175757280&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG (500×658) (baidu.com)</a></p>
<p>因此并不能正确得爬取图片，因此对if语句进行了修改，查找字符串中得jpeg，jpg和png用于判断是否进行爬取</p>
<p>同时文件名的处理也做了相应的修改，最终爬取成功！！！</p>
<p>局限是requests库获取网络资源很容易被反爬虫，且不能获取JavaScript编写的动态网页源代码，可以尝试pyppeteer库，速度快且暂未被许多网站反爬</p>
<h4 id="2用pyppeteer库获取网页">2.用pyppeteer库获取网页</h4>
<p>pyppeteer的工作原理：</p>
<p>①启动一个浏览器Chromium，用浏览器装入网页</p>
<p>②从浏览器可以获取网页源代码，如果网页有JavaScript程序，获取到的是JavaScript被浏览器执行后的网页源代码</p>
<p>③可以向浏览器发出命令，模拟用户在浏览器上的键盘输入、鼠标点击等操作，让浏览器转到其他网页</p>
<h3 id="十三面向对象程序设计">十三.面向对象程序设计</h3>
<h4 id="1类和对象的概念">1.类和对象的概念</h4>
<p>类：类是用来代表事物的，对于一种事物，可以用一个类来概括其属性</p>
<p>对象：类的实例称为对象，类主要用于将数据和操作数据的函数捆绑在一起，便于当作一个整体使用</p>
<pre><code class="language-python">#矩形类示例：
class rectangle:
    def __init__(self,w,h):#构造函数，每一个类必须有，self称为类的自身，注意构造函数init两侧是双下划线__而不是_!!!
        self.w,self.h=w,h
    def area(self):#类的每个成员函数都需要有self参数
        return self.w*self.h
    def perimeter(self):
        return 2*(self.w+self.h)
def main():
    w,h=map(int,input().split())#假设输入2 3
    rect=rectangle(2,3)#生成一个rectangle对象
    print(rect.area(),rect.perimeter())#6 10,#调用成员函数时不需要给self分配对应的实参
    rect.w,rect.h=4,5
    print(rect.area(),rect.perimeter())#20 18
main()
</code></pre>
<h4 id="2对象的比较">2.对象的比较</h4>
<p>python中所有的类都有eq,ne等方法用于比较（注意双下划线）</p>
<pre><code class="language-python">#x==y的值就是x.__eq__(y)的值，如果x.__eq__(y)没有定义，那么就是y.__eq__(x)的值，如果x.__eq__(y)和y.__eq__(x)都没有定义，那么x==y也没有意义（x，y都是整数常量时不适用）
#x!=y的值就是x.__ne__(y)的值，如果x.__ne__(y)没有定义，那么就是y.__ne__(x)的值，如果x.__ne__(y)和y.__ne__(x)都没有定义，那么x!=y也没有意义,默认情况下x.__ne__(y)等价于not x.__eq__(y)
#x&lt;y等价于x.__lt__(y)
#x&gt;y等价于x.__gt__(y)
#x&lt;=y等价于x.__le__(y)
#x&gt;=y等价于x.__ge__(y)
print(24.5.__eq__(24.5))#True
print(10.0.__ne__(10.0))#False
print(25.7.__le__(45.5))#True
</code></pre>
<p>自定义对象的比较：</p>
<pre><code class="language-python">#默认情况下，一个自定义类的__eq__方法，功能是判断两个对象的id是否相同，即是否指向同一内存
#默认情况下，自定义类的lt,gt,le,ge都被设置成了None，因此不能比较大小，若想比较大小需重新编写这几个函数
</code></pre>
<pre><code class="language-python">class point:
    def __init__(self,x,y=0):#y的缺省值设为0
        self.x,self.y=x,y
    def __eq__(self,other):
        return self.x==other.x and self.y==other.y
    def __lt__(self,other):#使得两个point对象可以用&lt;进行比较
        if self.x==other.y:
            return self.y&lt;other.y
        else:
            return self.x&lt;other.x
a,b=point(1,2),point(1,2)
print(a==b)#True
print(a&lt;b)#False
lst=[point(1,2),point(3,4),point(-7,2)]
lst.sort()
for p in lst:
    print(&quot;(%d,%d)&quot;%(p.x,p.y),end=&quot;&quot;)#(-7,2) (1,2) (3,4) 
</code></pre>
<h4 id="3继承与派生">3.继承与派生</h4>
<p>定义一个新类B时，如果发现B类具有A类的全部特点，则可以在定义B类时以A为基类，定义B类为A类的派生类</p>
<pre><code class="language-python">import datetime
class student:#定义一个学生类
    def __init__(self,id,name,gender,birthYear):
        self.id,self.name,self.gender,self.birthYear = id,name,gender,birthYear
    def printInfo(self):#打印学生信息
        print(&quot;Name:&quot;,self.name)
        print(&quot;ID:&quot;, self.id)
        print(&quot;Birth Year:&quot;,self.birthYear)
        print(&quot;Gender:&quot;,self.gender)
        print(&quot;Age:&quot;,self.countAge())
    def countAge(self):#获取学生年龄
        return datetime.datetime.now().year - self.birthYear
class undergraduateStudent(student): #本科生类，继承了student类
    def __init__(self,id,name,gender,birthYear,department):#相比于student类，多了一个院系成员
        student.__init__(self,id,name,gender,birthYear)#可以直接调用student类的构造函数，注意此时要带self
        self.department = department
    def qualifiedForBaoyan(self): #给予保研资格
        print(self.name + &quot; is qualified for baoyan&quot;)
    def printInfo(self): #基类中有同名方法
        student.printInfo(self) #调用基类的PrintInfo
        print(&quot;Department:&quot; ,self.department)
def main():
    s2 = undergraduateStudent(&quot;118829212&quot;,&quot;Harry Potter&quot;,&quot;M&quot;,2000, &quot;Computer Science&quot;)
    s2.printInfo()
    s2.qualifiedForBaoyan()
    if s2.countAge() &gt; 18:
        print(s2.name , &quot;is older than 18&quot;)
main() 
</code></pre>
<p>object类：python中所有类都是object类的派生类，因而具有object类的各种属性和方法</p>
<pre><code class="language-python">class A:
    def func(x):
        pass
print(dir(A))#输出A的方法
#['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'func']，除了最后的func是自定义的，其他的都是object类的方法
</code></pre>
<h4 id="4静态属性和静态方法">4.静态属性和静态方法</h4>
<p>静态属性：静态属性被所有对象所共享，一共只有一份</p>
<p>静态方法：静态方法不是作用在具体的某个对象上，因此不能访问非静态属性</p>
<p>静态属性和静态方法这种机制存在的目的就是少写全局变量和全局函数</p>
<pre><code class="language-python">class employee:
    totalSalary = 0 #静态属性，记录发给员工的工资总数
    def __init__(self,name,income):
        self.name,self.income = name, income
    def pay(self,salary):#发工资
        self.income += salary
        employee.totalSalary += salary#因为是静态成员变量，所以前面不写self，而是写类名employee
    @staticmethod#说明下面定义的函数为静态方法
    def printTotalSalary(): # 静态方法，只能访问静态成员变量，因此没有self
        print(employee.totalSalary)
e1 = employee(&quot;Jack&quot;,0)
e2 = employee(&quot;Tom&quot;,0)
e1.pay(100)
e2.pay(200)
employee.printTotalSalary() #&gt;&gt;300，静态方法的调用可以通过类名
e1.printTotalSalary() #&gt;&gt;300，静态方法的调用也可以通过对象名，但是该方法于该具体对象之间没有关系
e2.printTotalSalary() #&gt;&gt;300
print(employee.totalSalary) #&gt;&gt;300
</code></pre>
<h4 id="5对象作为集合元素或字典的键">5.对象作为集合元素或字典的键</h4>
<h5 id="1可哈希可哈希的东西才可以作为字典的键和集合的元素hashx有定义即hashx有返回值说明x是可哈希的">（1）可哈希：可哈希的东西才可以作为字典的键和集合的元素，hash(x)有定义即hash(x)有返回值，说明x是可哈希的</h5>
<pre><code class="language-python">#hash(x)=x,如果x为整型常量
#hash(x)=x.__hash__(),如果x不是整型常量
#object类有hash方法，返回值是一个整数
#列表，字典，集合的__hash__成员函数都被定义为None，因此它们不能作为字典的键和集合的元素
x=23.1
print(x.__hash__(),23.1.__hash__())#230584300921372695 230584300921372695,只要变量值相同，算出来的哈希值就相同
x=23
print(x.__hash__(),hash(23))#23 23
x=&quot;OK&quot;
print(hash(x))#-5537884497696122570
</code></pre>
<h5 id="2哈希值和字典-集合的关系">（2）哈希值和字典、集合的关系</h5>
<p>字典和集合都是一种称为”哈希表“的数据结构，根据元素的哈希值为元素寻找存放的槽，哈希值可以看作是槽编号，一个槽中可以放多个哈希值相同的元素。</p>
<p>两个对象的哈希值不同可以作为同一集合的不同元素和同一字典的不同键，当hash(a)==hash(b)但是a!=b时，a，b也可以作为同一集合的不同元素和同一字典的不同键，自定义类的对象在默认情况下哈希值的计算是根据对象的id计算的（即存储地址），而非对象的值，可以重写自定义类的hash方法</p>
<p>若 dt 是个字典，dt[x] 计算过程如下：</p>
<ol>
<li>
<p>根据hash(x)去找x应该在的槽的编号</p>
</li>
<li>
<p>如果该槽没有元素，则认为dt中没有键为x的元素</p>
</li>
<li>
<p>如果该槽中有元素，则试图在槽中找一个元素y，使得 y的键 == x。 如果找到，则dt[x] 即为 y的值，如果找不到，则dt[x]没定义，即 认为dt中不存在键为x的元素</p>
</li>
</ol>
<pre><code class="language-python">class A:
    def __init__(self,x):
        self.x=x
a,b=A(5),A(5)#两个A(5)不是同一个，因此a和b的id不同
dt={a:20,A(5):30,b:40}#三个A(5)的id不同，因此在不同的槽里
print(dt[a],dt[b])#20 40
#print(dt[A(5)]),runtime error,因为此处的A(5)是一个新的A(5)
</code></pre>
<h5 id="3自定义类的对象是否可哈希">（3）自定义类的对象是否可哈希</h5>
<p>自定义类的对象在默认情况下哈希值的计算是根据对象的id计算的（即存储地址）</p>
<p>如果为自定义的类重写了eq(self,other)成员函数，则其 hash成员函数会被自动设置为None。这种情况下，该类就变成不可哈希的</p>
<p>一个自定义类，只有在重写了eq方法却没有重写hash方法的情况下，才是不可哈希的。</p>
<pre><code class="language-python">class A:
    def __init__(self,x):
        self.x=x
    def __hash__(self):
        return hash(self.x)
c=A(1)
dt={A(1):2,A(1):3,c:4}#三个元素的哈希值相同，但是id不同，它们在同一个槽里
print(dt[c])#4
</code></pre>
<h3 id="十四tkinter图形界面程序设计">十四.tkinter图形界面程序设计</h3>
<h4 id="1控件概述">1.控件概述</h4>
<p><strong>控件(widgets)</strong>： 按钮、列表框、单选框、多选框、编辑框....</p>
<p><strong>布局</strong> ：如何将控件摆放在窗口上合适的位置</p>
<p><strong>事件响应</strong>： 对鼠标点击、键盘敲击、控件被点击等操作进行响应</p>
<p><strong>对话框</strong> ：弹出一个和用户交互的窗口接受一些输入</p>
<pre><code class="language-python">import tkinter as tk
win=tk.Tk()#生成一个窗口
tk.Label(win,...)#在窗口win上生成一个标签label，该label的母体是win
ckb=tk.Checkbutton(win,...)#在窗口win上生成一个checkbutton
frm = tk.Frame(win,...)#在窗口上生成一个Frame框架
bt = tk.Button(frm,...)#在frm上生成一个Button
</code></pre>
<p><strong>tkinter的扩展控件</strong>：</p>
<p>from tkinter import ttk，tk中的控件ttk都有且更加美观，并且ttk中还有一些tk不具有的控件</p>
<h4 id="2布局基础">2.布局基础</h4>
<p>用grid进行布局，grid布局在窗口上布置网格，控件放在网格单元里面居中摆放</p>
<pre><code class="language-python">import tkinter as tk
win=tk.Tk()#生成一个窗口
win.title(&quot;Hello&quot;)#指定窗口标题
label1=tk.Label(win,text=&quot;用户名：&quot;)#创建标签控件，并与之母体win进行绑定
label2=tk.Label(win,text=&quot;密码：&quot;)
etUsername=tk.Entry(win)#创建属于win的单行编辑框控件，用于输入用户名
etPassword=tk.Entry(win)#创建属于win的单行编辑框控件，用于输入密码
btLogin=tk.Button(win,text=&quot;登录&quot;)#创建属于win的按钮button控件
label1.grid(row=0,column=0,padx=5,pady=5)#Label1放在第0行第0列，上下左右都留白5像素
label2.grid(row=1,column=0,padx=5,pady=5)#Label2放在第1行第0列，上下左右都留白5像素
etUsername.grid(row=0,column=1,padx=5,pady=5)#用户名输入框放在第0行第1列
etPassword.grid(row=1,column=1,padx=5,pady=5)#密码输入框放在第1行第1列
btLogin.grid(row=2,column=0,columnspan=2,padx=5,pady=5)
#登录按钮放在第2行第0列，跨2列，说明占用了第2行第0列和第2行第1列
win.geometry(&quot;500x200&quot;) #设置窗口大小
win.columnconfigure(0,weight = 1)
#指定第0列增量分配权重为1，默认的增量分配权重为0，当窗口变宽时，根据每一列的增量分配权重按比例分配多出来的宽度
win.columnconfigure(1,weight = 1) 
win.rowconfigure(0,weight = 1) #指定第0行增量分配权重为1 
win.rowconfigure(1,weight = 1)
win.rowconfigure(2,weight = 1)
#同时grid函数还有参数sticky指明控件在单元格中的贴边方式，由EWSN四个字符控制
label2.grid(row=1,column=0,padx=5,pady=5,sticky=&quot;NE&quot;)#密码标签靠右上角
etUsername.grid(row=0,column = 1,padx=5,pady=5,sticky=&quot;E&quot;) #用户名编辑框靠右
etPassword.grid(row=1,column = 1,padx=5,pady=5,sticky=&quot;EWSN&quot;)#密码编辑框占满单元格
btLogin.grid(row=2,column=0,columnspan=2,padx=5,pady=5,sticky=&quot;SW&quot;) #登录按钮靠左下
win.mainloop()#显示窗口
</code></pre>
<p><strong>默认情况下的grid规则：</strong></p>
<p>1）一个单元格只能放一个控件，控件在单元格中居中摆放。</p>
<p>2）不同控件高宽可以不同，因此网格不同行可以不一样高，不同列也 可以不一样宽。但同一行的单元格是一样高的，同一列的单元格也 是一样宽的。</p>
<p>3）一行的高度，以该行中包含最高控件的那个单元格为准。单元格的 高度，等于该单元格中摆放的控件的高度（控件如果有上下留白， 还要加上留白的高度）。列宽度也是类似的处理方式。</p>
<p>4）若不指定窗口的大小和显示位置，则窗口大小和网格的大小一样， 即恰好能包裹所有控件；显示位置则由Python自行决定。</p>
<h4 id="3使用frame控件进行布局">3.使用Frame控件进行布局</h4>
<p>1）控件多了，要算每个控件行、列、rowspan,columnspan很麻烦</p>
<p>2）Frame控件上面还可以摆放控件，可以当作底板使用</p>
<p>3）可以在Frame控件上面设置网格进行Grid布局，摆放多个控件</p>
<pre><code class="language-python">import tkinter as tk
#该系统的整体思路是用Frame填充网格，将控件放在Frame上，相当于对控件进行封装
win = tk.Tk()#创建窗口
win.title('人事系统')#设置窗口标题
frm01Red = tk.Frame(win,bg=&quot;red&quot;,highlightthickness=2)#背景红色，边框宽度2
frm01Red.grid(row=0,column=1,columnspan=2,sticky=&quot;WE&quot;)#摆放Frame控件到网格grid的合适位置
tk.Label(frm01Red, text=&quot;姓名：&quot;).grid(row=0,column=0,padx=6,pady=6)#创建姓名Label与frm01Red绑定
tk.Entry(frm01Red).grid(row=0,column=1,padx=6,pady=6)
tk.Label(frm01Red, text=&quot;手机号：&quot;).grid(row=0,column=2,padx=6,pady=6)
tk.Entry(frm01Red).grid(row=0,column=3,padx=6,pady=6)
tk.Button(frm01Red,text=&quot;更新&quot;).grid(row=0,column=4,padx=6,pady=6)
frm00Blue = tk.Frame(win, bg=&quot;blue&quot;,highlightthickness=2)
frm00Blue.grid(row=0,column=0,rowspan=2,sticky=&quot;NS&quot;)#放在网格的第0行第0列，且跨2行
tk.Label(frm00Blue,text=&quot;筛选条件：&quot;).grid( row = 0,
padx=6,pady=6,sticky=&quot;W&quot;)
tk.Checkbutton(frm00Blue,text=&quot;男性&quot;).grid( row = 1,padx=6,pady=6)#checkbutton为单选按钮，因为只有1列，可以不指定列
tk.Checkbutton(frm00Blue,text=&quot;女性&quot;).grid( row = 2,padx=6,pady=6)
tk.Checkbutton(frm00Blue,text=&quot;博士&quot;).grid( row = 3,padx=6,pady=6)
tk.Label(frm00Blue,text=&quot;符合条件的名单：&quot;).grid( row = 4,padx=6,sticky=&quot;W&quot;)
nameList = tk.Listbox(frm00Blue)#创建列表框控件
nameList.grid(row=5,padx=6,pady=6)
for x in ['张三','李四','王五','李丽','刘娟']:
    nameList.insert(tk.END,x) #将x插入到列表框尾部
frm21Green = tk.Frame(win, bg='green',highlightthickness=2)
frm21Green.grid(row=2,column=0,columnspan=2,sticky=&quot;WE&quot;)
tk.Label(frm21Green, text=&quot;提示：目前一切正常&quot;).grid(row=0,padx=6,pady=6) 
frm11Yellow = tk.Frame(win, bg='yellow',highlightthickness=2)
frm11Yellow.grid(row=1,column=1,sticky=&quot;NSWE&quot;) #要贴住单元格四条边
frm11Yellow.rowconfigure(1,weight=1) #使得frm11Yellow中第1行高度会自动伸缩
frm11Yellow.columnconfigure(0, weight=1)
tk.Label(frm11Yellow,text=&quot;简历：&quot;).grid(row=0,padx=6,pady=6,sticky=&quot;W&quot;)
tk.Text(frm11Yellow).grid(row=1,padx=15,pady=15,sticky=&quot;NSWE&quot;)
# sticky=&quot;NSWE&quot;使得该多行编辑框会自动保持填满整个单元格
win.rowconfigure(1, weight=1) 
win.columnconfigure(1, weight=1)
win.mainloop()
</code></pre>
<h4 id="4控件属性和事件响应">4.控件属性和事件响应</h4>
<h5 id="1控件属性">（1）控件属性</h5>
<p>1）有的控件有函数可以用来设置和获取其属性，或以字典下标的形式获取和设置其属性</p>
<pre><code class="language-python">lbHint = tk.Label(win,text = &quot;请登录&quot;)
lbHint[&quot;text&quot;] = &quot;登录成功!&quot; #修改lbHint的文字
txt = tk.Text(win) 
txt.get(0.0, tk.END) #从第0行第0列开始，取全部文字
</code></pre>
<p>2）有的控件必须和一个变量相关联，取变量值或设置变量值，就是取或设置该控件的属性</p>
<pre><code class="language-python">s = tk.StringVar()#s是tk中的字符串变量
s.set(&quot;sin(x)&quot;)#对字符串s进行赋值
tk.Entry(win,textvariable = s)#设定单行编辑框中的内容为s，编辑框中的文字和s关联到了一起，编辑框中内容改变，s也改变
print(s.get())
</code></pre>
<h5 id="2事件响应">（2）事件响应</h5>
<p>1）创建有些控件时，可以用command参数指定控件的事件响应函数</p>
<pre><code class="language-python">tk.Button(win,text=&quot;显示函数图&quot;,command = myfunc) #myfunc是函数名
tk.Checkbox(win,text=&quot;显示函数图&quot;,command = lambda:print(&quot;hello&quot;))#checkbox是单选框
</code></pre>
<p>2）可以用控件的bind函数指定事件响应函数</p>
<pre><code class="language-python">lb = tk.Label(win,text=&quot;something&quot;)
lb.bind(&quot;&lt;ButtonPress-1&gt;&quot;,mouse_down) #鼠标左键按下事件，调用自定义的mouse_down函数
</code></pre>
<p>示例：</p>
<pre><code class="language-python">import tkinter as tk
def btLogin_click(): #登录按钮的事件响应函数，点击该按钮时被调用
    if username.get()==&quot;wzt&quot; and password.get()==&quot;123456789&quot;: #正确的用户名和密码，get()得到对应的字符串
        lbHint[&quot;fg&quot;] = &quot;black&quot; #文字变成黑色，&quot;fg&quot;表示前景色,&quot;bg&quot;表示背景色
        lbHint[&quot;text&quot;] = &quot;登录成功!&quot; #修改lbHint的文字
    else:
        username.set(&quot;&quot;) #将用户名输入框清空
        password.set(&quot;&quot;) #将密码输入框清空
        lbHint[&quot;fg&quot;] = &quot;red&quot; #文字变成红色
        lbHint[&quot;text&quot;] = &quot;用户名密码错误，请重新输入!&quot;
def cbPassword_click(): #&quot;显示密码&quot;单选框的事件响应函数，点击该单选框时被调用
    if showPassword.get():#showPassword是和cbPassword绑定的tkinter布尔变量
        etPassword[&quot;show&quot;] = &quot;&quot; #使得密码输入框能正常显示密码。Entry有show属性
    else:
        etPassword[&quot;show&quot;] = &quot;*&quot;
win = tk.Tk()#创建窗口
win.title(&quot;登录&quot;)
username,password = tk.StringVar(),tk.StringVar()#两个字符串类型变量，分别用于关联用户名输入框和密码输入框
lbHint = tk.Label(win,text = &quot;请登录&quot;)
lbHint.grid(row=0,column=0,columnspan=2)
lbUsername = tk.Label(win,text=&quot;用户名：&quot;)
lbUsername.grid(row=1,column=0,padx=5,pady=5)
lbPassword = tk.Label(win,text=&quot;密码：&quot;)
lbPassword.grid(row=2,column=0,padx=5,pady=5)
etUsername = tk.Entry(win,textvariable = username)#输入框etUsername和变量username关联
etUsername.grid(row=1,column = 1,padx=5,pady=5)
etPassword = tk.Entry(win,textvariable = password,show=&quot;*&quot;)
#Entry的属性show=&quot;*&quot;表示该输入框不论内容是啥，只显示'*'字符，为&quot;&quot;则正常显示
etPassword.grid(row=2,column = 1,padx=5,pady=5)
showPassword=tk.BooleanVar()#tk中的bool类型量，用于关联显示密码的单选框
showPassword.set(False)#使得cbPassword开始就是非选中状态
cbPassword = tk.Checkbutton(win,text=&quot;显示密码&quot;,variable=showPassword,command=cbPassword_click)
#cbPassword关联变量showPassword，其事件响应函数是cbPassword_click，即点击它时会调用 cbPassword_cli ck()
cbPassword.grid(row=3,column = 0,padx=5,pady=5)
btLogin = tk.Button(win,text=&quot;登录&quot;,command=btLogin_click)#点击btLogin按钮会执行btLogin_click()
btLogin.grid(row=4,column=0,pady=5)
btQuit = tk.Button(win,text=&quot;退出&quot;,command=win.quit)
#点击btQuit会执行win.quit()，win.quit()导致窗口关闭，于是整个程序结束
btQuit.grid(row=4,column=1,pady=5)
win.mainloop()
</code></pre>
<h4 id="5python实例火锅店点菜系统">5.Python实例：火锅店点菜系统</h4>
<pre><code class="language-python">import tkinter as tk
from tkinter import ttk #ttk中有更多控件
gWin = None  #表示窗口
gDishes = ( (&quot;清汤(20元)&quot;,&quot;滋补(40元)&quot;,&quot;鸳鸯(60元)&quot;),  #锅底
	  (&quot;香菜(10元)&quot;,&quot;麻酱(20元)&quot;,&quot;韭花(20元)&quot;),  #佐料
	  (&quot;羊肉(30元)&quot;,&quot;肥牛(40元)&quot;,&quot;白菜(10元)&quot;,&quot;茼蒿(20元)&quot;))  #菜品
def addToListbox(listbox,lst):#向列表框中添加lst中的元素
	for x in lst:
		listbox.insert(tk.END,x) #将x添加到列表框尾部
def doDiscount():
	gWin.discount = [1,0.9,0.8][gWin.custom.get()]
	gWin.lbHint[&quot;text&quot;] = &quot;饭菜总价：&quot; + str(int(gWin.totalCost*gWin.discount)) + &quot;元&quot;
	gWin.lbHint[&quot;fg&quot;] = &quot;black&quot;
def categoryChanged(event): #gWin.cbxCategory选项变化时被调用
	gWin.lsbDishes.delete(0,tk.END) #删除全部内容,delete(x,y)删除第x项到第y项
	idx = gWin.cbxCategory.current() #gWin.cbxCategory当前选中的是第idx项
	addToListbox(gWin.lsbDishes,gDishes[idx]) #装入相应菜单
	gWin.lsbDishes.select_set(0, 0)
def btAdd_click():
	#btAdd[&quot;state&quot;] = tk.DISABLED表示按钮不可点击  tk.NORMAL表示按钮可点击
	sel = gWin.lsbDishes.curselection() #sel形如 (1,2,3)，获取当前选中的菜品
	if sel == ():
		gWin.lbHint[&quot;text&quot;] = &quot;您还没有选中要添加的菜&quot;
		gWin.lbHint[&quot;fg&quot;] = &quot;red&quot;
	else:
		dish = gWin.lsbDishes.get(sel)
		price,num = int(dish[3:5]),gWin.dishNum.get()
		gWin.lsbTable.insert(tk.END, &quot;[&quot;+gWin.category.get()+&quot;]&quot;+dish+&quot; X&quot;+num)
		gWin.totalCost += price * int(num)
		gWin.lbHint[&quot;text&quot;] = &quot;饭菜总价：&quot; + str(int(gWin.totalCost*gWin.discount)) + &quot;元&quot;
		gWin.lbHint[&quot;fg&quot;] = &quot;black&quot;
def btDelete_click():
	sel = gWin.lsbTable.curselection()
	if sel == ():
		gWin.lbHint[&quot;text&quot;] = &quot;您还没有选中要删除的菜&quot;
		gWin.lbHint[&quot;fg&quot;] = &quot;red&quot;
	else:
		for i in sel:
			dish = gWin.lsbTable.get(i)
			price = int(dish[7:9])
			price *= int(dish[dish.index(&quot;X&quot;)+1:])
			gWin.totalCost -= price
		gWin.lbHint[&quot;text&quot;] = &quot;饭菜总价：&quot; + str(int(gWin.totalCost*gWin.discount)) + &quot;元&quot;
		gWin.lbHint[&quot;fg&quot;] = &quot;black&quot;
		for i in sel[::-1]:
			gWin.lsbTable.delete(i)
def main():
	global gWin#声明以下的gWin为全局变量
	gWin = tk.Tk()
	gWin.title(&quot;Python火锅店&quot;)
	gWin.geometry(&quot;520x300&quot;)
	gWin.totalCost, gWin.discount = 0, 1  # 为gWin添加属性总价和折扣，类似于封装
	gWin.resizable(False,False) #gWin不可改变大小，使得窗口不可进行拖拽改变大小
	lb = tk.Label(gWin,text=&quot;欢迎光临Python火锅店&quot;,bg=&quot;red&quot;,fg=&quot;white&quot;,font=('黑体', 20,'bold'))#bold为粗体
	lb.grid(row=0,column=0,columnspan=4,sticky=&quot;EW&quot;)
	gWin.category = tk.StringVar()  #对应组合框gWin.cbxCategory收起状态显示的文字
	gWin.cbxCategory =  ttk.Combobox(gWin,textvariable=gWin.category)#创建组合框控件
	gWin.cbxCategory[&quot;values&quot;] = (&quot;锅底&quot;, &quot;佐料&quot;, &quot;菜品&quot;) #下拉时显示的表象
	gWin.cbxCategory[&quot;state&quot;] = &quot;readonly&quot;  #将gWin.cbxCategory设置为不可输入，只能选择，state设置组合框属性
	gWin.cbxCategory.current(0)			   #选中第0项，缺省的情况下选中的默认为第0项锅底
	gWin.cbxCategory.grid(row=1,column=0,sticky=&quot;EW&quot;)
	gWin.lsbDishes = tk.Listbox(gWin,selectmode=tk.SINGLE,exportselection=False)
	#exportselection使得列表框失去输入焦点也能保持选中项目，即选中后点击别的地方该选中不会消失
    #selectmode表示选择模式，设置选择模式为只能单选
	gWin.lsbDishes.bind(&quot;&lt;Double-Button-1&gt;&quot;, lambda e:btAdd_click())
    #使得双击菜品也可以进行添加，即使得双击行为对应操作添加
	gWin.lsbDishes.bind(&quot;&lt;&lt;ListboxSelect&gt;&gt;&quot;,lambda e:gWin.dishNum.set(&quot;1&quot;))
    #使得选中新菜品即选择列表框中新选项时，数量自动返回1
	addToListbox(gWin.lsbDishes,gDishes[0]) #装入锅底菜单
	gWin.lsbDishes.select_set(0,0)		  #select_set(x,y)可以选中第x项到第y项(包括y)，默认初始选中第0项菜品
	gWin.lsbDishes.grid(row=2,column=0,sticky=&quot;EWNS&quot;)
	gWin.cbxCategory.bind(&quot;&lt;&lt;ComboboxSelected&gt;&gt;&quot;,categoryChanged)
	#当组合框下拉后有表现被选中时，会发生ComboboxSelected事件。
	#此处指定该事件发生时，会调用gWin.categoryChanged函数
	#指定&quot;&lt;&lt;ComboboxSelected&gt;&gt;&quot;事件的响应函数是gWin.categoryChanged
	gWin.lsbTable = tk.Listbox(gWin,selectmode=tk.EXTENDED,exportselection=False)
    #selectmode=tk.EXTENDED说明可以多选
	gWin.lsbTable.grid(row=2,column=2,sticky=&quot;EWNS&quot;)
	tk.Label(gWin,text=&quot;我的餐桌&quot;).grid(row=1,column=2)
	gWin.lbHint = tk.Label(gWin,text=&quot;饭菜总价：0元&quot;)#输出当前选中菜品总价的Label
	gWin.lbHint.grid(row = 3,column=0,columnspan=3,sticky=&quot;W&quot;)
	scrollbar = tk.Scrollbar(gWin,width=20, orient=&quot;vertical&quot;,command=gWin.lsbTable.yview)
    #创建滚动条控件，宽度width为20个像素，方向orient为垂直方向
    #command=gWin.lsbTable.yview使得滚动条和列表框相关联
	gWin.lsbTable.configure(yscrollcommand=scrollbar.set) #绑定listbox和scrollbar，使得列表框和滚动条关联
	scrollbar.grid(row=2,column=3,sticky=&quot;NS&quot;)
	frm = tk.Frame(gWin)
	frm.grid(row=2,column=1)
	tk.Label(frm,text=&quot;数量：&quot;).grid(row=0,column=0)
	gWin.dishNum = tk.StringVar(value=&quot;1&quot;)#tk字符串形式的变量，用于表示菜品数，初始值设为1
	gWin.spNum = tk.Spinbox(frm,width=5,from_=1,to=1000,textvariable=gWin.dishNum)
    #创建可调数量框控件，from_和to控制调节范围
	gWin.spNum.grid(row=0,column=1)
	btAdd = tk.Button(frm,text=&quot;添加&quot;,command=btAdd_click)
	btAdd.grid(row=1,column=0,columnspan=2,sticky=&quot;EW&quot;)
	btDelete = tk.Button(frm,text=&quot;删除&quot;,command=btDelete_click)
	btDelete.grid(row=2,column=0,columnspan=2,sticky=&quot;EW&quot;)
	lbfDiscount = tk.LabelFrame(frm,text=&quot;价格&quot;)#带标签的Frame
	lbfDiscount.grid(row=3,column=0,columnspan=2)
	gWin.custom = tk.IntVar() #如果写 gWin.custom = tk.IntVar(value=0)就不用下一行了
	gWin.custom.set(0)#gWin.custom为tk的整型变量
	rb = tk.Radiobutton(lbfDiscount,text=&quot;普通价&quot;,value=0,variable=gWin.custom,command=doDiscount)
	rb.grid(row=0,column=0,sticky=&quot;W&quot;)#Radiobutton为单选框，如果它被选中，那么variable会变为0
	rb = tk.Radiobutton(lbfDiscount,text=&quot;会员价(九折)&quot;,value=1,variable=gWin.custom,command=doDiscount)
	rb.grid(row=1,column=0,sticky=&quot;W&quot;)
	rb = tk.Radiobutton(lbfDiscount,text=&quot;VIP价(八折)&quot;,value=2,variable=gWin.custom,command=doDiscount)
	rb.grid(row=2,column=0,sticky=&quot;W&quot;)
	gWin.columnconfigure(0,weight = 1)
	gWin.columnconfigure(2,weight = 1)
	gWin.rowconfigure(2,weight = 1)
	gWin.mainloop()
main()
</code></pre>
<h3 id="十五python游戏设计">十五.Python游戏设计</h3>
<p>外星人入侵主要依靠pygame库进行设计，在此仅附上代码</p>
<h4 id="1aline_invasionpy">1.aline_invasion.py</h4>
<pre><code class="language-python">import sys
from time import sleep
import pygame#pygame包含开发游戏所需功能
from settings import Settings
from game_stats import GameStats
from ship import Ship
from bullet import Bullet
from aline import Aline
from button import Button
from scoreboard import ScoreBoard
class AlineInvasion:#管理游戏资源和行为的类
    def __init__(self):#初始化游戏并创建游戏资源
        pygame.init()#初始化游戏背景设置
        self.settings=Settings()
        self.screen=pygame.display.set_mode((0,0),pygame.FULLSCREEN)#全屏运行游戏
        self.settings.screen_width=self.screen.get_rect().width
        self.settings.screen_height=self.screen.get_rect().height#更新settings中的数据
        pygame.display.set_caption(&quot;Aline Invasion&quot;)#设置窗口title
        self.stats=GameStats(self)
        self.sb=ScoreBoard(self)
        self.ship=Ship(self)#self就是当前的AlineInvasion实例
        self.bullets=pygame.sprite.Group()#编组，用于管理所有有效子弹
        self.alines=pygame.sprite.Group()#
        self._create_fleet()
        self.play_button=Button(self,&quot;Play&quot;)
    def run_game(self):#开始游戏的主循环
        while True:#监视键盘和鼠标事件
            self._check_events()
            if self.stats.game_active:
                self.ship.update()
                self._update_bullets()
                self._update_alines()
            self._update_screen()
    def _check_events(self):
        for event in pygame.event.get():#事件循环
            if event.type==pygame.QUIT:#退出事件
                sys.exit()#响应退出事件
            elif event.type==pygame.KEYDOWN:#按键盘事件
                self._check_keydown_events(event)
            elif event.type==pygame.KEYUP:#松键盘事件
                self._check_keyup_events(event)
            elif event.type==pygame.MOUSEBUTTONDOWN:
                mouse_pos=pygame.mouse.get_pos()#返回一个坐标
                self._check_play_button(mouse_pos)
    def _fire_bullet(self):
        #创建一颗子弹，并将其加入编组中
        if len(self.bullets)&lt;self.settings.bullets_allowed:
            new_bullet=Bullet(self)
            self.bullets.add(new_bullet)
    def _update_bullets(self):
        self.bullets.update()#对编组调用update即为对其中每个元素都调用update
        for bullet in self.bullets.copy():#遍历副本目的是为了保证循环过程中编组长度保持不变
            if bullet.rect.bottom&lt;=0:
                self.bullets.remove(bullet)
        self._check_bullet_aline_collisions()
    def _check_bullet_aline_collisions(self):
        #检测碰撞，即图片是否有重叠，比较两个Group，返回一个字典，字典元素的键是子弹，值是被击中的外星人
        #两个布尔参数分别代表是否删除子弹和外星人
        collisions=pygame.sprite.groupcollide(self.bullets,self.alines,True,True)
        if collisions:
            for alines in collisions.values():
                self.stats.score+=self.settings.aline_points*len(alines)
            self.sb.prep_score()
            self.sb.check_high_score()
        if not self.alines:
            #删除现有的子弹并创建一批新的外星人
            self.bullets.empty()
            self._create_fleet()
            self.settings.increase_speed()
            self.stats.level+=1
            self.sb.prep_level()
    def _update_screen(self):
        self.screen.fill(self.settings.bg_color)#每次循环时都重绘屏幕，fill设置背景颜色
        self.ship.blitme()
        for bullet in self.bullets.sprites():
            bullet.draw_bullet()
        self.alines.draw(self.screen)#绘制外星人群中的外星人
        self.sb.show_score()
        if not self.stats.game_active:
            self.play_button.draw_button()
        pygame.display.flip()#让最近绘制的屏幕可见
    def _check_keydown_events(self,event):
        if event.key==pygame.K_RIGHT:#右移事件
            self.ship.moving_right=True
        elif event.key==pygame.K_LEFT:#左移事件
            self.ship.moving_left=True
        elif event.key==pygame.K_q:#按Q退出游戏
            sys.exit()
        elif event.key==pygame.K_SPACE:
            self._fire_bullet()
    def _check_keyup_events(self,event):
        if event.key==pygame.K_RIGHT:#右移事件
            self.ship.moving_right=False
        elif event.key==pygame.K_LEFT:#左移事件
            self.ship.moving_left=False
    def _create_fleet(self):#创建外星人群
        aline=Aline(self)#创建一个外星人
        #外星人的间距为外星人的宽度
        aline_width,aline_height=aline.rect.size
        available_space_x=self.settings.screen_width-(2*aline_width)
        number_alines_x=available_space_x//(2*aline_width)
        ship_height=self.ship.rect.height
        available_space_y=self.settings.screen_height-3*aline_height-ship_height
        number_rows=available_space_y//(2*aline_height)
        #创建第一行外星人
        for row_number in range(number_rows):
            for aline_number in range(number_alines_x):
                self._create_aline(aline_number,row_number)
    def _create_aline(self,aline_number,row_number):
        aline=Aline(self)
        aline_width,aline_height=aline.rect.size
        aline.x=aline_width+2*aline_number*aline_width
        aline.rect.x=aline.x
        aline.rect.y=aline.rect.height+2*aline.rect.height*row_number
        self.alines.add(aline)
    def _update_alines(self):
        self._check_fleet_edges()
        self.alines.update()
        if pygame.sprite.spritecollideany(self.ship,self.alines):
            #spritecollideany接受两个实参，一个精灵，一个编组，检测编组中成员是否与精灵发生碰撞
            self._ship_hit()
        self._check_alines_bottom()
    def _check_fleet_edges(self):#有外星人到达边缘时采取相应措施
        for aline in self.alines.sprites():
            if aline.check_edges():
                self._change_fleet_direction()
                break
    def _change_fleet_direction(self):
        #将整群外星人下移并改变他们的方向
        for aline in self.alines.sprites():
            aline.rect.y+=self.settings.fleet_drop_speed
        self.settings.fleet_direction*=-1
    def _ship_hit(self):#响应飞船被外星人撞到
        if self.stats.ships_left&gt;0:
            self.stats.ships_left-=1
            self.sb.prep_ships()
            #清空余下的外星人和子弹
            self.alines.empty()
            self.bullets.empty()
        #创建一批新的外星人并将飞船放到屏幕底端的中央
            self._create_fleet()
            self.ship.center_ship()
            sleep(0.5)#暂停0.5秒
        else:
            self.stats.game_active=False
            pygame.mouse.set_visible(True)#显示鼠标光标
    def _check_alines_bottom(self):#检测是否有外星人到达屏幕底端
        screen_rect=self.screen.get_rect()
        for aline in self.alines.sprites():
            if aline.rect.bottom&gt;=screen_rect.bottom:
                self._ship_hit()
                break
    def _check_play_button(self,mouse_pos):
        button_clicked=self.play_button.rect.collidepoint(mouse_pos)
        if button_clicked and not self.stats.game_active:#判断点击的坐标是否在按钮的矩形内
            self.settings.initialize_dynamic_settings()
            self.stats.reset_stats()
            self.stats.game_active=True
            self.sb.prep_score()
            self.sb.prep_level()
            self.sb.prep_ships()
            self.alines.empty()
            self.bullets.empty()
            self._create_fleet()
            self.ship.center_ship()
            pygame.mouse.set_visible(False)#隐藏鼠标光标
if __name__==&quot;__main__&quot;:#创建游戏实例并运行游戏
    ai=AlineInvasion()
    ai.run_game()
</code></pre>
<h4 id="2game_statspy">2.game_stats.py</h4>
<pre><code class="language-python">class GameStats:#跟踪游戏的统计信息
    def __init__(self,ai_game):
        self.settings=ai_game.settings
        self.reset_stats()
        self.game_active=False
        self.high_score=0
    def reset_stats(self):
        #初始化在游戏期间可能发生变化的统计信息
        self.ships_left=self.settings.ship_limit
        self.score=0
        self.level=1
</code></pre>
<h4 id="3scoreboardpy">3.scoreboard.py</h4>
<pre><code class="language-python">import pygame.font
from pygame.sprite import Group
from ship import Ship
class ScoreBoard:#显示得分信息的类
    def __init__(self,ai_game):
        self.ai_game=ai_game
        self.screen=ai_game.screen
        self.screen_rect=self.screen.get_rect()
        self.settings=ai_game.settings
        self.stats=ai_game.stats
        #显示得分信息时所用的字体设置
        self.text_color=(30,30,30)
        self.font=pygame.font.SysFont(None,48)
        self.prep_score()
        self.prep_high_score()
        self.prep_level()
        self.prep_ships()
    def prep_score(self):
        rounded_score=round(self.stats.score,-1)#让小数舍入到最近的10整数倍
        score_str=&quot;{:,}&quot;.format(rounded_score)
        self.score_image=self.font.render(score_str,True,self.text_color,self.settings.bg_color)
        self.score_rect=self.score_image.get_rect()
        self.score_rect.right=self.screen_rect.right-20
        self.score_rect.top=20
    def prep_high_score(self):
        high_score=round(self.stats.high_score,-1)
        high_score_str=&quot;{:,}&quot;.format(high_score)
        self.high_score_image=self.font.render(high_score_str,True,self.text_color,self.settings.bg_color)
        #将最高得分放在屏幕中央
        self.high_score_rect=self.high_score_image.get_rect()
        self.high_score_rect.centerx=self.screen_rect.centerx
        self.high_score_rect.top=self.score_rect.top
    def show_score(self):
        self.screen.blit(self.score_image,self.score_rect)
        self.screen.blit(self.high_score_image,self.high_score_rect)
        self.screen.blit(self.level_image,self.level_rect)
        self.ships.draw(self.screen)
    def check_high_score(self):
        if self.stats.score&gt;self.stats.high_score:
            self.stats.high_score=self.stats.score
            self.prep_high_score()
    def prep_level(self):
        level_str=str(self.stats.level)
        self.level_image=self.font.render(level_str,True,self.text_color,self.settings.bg_color)
        self.level_rect=self.level_image.get_rect()
        self.level_rect.right=self.score_rect.right
        self.level_rect.top=self.score_rect.bottom+10
    def prep_ships(self):
        self.ships=Group()
        for ship_number in range(self.stats.ships_left):
            ship=Ship(self.ai_game)
            ship.rect.x=10+ship_number*ship.rect.width
            ship.rect.y=10
            self.ships.add(ship)
</code></pre>
<h4 id="4buttonpy">4.button.py</h4>
<pre><code class="language-python">import pygame.font
class Button:
    def __init__(self,ai_game,msg):
        #初始化按钮属性
        self.screen=ai_game.screen
        self.screen_rect=self.screen.get_rect()
        #设置按钮大小和其他属性
        self.width,self.height=200,50
        self.button_color=(0,255,0)#按钮颜色
        self.text_color=(255,255,255)#文本颜色
        self.font=pygame.font.SysFont(None,48)#None指字体为默认字体，48为字号
        self.rect=pygame.Rect(0,0,self.width,self.height)
        self.rect.center=self.screen_rect.center
        self._prep_msg(msg)
    def _prep_msg(self,msg):
        self.msg_image=self.font.render(msg,True,self.text_color,self.button_color)
        #font.render用于将文本转为图像
        #布尔实参表示是否开启反锯齿功能，使得字体变得更加平滑
        self.msg_image_rect=self.msg_image.get_rect()
        self.msg_image_rect.center=self.rect.center
    def draw_button(self):
        self.screen.fill(self.button_color,self.rect)#绘制表示按钮的矩形
        self.screen.blit(self.msg_image,self.msg_image_rect)#绘制文本图像
</code></pre>
<h4 id="5alinepy">5.aline.py</h4>
<pre><code class="language-python">import pygame
from pygame.sprite import Sprite
class Aline(Sprite):
    #表示单个外星人的类
    def __init__(self,ai_game):
        super().__init__()
        self.screen=ai_game.screen
        self.settings=ai_game.settings
        self.image=pygame.image.load(&quot;images/aline.bmp&quot;)
        self.rect=self.image.get_rect()#获取其外接矩形，用其来处理位置
        #每个外星人最初都在屏幕左上角附近
        self.rect.x=self.rect.width
        self.rect.y=self.rect.height
        self.x=float(self.rect.x)
    def update(self):
        #向右移动外星人
        self.x+=(self.settings.aline_speed*self.settings.fleet_direction)
        self.rect.x=self.x
    def check_edges(self):#检查外星人是否撞到了边缘
        screen_rect=self.screen.get_rect()
        if self.rect.right&gt;=screen_rect.right or self.rect.left&lt;=0:
            return True
</code></pre>
<h4 id="6shippy">6.ship.py</h4>
<pre><code class="language-python">import pygame
from pygame.sprite import Sprite
class Ship(Sprite):#管理飞船的类
    def __init__(self,ai_game):#ai_game为指向当前AlineInvasion实例的引用
        #初始化飞船并设置其初始位置
        super().__init__()
        self.screen=ai_game.screen
        self.settings=ai_game.settings
        self.screen_rect=ai_game.screen.get_rect()#将屏幕当作矩形处理
        #加载飞船图像并获取其外接矩形
        self.image=pygame.image.load('images/ship.bmp')
        self.rect=self.image.get_rect()#获取其外接矩形，用其来处理位置
        #对于每艘新飞船，将其放在屏幕底部的中央
        self.rect.midbottom=self.screen_rect.midbottom
        #在飞船的属性x中存储小数值
        self.x=float(self.rect.x)
        self.moving_right=False
        self.moving_left=False
    def blitme(self):#在指定位置绘制飞船
        self.screen.blit(self.image,self.rect)
    def update(self):
        if self.moving_right and self.rect.right&lt;self.screen_rect.right:
            self.x+=self.settings.ship_speed
        if self.moving_left and self.rect.left&gt;0:
            self.x-=self.settings.ship_speed
        #根据self.x更新self.rect.x
        self.rect.x=self.x
    def center_ship(self):
        self.rect.midbottom=self.screen_rect.midbottom
        self.x=float(self.rect.x)
</code></pre>
<h4 id="7settingspy">7.settings.py</h4>
<pre><code class="language-python">class Settings:#存储游戏外星人入侵中所有的类
    def __init__(self):#初始化游戏的设置
        #屏幕设置
        self.screen_width=1200
        self.screen_height=800
        self.bg_color=(230,230,230)
        #飞船设置
        self.ship_limit=3#飞船个数
        #子弹设置
        self.bullet_width=3
        self.bullet_height=15
        self.bullet_color=(60,60,60)#深灰色
        self.bullets_allowed=3#最大子弹数
        #外星人设置
        self.fleet_drop_speed=10#下降速度
        #加快游戏节奏的速度
        self.speedup_scale=1.1
        self.score_scale=1.5
        self.initialize_dynamic_settings()
    def initialize_dynamic_settings(self):
        self.ship_speed=1.5
        self.bullet_speed=1.5
        self.aline_speed=1.0
        self.fleet_direction=1#1表示右移，-1表示左移
        self.aline_points=50
    def increase_speed(self):
        self.ship_speed*=self.speedup_scale
        self.bullet_speed*=self.speedup_scale
        self.aline_speed*=self.speedup_scale
        self.aline_points=int(self.aline_points*self.score_scale)
</code></pre>
<h4 id="8bulletpy">8.bullet.py</h4>
<pre><code class="language-python">import pygame
from pygame.sprite import Sprite
class Bullet(Sprite):#由类Sprite派生
    #管理飞船所发射子弹的类
    def __init__(self,ai_game):#在飞船当前位置创建一个子弹对象
        super().__init__()
        self.screen=ai_game.screen
        self.settings=ai_game.settings
        self.color=self.settings.bullet_color
        #在（0，0）处创建一个表示子弹的矩形，再设置正确位置
        self.rect=pygame.Rect(0,0,self.settings.bullet_width,self.settings.bullet_height)
        self.rect.midtop=ai_game.ship.rect.midtop
        self.y=float(self.rect.y)
    def update(self):
        #向上移动子弹
        self.y-=self.settings.bullet_speed
        self.rect.y=self.y
    def draw_bullet(self):
        #在屏幕上绘制子弹
        pygame.draw.rect(self.screen,self.color,self.rect)
</code></pre>
<h3 id="十六用opencv进行人脸识别">十六.用opencv进行人脸识别</h3>
<h4 id="1读取图片-灰度转换-修改尺寸">1.读取图片、灰度转换、修改尺寸</h4>
<pre><code class="language-python">import cv2 as cv#导入opencv模块
img=cv.imread('images/face1.jpg')#导入图片
gray_img=cv.cvtColor(img,cv.COLOR_BGR2GRAY)#对图片进行灰度转换,cvtColor第一个参数是图片，第二个参数是转换的类型
resize_img=cv.resize(img,dsize=(200,200))#修改图片大小为200*200
cv.imshow('read_picture',img)#显示图片，第一个参数为窗口名，第二个参数为要显示的图片
cv.imshow('gray',gray_img)#显示灰度图片
cv.imshow('resize',resize_img)#显示改变大小后的图片
print(&quot;img:&quot;,img.shape)#img: (646, 665, 3),3代表通道数RGB
print(&quot;resize_img:&quot;,resize_img.shape)#resize_img: (200, 200, 3)
cv.imwrite('images/face1_gray.jpg',gray_img)#保存图片
while True:
    if ord('q')==cv.waitKey(0):#输入q停止显示,waitkey没按键时返回-1
        break;
#cv.waitKey(0)设置图片显示时间，填0表示图片在人为关闭之前可以一直显示
cv.destroyAllWindows()#程序结束,释放全部内存
</code></pre>
<h4 id="2绘制图形">2.绘制图形</h4>
<pre><code class="language-python">import cv2 as cv#导入opencv模块
img=cv.imread('images/face1.jpg')#导入图片
x,y,w,h=100,100,100,100#矩形的坐标，x,y为起始坐标，w,h为宽和高
cv.rectangle(img,(x,y,x+w,x+h),color=(0,0,255),thickness=1)#绘制矩形
#rectangle第一个参数为图片，第二个参数为四元组代表绘制矩形的左上角和右下角的坐标，color为矩形颜色，thickness为线条宽度
cv.circle(img,center=(x+w//2,y+h//2),radius=100,color=(255,0,0),thickness=2)#绘制圆形
#center为圆心坐标，radius为半径
cv.imshow('img',img)
while True:
    if ord('q')==cv.waitKey(0):#输入q停止显示
        break
#cv.waitKey(0)设置图片显示时间，填0表示图片在人为关闭之前可以一直显示
cv.destroyAllWindows()#程序结束,释放全部内存
</code></pre>
<h4 id="3人脸检测">3.人脸检测</h4>
<pre><code class="language-python">import cv2 as cv#导入opencv模块
def face_detect_demo(img):
    gray_img=cv.cvtColor(img,cv.COLOR_BGR2GRAY)#转换成灰度图片
    face_detect=cv.CascadeClassifier(r&quot;D:\opencv\opencv\sources\data\haarcascades\haarcascade_frontalface_alt2.xml&quot;)
    #配置分类器,opencv提供了识别多种特征的分类器，在此直接使用即可
    face=face_detect.detectMultiScale(gray_img)#得到绘制矩形的位置和宽和高,如果检测到多张人脸则会返回多组数据
    for x,y,w,h in face:
        cv.rectangle(img,(x,y),(x+w,y+h),color=(0,0,255),thickness=2)
        #注意此处第二个参数不是四元组而是两个坐标，代表矩形的左上角和右下角的坐标
    cv.imshow('result',img)
img=cv.imread('images/face2.jpg')#导入图片
face_detect_demo(img)
while True:
    if ord('q')==cv.waitKey(0):#输入q停止显示
        break
#cv.waitKey(0)设置图片显示时间，填0表示图片在人为关闭之前可以一直显示
cv.destroyAllWindows()#程序结束,释放全部内存
</code></pre>
<p>详解detectMultiScale：</p>
<p>此方法的任务是检测不同大小的对象，并返回矩形的列表。<br>
第1个参数img需要是灰度图片<br>
第2个参数scaleFactor，很重要<br>
第3个参数minNeighbors，很重要<br>
第4个参数flag=0即可<br>
第5，6个参数minSize和maxSize 设置检测对象的最大最小值，低于minSize和高于maxSize的话就不会检测出来。参数类型为二元组，指定矩形的最小范围和最大范围</p>
<p>scaleFactor默认为1.1，Haar cascade的工作原理是一种“滑动窗口”的方法，通过在图像中不断的“滑动检测窗口”来匹配人脸。<br>
因为图像的像素有大有小，图像中的人脸因为远近不同也会有大有小，所以需要通过scaleFactor参数设置一个缩小的比例，对图像进行逐步缩小来检测，这个参数设置的越大，计算速度越快，但可能会错过了某个大小的人脸。可以根据图像的像素值来设置此参数，像素大缩小的速度就可以快一点，通常在1~1.5之间。</p>
<p>minNeighbors默认为3，指定每个候选矩形有多少个“邻居”，指定每个候选矩形有多少个“邻居”，也可以理解为检测次数，只有检测minNeighbors次，某处都识别为人脸才会显示出来矩形</p>
<h4 id="4视频人脸检测">4.视频人脸检测</h4>
<pre><code class="language-python">import cv2 as cv#导入opencv模块
def face_detect_demo(img):
    gray_img=cv.cvtColor(img,cv.COLOR_BGR2GRAY)#转换成灰度图片
    face_detect=cv.CascadeClassifier(r&quot;D:\opencv\opencv\sources\data\haarcascades\haarcascade_frontalface_alt2.xml&quot;)
    #配置分类器,opencv提供了识别多种特征的分类器，在此直接使用即可
    face=face_detect.detectMultiScale(gray_img)#得到绘制矩形的位置和宽和高,如果检测到多张人脸则会返回多组数据
    for x,y,w,h in face:
        cv.rectangle(img,(x,y),(x+w,y+h),color=(0,0,255),thickness=2)
    #注意此处第二个参数不是四元组而是两个坐标，代表矩形的左上角和右下角的坐标
    cv.imshow('result',img)
cap=cv.VideoCapture(0)#VideoCapture用于获取摄像头，参数为0代表获取电脑默认摄像头
#cap=cv.VideoCapture(&quot;videos/video1.mp4&quot;)#VideoCapture也可以用于获取视频
while True:
    flag,frame=cap.read()#read()用于获取当前视频是否在播放以及当前帧，返回一个二元组
    if not flag:#视频播放结束
        break
    face_detect_demo(frame)
    if ord('q')==cv.waitKey(1):
        #注意如果想要视频持续播放的话，可以在检测时持续按住空格，或者将waitkey中的参数调为非0
        break
#cv.waitKey(0)设置图片显示时间，填0表示图片在人为关闭之前可以一直显示
cv.destroyAllWindows()#程序结束,释放全部内存
cap.release()#释放摄像头
</code></pre>
<h4 id="5人脸录入">5.人脸录入</h4>
<pre><code class="language-python">import cv2 as cv
cap=cv.VideoCapture(0)
flag=0
num=1
while(cap.isOpened()):#检测摄像头是否在开启状态
    ret_flag,Vshow=cap.read()#得到每帧图像
    cv.imshow(&quot;Capture&quot;,Vshow)#显示图像
    k=cv.waitKey(1) &amp; 0xFF#按键判断
    if k==ord('s'):#按下s保存截图
        cv.imwrite(&quot;images/data/&quot;+str(num)+&quot;.name.jpg&quot;,Vshow)
        num+=1
    if k==ord(' '):#按空格结束
        break
cap.release()
cv.destroyAllWindows()
</code></pre>
<h4 id="6数据训练">6.数据训练</h4>
<pre><code class="language-python">#pip install 包名 -i http://pypi.douban.com/simple --trusted-host pypi.douban.com
</code></pre>
<pre><code class="language-python">import cv2 as cv
import os
from PIL import Image
import numpy as np
def getImageAndLabels(path):
    facesSamples=[]#存储人脸数据
    ids=[]#存储姓名数据
    imagePaths=[os.path.join(path,f) for f in os.listdir(path)]#存储各个图片路径信息
    #os.path.join()用于将路径与文件名合成一个字符串，os.listdir()用于获取当前文件夹下的文件名
    face_detector=cv.CascadeClassifier(r&quot;D:\opencv\opencv\sources\data\haarcascades\haarcascade_frontalface_alt2.xml&quot;)
    #加载分类器
    for imagePath in imagePaths:#遍历图片
        PIL_img=Image.open(imagePath).convert('L')#以灰度图像的方式打开图片
        img_numpy=np.array(PIL_img,'uint8')#将获取的灰度图像转化为数组，uint8代表8位无符号整数
        faces=face_detector.detectMultiScale(img_numpy)
        #img_numpy是一整张图片的数据数组,经过分类器之后是faces，是人脸那一个部分的数据数组
        id=int(os.path.split(imagePath)[1].split('.')[0])#获取图像id
        #将路径中的文件名提取出来，再以.作为分割提取出第一个数字作为id
        for x,y,w,h in faces:
            ids.append(id)
            facesSamples.append(img_numpy[y:y+h,x:x+w])
    return facesSamples,ids
if __name__=='__main__':
    path=&quot;images/data/&quot;#存放图片的路径
    faces,ids=getImageAndLabels(path)#获取图像数组和id标签数组
    recognizer=cv.face.LBPHFaceRecognizer_create()#加载识别器
    recognizer.train(faces,np.array(ids))#进行数据训练
    recognizer.write(&quot;trainer/trainer1.yml&quot;)#将数据保存
</code></pre>
<h4 id="7人脸识别">7.人脸识别</h4>
<pre><code class="language-python">import cv2 as cv
import os
import urllib
import urllib.request
def face_detect_demo(img):
    gray=cv.cvtColor(img,cv.COLOR_BGR2GRAY)#图像灰度化
    face_detect=cv.CascadeClassifier(r&quot;D:\opencv\opencv\sources\data\haarcascades\haarcascade_frontalface_alt2.xml&quot;)
    #配置分类器,opencv提供了识别多种特征的分类器，在此直接使用即可
    face=face_detect.detectMultiScale(gray)#得到绘制矩形的位置和宽和高,如果检测到多张人脸则会返回多组数据
    for x,y,w,h in face:
        cv.rectangle(img,(x,y),(x+w,y+h),color=(0,0,255),thickness=2)
        #注意此处第二个参数不是四元组而是两个坐标，代表矩形的左上角和右下角的坐标
        ids,confidence=recognizer.predict(gray[y:y+h,x:x+w])#confidence则是进行人脸检测后的评分，越大越不可信
        if confidence&gt;80:#不太可信，不是训练集中的人
            cv.putText(img,&quot;Unknown&quot;,(x+10,y-10),cv.FONT_HERSHEY_SIMPLEX,0.75,(255,255,255),thickness=2)
        else:
            cv.putText(img,str(names[ids-1]),(x+10,y-10),cv.FONT_HERSHEY_SIMPLEX,0.75,(255,255,255),thickness=2)
            #cv2.putText(图片img,“文本内容”,(左下角坐标),字体,字体大小,(颜色)，线条粗细，线条类型)
    cv.imshow(&quot;result&quot;,img)
recognizer=cv.face.LBPHFaceRecognizer_create()#加载识别器
recognizer.read(&quot;trainer/trainer1.yml&quot;)#加载训练数据集文件
names=[]#存储姓名
names.append(&quot;weiziteng&quot;)
cap=cv.VideoCapture(0)#VideoCapture用于获取摄像头，参数为0代表获取电脑默认摄像头
#cap=cv.VideoCapture(&quot;videos/video1.mp4&quot;)#VideoCapture也可以用于获取视频
while True:
    flag,frame=cap.read()#read()用于获取当前视频是否在播放以及当前帧，返回一个二元组
    if not flag:#视频播放结束
        break
    face_detect_demo(frame)
    if ord('q')==cv.waitKey(1):
        #注意如果想要视频持续播放的话，可以在检测时持续按住空格，或者将waitkey中的参数调为非0
        break
#cv.waitKey(0)设置图片显示时间，填0表示图片在人为关闭之前可以一直显示
cv.destroyAllWindows()#程序结束,释放全部内存
cap.release()#释放摄像头
</code></pre>
<h3 id="十七scikit-learn实现机器学习">十七.scikit-learn实现机器学习</h3>
<h4 id="1机器学习介绍及其原理">1.机器学习介绍及其原理</h4>
<p>①人工智能：就其本质而言，是及其对人思维信息过程的模拟，让它能像人一样去思考<br>
人工智能可以根据输入信息进行模型结构，权重更新，实现最终优化<br>
特点：信息处理，自我学习，优化升级</p>
<p>②人工智能的核心方法：机器学习，深度学习<br>
机器学习是一种实现人工智能的方法，深度学习是一种实现机器学习的技术</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220312190207124.png"
alt="image-20220312190207124" style="zoom:50%;"/></p>
<p>机器学习：使用算法来解析数据，从中学习，然后对真实世界中的事件进行决策和预测<br>
深度学习：模仿人类的神经网络，建立模型，进行数据分析</p>
<p>③机器学习分类：<br>
监督式学习：基于数据及结果进行预测<br>
非监督式学习：从数据中挖掘关联性</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220312191018636.png" 
alt="image-20220312191018636" style="zoom:50%;" /></p>
<p>强化学习：强调如何基于环境而行动以获取最大利益</p>
<p>④监督式学习核心步骤：<br>
1.使用标签数据训练机器学习模型<br>
●&quot;标签数据&quot; 是指由输入数据对应的正确的输出结果<br>
●&quot;机器学习模型&quot;将学习输入数据与之对应的输出结果间的函数关系<br>
2.调用训练好的机器学习模型,根据新的输入数据预测对应的结果</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220312191419784.png" 
alt="image-20220312191419784" style="zoom:50%;" /></p>
<p>相比于监督式学习,非监督式学习不需要标签数据,而是通过引入预先设定的优化准则进行模型训练,比如自动将数据分为三类</p>
<h4 id="2机器学习开发环境部署">2.机器学习开发环境部署</h4>
<p>1）Scikit-learn：是python语言中专门针对机器学习应用而发展起来的开源框架，可以实现数据预处理，分类，回归，降维，模型选择等常用的机器学习算法</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220312222203920.png" 
alt="image-20220312222203920" style="zoom:50%;" /></p>
<p>2）Jupyter notebook</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220312222349524.png" 
alt="image-20220312222349524" style="zoom:50%;" /></p>
<p>3）Anaconda</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313105229198.png" 
alt="image-20220313105229198" style="zoom: 33%;" /></p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313105304555.png" 
alt="image-20220313105304555" style="zoom:50%;" /></p>
<h4 id="3机器学习实现之数据预处理">3.机器学习实现之数据预处理</h4>
<p>1）Iris数据集：</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313133513186.png" 
alt="image-20220313133513186" style="zoom:50%;" /></p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313133620715.png" 
alt="image-20220313133620715" style="zoom:50%;" /></p>
<pre><code class="language-python">#Iris数据加载
import numpy as np
from sklearn import datasets
iris=datasets.load_iris()
print(iris.data)#输出属性数据内容
print(iris.feature_names)#输出每一列对应的属性名称
#['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
print(iris.target)#输出每一行数据对应的结果的名称
# [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#  0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
#  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
#  2 2]
print(iris.target_names)#输出结果依次对应的数据含义
#['setosa' 'versicolor' 'virginica']
</code></pre>
<p>2）使用scikit-learn进行数据处理的四个关键点<br>
①区分开属性数据和结果数据<br>
②属性数据和结果数据都是量化的<br>
③运算过程中，属性数据与结果数据的类型都是numpy数组<br>
④属性数据与结果数据的维度是对应的，即行数应该对应</p>
<h4 id="4机器学习实现之模型训练">4.机器学习实现之模型训练</h4>
<p>1）分类：根据数据集目标的特征或属性，划分到已有的类别中</p>
<p>2）常用的算法：K近邻（KNN），逻辑回归，决策树，朴素贝叶斯</p>
<p>3）K近邻分类模型（KNN）：给定一个训练数据集，对新的输入实例，在训练的数据集中找到与该实例最邻近的K个实例，这个K实例的多数属于某一类，就把该输入实例归到这个类中</p>
<p>4）使用scikit-learn进行建模的四个步骤：<br>
①调用需要使用的模型类<br>
②模型初始化：创建一个模型实例<br>
③模型训练<br>
④模型预测</p>
<pre><code class="language-python">#Iris数据加载
import numpy as np
from sklearn import datasets
from sklearn.neighbors import KNeighborsClassifier#模型调用，KNN的分类器
iris=datasets.load_iris()
X=iris.data#属性数据
Y=iris.target#结果数据
print(X.shape)#确认属性数据和结果数据的维度是否相同
print(Y.shape)
#创建实例
knn=KNeighborsClassifier(n_neighbors=1)#n_neighbors即为K,KNN的其他参数自行了解
#模型训练
knn.fit(X,Y)
#模型预测
x_test=[[1,2,3,4],[2,3,1,4]]
result=knn.predict(x_test)#进行预测
print(result)#输出结果[2 0]
#当我们把K设置为5，输出结果为[1 0]
</code></pre>
<h4 id="5机器学习实现之模型评估">5.机器学习实现之模型评估</h4>
<p>1）为了对模型的准确率进行评估，我们不能用全部的数据进行训练，因为这样无法判断模型的准确性，不妨将数据集分为训练集与测试集两部分，一部分用于训练，一部分用于测试，这样便于对模型进行评估，下面是不进行数据分离的结果，显然K=1时，正确率100%</p>
<pre><code class="language-python">#Iris数据加载
import numpy as np
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.neighbors import KNeighborsClassifier#模型调用，KNN的分类器
from sklearn.metrics import accuracy_score#用于判断准确率
iris=datasets.load_iris()
X=iris.data#属性数据
Y=iris.target#结果数据
#创建实例
knn=KNeighborsClassifier(n_neighbors=5)#n_neighbors即为K,KNN的其他参数自行了解
#模型训练
knn.fit(X,Y)
Y_pred=knn.predict(X)#预测后的数据
print(accuracy_score(Y,Y_pred))#准确率计算
#0.9666666666666667
</code></pre>
<p>2）下面进行数据分离然后进行模型评估</p>
<pre><code class="language-python">#Iris数据加载
import numpy as np
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.neighbors import KNeighborsClassifier#模型调用，KNN的分类器
from sklearn.metrics import accuracy_score#用于判断准确率
from sklearn.model_selection import train_test_split#用于进行数据分离
iris=datasets.load_iris()
X=iris.data#属性数据
Y=iris.target#结果数据
#创建实例
knn=KNeighborsClassifier(n_neighbors=5)#n_neighbors即为K,KNN的其他参数自行了解
#模型训练
X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.4)#数据分离
#X_train,Y_train为用于进行训练的数据,X_test,Y_test为用于进行测试的数据,test_size为用于进行测试的数据比例
knn.fit(X_train,Y_train)
Y_pred=knn.predict(X_test)
print(accuracy_score(Y_test,Y_pred))
</code></pre>
<p>3）确定最合适的K值，遍历所有可取的K值</p>
<pre><code class="language-python">#Iris数据加载
import numpy as np
import matplotlib.pyplot as plt
from sklearn import datasets
from sklearn.neighbors import KNeighborsClassifier#模型调用，KNN的分类器
from sklearn.metrics import accuracy_score#用于判断准确率
from sklearn.model_selection import train_test_split#用于进行数据分离
iris=datasets.load_iris()
X=iris.data#属性数据
Y=iris.target#结果数据
X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.4)#数据分离
source_test=[]#存储评估准确率
for k in range(1,26):
    knn=KNeighborsClassifier(n_neighbors=k)
    knn.fit(X_train,Y_train)#训练
    Y_pred=knn.predict(X_test)
    source_test.append(accuracy_score(Y_test,Y_pred))
#准确率结果可视化
plt.plot(range(1,26),source_test)
plt.xlabel(&quot;K(KNN model)&quot;)
plt.ylabel(&quot;Testing Accuracy&quot;)
plt.show()
</code></pre>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313194057444.png" 
alt="image-20220313194057444" style="zoom:50%;" /></p>
<p>K值越小，模型越复杂，并且因为每次数据分离是随机的，训练出的结果也不相同</p>
<h4 id="6逻辑回归模型">6.逻辑回归模型</h4>
<p>1）逻辑回归模型：用于解决分类问题的一种模型。根据数据特征或属性,计算其归属于某一类别的概率P(x) ,根据概率数值判断其所属类别。主要应用场景: 二分类问题。</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313195518812.png" 
alt="image-20220313195518812" style="zoom:50%;" /></p>
<p>2）皮马印第安人糖尿病数据集</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313195753674.png" 
alt="image-20220313195753674" style="zoom:50%;" /></p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313195919453.png" 
alt="image-20220313195919453" style="zoom:50%;" /></p>
<p>注意数据集的特点是有缺失数据</p>
<p>3）使用准确率进行模型评估的局限性：没有体现数据的实际分布情况，没有体现模型错误预测的类型</p>
<p>空准确率：当模型总是预测比较高的类别，其预测准确率的数值，即比例较高的类别在模型中所占的比例</p>
<p>4）混淆矩阵</p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313200835074.png" 
alt="image-20220313200835074" style="zoom:50%;" /></p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313201035776.png" 
alt="image-20220313201035776" style="zoom:50%;" /></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">比</mi><msub><mi>F</mi><mn>1</mn></msub><mi mathvariant="normal">更</mi><mi mathvariant="normal">具</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">般</mi><mi mathvariant="normal">形</mi><mi mathvariant="normal">式</mi><mi mathvariant="normal">的</mi><msub><mi>F</mi><msup><mi>β</mi><mo mathvariant="normal">′</mo></msup></msub><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>F</mi><msup><mi>β</mi><mo mathvariant="normal">′</mo></msup></msub><mo>=</mo><mfrac><mrow><mo>(</mo><mn>1</mn><mo>+</mo><msup><mi>β</mi><mn>2</mn></msup><mo>)</mo><mo>×</mo><mi>P</mi><mo>×</mo><mi>R</mi></mrow><mrow><mo>(</mo><msup><mi>β</mi><mn>2</mn></msup><mo>×</mo><mi>P</mi><mo>)</mo><mo>+</mo><mi>R</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">①</mi><mi>β</mi><mo>=</mo><mn>1</mn><mo>:</mo><mi mathvariant="normal">标</mi><mi mathvariant="normal">准</mi><mi mathvariant="normal">的</mi><msub><mi>F</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">②</mi><mi>β</mi><mo>&lt;</mo><mn>1</mn><mo>:</mo><mi mathvariant="normal">偏</mi><mi mathvariant="normal">精</mi><mi mathvariant="normal">确</mi><mi mathvariant="normal">率</mi><mi>P</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">③</mi><mi>β</mi><mo>&gt;</mo><mn>1</mn><mo>:</mo><mi mathvariant="normal">偏</mi><mi mathvariant="normal">召</mi><mi mathvariant="normal">回</mi><mi mathvariant="normal">率</mi><mi>R</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>β</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">常</mi><mi mathvariant="normal">用</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">值</mi><mi mathvariant="normal">为</mi><mn>0.5</mn><mi mathvariant="normal">，</mi><mn>1</mn><mi mathvariant="normal">，</mi><mn>2</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;比F_1更具一般形式的F_{\beta&#x27;}:\\
&amp;F_{\beta&#x27;}=\frac{(1+\beta^2)\times P\times R}{(\beta^2\times P)+R}\\
&amp;①\beta=1:标准的F_1\\
&amp;②\beta&lt;1:偏精确率P\\
&amp;③\beta&gt;1:偏召回率R\\
&amp;\beta最常用的值为0.5，1，2 
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.227108000000001em;vertical-align:-4.863554000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.363554000000001em;"><span style="top:-8.014662000000001em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-5.863554000000001em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-3.7875539999999988em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-2.287553999999999em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-0.7875539999999992em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:0.7124460000000004em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.863554000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.363554000000001em;"><span style="top:-8.014662000000001em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">比</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">更</span><span class="mord cjk_fallback">具</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">般</span><span class="mord cjk_fallback">形</span><span class="mord cjk_fallback">式</span><span class="mord cjk_fallback">的</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span></span><span style="top:-5.863554000000001em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.7875539999999988em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord">①</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">准</span><span class="mord cjk_fallback">的</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.287553999999999em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord">②</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">精</span><span class="mord cjk_fallback">确</span><span class="mord cjk_fallback">率</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span><span style="top:-0.7875539999999992em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord">③</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">召</span><span class="mord cjk_fallback">回</span><span class="mord cjk_fallback">率</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span><span style="top:0.7124460000000004em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">常</span><span class="mord cjk_fallback">用</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">为</span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.863554000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313201213357.png" 
alt="image-20220313201213357" style="zoom:50%;" /></p>
<pre><code class="language-python">import pandas as pd
from sklearn.linear_model import LogisticRegression#导入逻辑回归模型
from sklearn import metrics
from sklearn.model_selection import train_test_split#用于进行数据分离
pima=pd.read_csv(&quot;F:/tmp/diabetes.csv&quot;)#导入数据
X=pima.loc[:,'Pregnancies':'Age']#属性数据
Y=pima.Outcome#结果数据
X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.4,random_state=0)#数据分离
#random_state=0指每次数据分离不再随机
logreg=LogisticRegression()#创建模型实例
logreg.fit(X_train,Y_train)#模型训练
Y_pred=logreg.predict(X_test)#模型预测
print(metrics.accuracy_score(Y_test,Y_pred))#预测准确率0.8084415584415584
#实际结果情况
print(Y_test.value_counts())
#0    205
#1    103
#Name: Outcome, dtype: int64
#1的比例
print(Y_test.mean())#求平均即为1的比例0.3344155844155844
#0的比例
print(1-Y_test.mean())#0.6655844155844156
#空准确率
print(max(Y_test.mean(),1-Y_test.mean()))#0.6655844155844156
</code></pre>
<p>计算混淆矩阵进行模型评估</p>
<pre><code class="language-python">print(metrics.confusion_matrix(Y_test,Y_pred))#计算混淆矩阵
#[[191  14]
# [ 45  58]]
[[TN,FP],[FN,TP]]=metrics.confusion_matrix(Y_test,Y_pred)#计算混淆矩阵,并赋值给各个因子
</code></pre>
<p><img src="http://raw.githubusercontent.com/2006wzt/PicGo_images/master/images/image-20220313205754587.png" 
alt="image-20220313205754587" style="zoom: 67%;" /></p>
<pre><code class="language-python">import pandas as pd
from sklearn.linear_model import LogisticRegression#导入逻辑回归模型
from sklearn import metrics
from sklearn.model_selection import train_test_split#用于进行数据分离
pima=pd.read_csv(&quot;F:/tmp/diabetes.csv&quot;)#导入数据
X=pima.loc[:,'Pregnancies':'Age']#属性数据
Y=pima.Outcome#结果数据
X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.4,random_state=0)#数据分离
#random_state=0指每次数据分离不再随机
logreg=LogisticRegression()#创建模型实例
logreg.fit(X_train,Y_train)#模型训练
Y_pred=logreg.predict(X_test)#模型预测
[[TN,FP],[FN,TP]]=metrics.confusion_matrix(Y_test,Y_pred)#计算混淆矩阵,并赋值给各个因子
accuracy=(TP+TN)/(TP+TN+FP+FN)#准确率
print(accuracy)# 0.8084415584415584
mis_rate=(FP+FN)/(TP+TN+FP+FN)#错误率
print(mis_rate)# 0.19155844155844157
recall=TP/(TP+FN)#召回率
print(recall)# 0.5631067961165048
specificity=TN/(TN+FP)#特异度
print(specificity)# 0.9317073170731708
precision=TP/(TP+FP)#精确率
print(precision)# 0.8055555555555556
f1_score=(2*precision*recall)/(precision+recall)#F1分数
print(f1_score)# 0.6628571428571429
</code></pre>
]]></content>
    </entry>
</feed>